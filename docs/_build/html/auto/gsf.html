

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>gsf package &mdash; gsf 1.4 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="gsf" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> gsf
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing gsf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parameters.html">Paramter Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates.html">Generating templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fitting.html">Fitting process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output.html">Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prior.html">Prior</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">gsf</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">gsf package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.basic_func">gsf.basic_func module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.fitting">gsf.fitting module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.function">gsf.function module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.function_class">gsf.function_class module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.function_igm">gsf.function_igm module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.gsf">gsf.gsf module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.maketmp_filt">gsf.maketmp_filt module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.maketmp_z0">gsf.maketmp_z0 module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.maketmp_z0_tau">gsf.maketmp_z0_tau module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.minimizer">gsf.minimizer module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gsf-plot-mz-module">gsf.plot_MZ module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.plot_sed_logA">gsf.plot_sed_logA module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.plot_sfh_logA">gsf.plot_sfh_logA module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.posterior_flexible">gsf.posterior_flexible module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.posterior_nested">gsf.posterior_nested module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.version">gsf.version module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.writing">gsf.writing module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.zfit">gsf.zfit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gsf</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">gsf</a> &raquo;</li>
        
      <li>gsf package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/auto/gsf.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gsf-package">
<h1>gsf package<a class="headerlink" href="#gsf-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-gsf.basic_func">
<span id="gsf-basic-func-module"></span><h2>gsf.basic_func module<a class="headerlink" href="#module-gsf.basic_func" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="gsf.basic_func.Basic">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gsf.basic_func.</span></code><code class="sig-name descname"><span class="pre">Basic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.basic_func.Basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="gsf.basic_func.Basic.Z2NZ">
<code class="sig-name descname"><span class="pre">Z2NZ</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.basic_func.Basic.Z2NZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Critical function to infer NZ from Z.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gsf.basic_func.Basic_tau">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gsf.basic_func.</span></code><code class="sig-name descname"><span class="pre">Basic_tau</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.basic_func.Basic_tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="gsf.basic_func.Basic_tau.Z2NZ">
<code class="sig-name descname"><span class="pre">Z2NZ</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.basic_func.Basic_tau.Z2NZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Critical function to infer NZ from Z.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gsf.fitting">
<span id="gsf-fitting-module"></span><h2>gsf.fitting module<a class="headerlink" href="#module-gsf.fitting" title="Permalink to this headline">¶</a></h2>
<p>This includes the main part of gsf.</p>
<dl class="simple">
<dt>Original copyright:</dt><dd><p>Copyright (c) 2021 Takahiro Morishita, STScI</p>
</dd>
</dl>
<dl class="py class">
<dt id="gsf.fitting.Mainbody">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gsf.fitting.</span></code><code class="sig-name descname"><span class="pre">Mainbody</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e+18</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mpc_cm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.08568025e+24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lsun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.839e+33</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The list of (possible) <cite>Mainbody</cite> attributes is given below:</p>
<dl class="simple">
<dt>nimf<span class="classifier">int </span></dt><dd><p>0:Salpeter, 1:Chabrier, 2:Kroupa, 3:vanDokkum08.</p>
</dd>
<dt>Z<span class="classifier">float array</span></dt><dd><p>Stellar phase metallicity in logZsun.</p>
</dd>
<dt>age<span class="classifier">float array</span></dt><dd><p>Age, in Gyr.</p>
</dd>
<dt>fneb<span class="classifier">int</span></dt><dd><p>flag for adding nebular emission. 0: No, 1: Yes.</p>
</dd>
<dt>logU<span class="classifier">float</span></dt><dd><p>Ionizing parameter, in logU.</p>
</dd>
<dt>tau0<span class="classifier">float array</span></dt><dd><p>Width of age bin. If you want to fix it to a specific value, set it to &gt;0.01, in Gyr.
Otherwise, it would be either minimum value (=0.01; if one age bin), 
or the width to the next age bin.</p>
</dd>
</dl>
<dl class="py method">
<dt id="gsf.fitting.Mainbody.add_param">
<code class="sig-name descname"><span class="pre">add_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.add_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Add new parameters.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.fitting.Mainbody.fit_redshift">
<code class="sig-name descname"><span class="pre">fit_redshift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delzz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ezmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zliml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlimu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_bb_zfit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_line_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.fit_redshift" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best-fit redshift, before going into a big fit, through an interactive inspection.
This module is effective only when spec data is provided.</p>
<dl class="simple">
<dt>delzz<span class="classifier">float</span></dt><dd><p>Delta z in redshift search space</p>
</dd>
<dt>zliml<span class="classifier">float</span></dt><dd><p>Lower limit range for redshift</p>
</dd>
<dt>zlimu<span class="classifier">float</span></dt><dd><p>Upper limit range for redshift</p>
</dd>
<dt>ezmin<span class="classifier">float</span></dt><dd><p>Minimum redshift uncertainty.</p>
</dd>
<dt>snlim<span class="classifier">float</span></dt><dd><p>SN limit for data points. Those below the number will be cut from the fit.</p>
</dd>
<dt>f_bb_zfit<span class="classifier">bool</span></dt><dd><p>Redshift fitting if only BB data. If False, returns nothing.</p>
</dd>
<dt>f_line_check<span class="classifier">bool</span></dt><dd><p>If True, line masking.</p>
</dd>
<dt>priors<span class="classifier">dict, optional</span></dt><dd><p>Dictionary that contains z (redshift grid) and chi2 (chi-square).</p>
</dd>
</dl>
<p>Spectral data must be provided to make this work.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.fitting.Mainbody.get_lines">
<code class="sig-name descname"><span class="pre">get_lines</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">LW0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.get_lines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="gsf.fitting.Mainbody.get_shuffle">
<code class="sig-name descname"><span class="pre">get_shuffle</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nshuf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.get_shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Shuffles initial parameters of each walker, to give it extra randomeness.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.fitting.Mainbody.get_zdist">
<code class="sig-name descname"><span class="pre">get_zdist</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_interact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.get_zdist" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a plot of z-distribution.</p>
<dl class="simple">
<dt>f_interact<span class="classifier">bool</span></dt><dd><p>If true, this module returns figure ax.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gsf.fitting.Mainbody.main">
<code class="sig-name descname"><span class="pre">main</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cornerplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ezmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ferr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_move</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_fitz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_plot_accept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_converge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zini</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Main module of this script.</p>
<dl class="simple">
<dt>ferr<span class="classifier">float</span></dt><dd><p>Used for error parameter.</p>
</dd>
<dt>skip_fitz<span class="classifier">bool </span></dt><dd><p>Skip redshift fit.</p>
</dd>
<dt>sigz<span class="classifier">float </span></dt><dd><p>Confidence interval for redshift fit (i.e. n-sigma).</p>
</dd>
<dt>ezmin<span class="classifier">float </span></dt><dd><p>minimum error in redshift</p>
</dd>
<dt>f_plot_accept<span class="classifier">bool</span></dt><dd><p>Output acceptance plot of mcmc chains.</p>
</dd>
<dt>f_shuffle<span class="classifier">bool</span></dt><dd><p>Randomly shuffle some of initial parameters in walkers.</p>
</dd>
<dt>check_converge<span class="classifier">bool</span></dt><dd><p>Check convergence at every certain number.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gsf.fitting.Mainbody.prepare_class">
<code class="sig-name descname"><span class="pre">prepare_class</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_fir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.prepare_class" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="gsf.fitting.Mainbody.quick_fit">
<code class="sig-name descname"><span class="pre">quick_fit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ezmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ferr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_move</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_get_templates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zini</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.quick_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits input data with a prepared template library, to get a chi-min result.</p>
<dl class="simple">
<dt>Zini<span class="classifier">array</span></dt><dd><p>Array for initial values for metallicity.</p>
</dd>
</dl>
<p>out, chidef, Zbest, xm_tmp, fm_tmp (if f_get_templates is set True).</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.fitting.Mainbody.read_data">
<code class="sig-name descname"><span class="pre">read_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Cz0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cz1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_fir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.read_data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Cz0, Cz1<span class="classifier">float</span></dt><dd><p>Normalization coefficients for grism spectra. Cz0 for G102, Cz1 for G141.</p>
</dd>
<dt>zgal<span class="classifier">float</span></dt><dd><p>Current redshift estimate.</p>
</dd>
</dl>
<p>Dictionary.</p>
<p>This modeule can be used for any SFHs.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.fitting.Mainbody.search_redshift">
<code class="sig-name descname"><span class="pre">search_redshift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zliml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlimu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delzz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'powell'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.search_redshift" title="Permalink to this definition">¶</a></dt>
<dd><p>This module explores the redshift space to find the best redshift and probability distribution.</p>
<dl class="simple">
<dt>dict<span class="classifier">dictionary</span></dt><dd><p>Dictionary that includes input data.</p>
</dd>
<dt>xm_tmp<span class="classifier">numpy.array</span></dt><dd><p>Wavelength array, common for fm_tmp below, at z=0. Should be in [len(wavelength)].</p>
</dd>
<dt>fm_tmp<span class="classifier">numpy.array</span></dt><dd><p>Fluxes for various templates. Should be in a shape of [ n * len(wavelength)], 
where n is the number templates.</p>
</dd>
<dt>zliml<span class="classifier">float</span></dt><dd><p>Lowest redshift for fitting range.</p>
</dd>
<dt>zlimu<span class="classifier">float</span></dt><dd><p>Highest redshift for fitting range.</p>
</dd>
<dt>prior<span class="classifier">numpy.array</span></dt><dd><p>Prior used for the redshift determination. E.g., Eazy z-probability.</p>
</dd>
<dt>method<span class="classifier">str</span></dt><dd><p>Method for minimization. The option must be taken from lmfit. Powell is more accurate. Nelder is faster.</p>
</dd>
</dl>
<dl class="simple">
<dt>zspace<span class="classifier">numpy.array </span></dt><dd><p>Array for redshift grid.</p>
</dd>
<dt>chi2s<span class="classifier">numpy.array</span></dt><dd><p>Array of chi2 values corresponding to zspace.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gsf.fitting.Mainbody.set_param">
<code class="sig-name descname"><span class="pre">set_param</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.set_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameters.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.fitting.Mainbody.update_input">
<code class="sig-name descname"><span class="pre">update_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e+18</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mpc_cm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.08568025e+24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lsun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.839e+33</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.update_input" title="Permalink to this definition">¶</a></dt>
<dd><p>The purpose of this module is to register/update the parameter attributes in <cite>Mainbody</cite>
by visiting the configuration file.</p>
<dl class="simple">
<dt>inputs<span class="classifier">str</span></dt><dd><p>Configuration file that lists parameters.</p>
</dd>
<dt>Mpc_cm<span class="classifier">float, optional</span></dt><dd><p>Conversion factor from Mpc-to-cm</p>
</dd>
<dt>pixelscale<span class="classifier">float, optional</span></dt><dd><p>Conversion factor from pixel-to-arcsec</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gsf.function">
<span id="gsf-function-module"></span><h2>gsf.function module<a class="headerlink" href="#module-gsf.function" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="gsf.function.SFH_cons">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">SFH_cons</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsfr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.SFH_cons" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.SFH_dec">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">SFH_dec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsfr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.SFH_dec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.SFH_del">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">SFH_del</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsfr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.SFH_del" title="Permalink to this definition">¶</a></dt>
<dd><p>SFH</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.calc_Dn4">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">calc_Dn4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.calc_Dn4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.check_line">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">check_line</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.check_line" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.check_line_cz">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">check_line_cz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xcont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.check_line_cz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.check_line_cz_man">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">check_line_cz_man</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xcont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2800,</span> <span class="pre">3347,</span> <span class="pre">3727,</span> <span class="pre">3799,</span> <span class="pre">3836,</span> <span class="pre">3869,</span> <span class="pre">4102,</span> <span class="pre">4341,</span> <span class="pre">4861,</span> <span class="pre">4960,</span> <span class="pre">5008,</span> <span class="pre">5175,</span> <span class="pre">6563,</span> <span class="pre">6717,</span> <span class="pre">6731]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.check_line_cz_man" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>LW<span class="classifier"></span></dt><dd><p>List for emission lines to be masked.</p>
</dd>
</dl>
<dl class="simple">
<dt>wht<span class="classifier"></span></dt><dd><p>Processed weight, where wavelength at line exists is masked.</p>
</dd>
<dt>ypoly<span class="classifier"></span></dt><dd><p>Fitted continuum flux.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.check_line_man">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">check_line_man</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xcont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2800,</span> <span class="pre">3347,</span> <span class="pre">3727,</span> <span class="pre">3799,</span> <span class="pre">3836,</span> <span class="pre">3869,</span> <span class="pre">4102,</span> <span class="pre">4341,</span> <span class="pre">4861,</span> <span class="pre">4960,</span> <span class="pre">5008,</span> <span class="pre">5175,</span> <span class="pre">6563,</span> <span class="pre">6717,</span> <span class="pre">6731]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.check_line_man" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>lsig<span class="classifier">float</span></dt><dd><p>which sigma to detect lines.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.check_rejuv">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">check_rejuv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SFMS_50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm_old</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delMS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.check_rejuv" title="Permalink to this definition">¶</a></dt>
<dd><p>A Function to check rejuvenation.</p>
<dl class="simple">
<dt>delMS<span class="classifier">float</span></dt><dd><p>Scatter around the Main Sequence. 0.2 dex, in default.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.data_int">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">data_int</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmtmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftmp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.data_int" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>lmobs<span class="classifier"></span></dt><dd><p>Observed wavelength.</p>
</dd>
<dt>lmtmp, ftmp: </dt><dd><p>Those to be interpolated.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.detect_line">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">detect_line</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xcont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.detect_line" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.detect_line_man">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">detect_line_man</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xcont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.detect_line_man" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.dust_calz">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">dust_calz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmlimu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.115</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.dust_calz" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>lm<span class="classifier">float array</span></dt><dd><p>wavelength, at RF.</p>
</dd>
<dt>fl<span class="classifier">float array</span></dt><dd><p>fnu</p>
</dd>
<dt>Av<span class="classifier">float</span></dt><dd><p>in mag</p>
</dd>
<dt>nr<span class="classifier">int array</span></dt><dd><p>index, to be used for sorting.</p>
</dd>
<dt>Rv<span class="classifier"></span></dt><dd><p>from Calzetti+00</p>
</dd>
<dt>lmlimu<span class="classifier"></span></dt><dd><p>Upper limit. 2.2 in Calz+00</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.dust_gen">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">dust_gen</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmlimu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.115</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.dust_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>For general purpose (Noll+09).
This function is much better than previous, but is hard to impliment for the current version.
A difference from dust_gen is Eb is defined as a function of gamma.</p>
<dl class="simple">
<dt>lm<span class="classifier">float array</span></dt><dd><p>wavelength, at RF.</p>
</dd>
<dt>fl<span class="classifier">float array</span></dt><dd><p>fnu</p>
</dd>
<dt>Av<span class="classifier">float</span></dt><dd><p>in mag</p>
</dd>
<dt>nr<span class="classifier">int array</span></dt><dd><p>index, to be used for sorting.</p>
</dd>
<dt>Rv<span class="classifier"></span></dt><dd><p>from Calzetti+00</p>
</dd>
<dt>gamma :</dt><dd><p>gamma.</p>
</dd>
<dt>Eb:</dt><dd><p>Eb</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.dust_kc">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">dust_kc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmlimu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.115</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.dust_kc" title="Permalink to this definition">¶</a></dt>
<dd><p>Dust model by Kriek&amp;Conroy13</p>
<dl class="simple">
<dt>lm<span class="classifier">float array</span></dt><dd><p>RF Wavelength.</p>
</dd>
<dt>fl<span class="classifier">float array</span></dt><dd><p>in fnu</p>
</dd>
<dt>Av<span class="classifier">float</span></dt><dd><p>in mag</p>
</dd>
<dt>nr<span class="classifier">int array</span></dt><dd><p>index, to be used for sorting.</p>
</dd>
<dt>Rv<span class="classifier">float</span></dt><dd><p>from Calzetti+00</p>
</dd>
<dt>gamma<span class="classifier">float</span></dt><dd><p>See Eq.1</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.dust_mw">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">dust_mw</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.dust_mw" title="Permalink to this definition">¶</a></dt>
<dd><p># lm (float array) : wavelength, at RF, in AA.
# fl (float array) : fnu
# Av (float)       : mag
# nr (int array)   : index, to be used for sorting.
# Rv: =3.1 for MW.
#</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.fil_fwhm">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">fil_fwhm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.fil_fwhm" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>f0 :</dt><dd><p>in fnu</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.filconv">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">filconv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_regist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MB</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.filconv" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>f0<span class="classifier"></span></dt><dd><p>Flux for spectrum, in fnu</p>
</dd>
<dt>l0<span class="classifier"></span></dt><dd><p>Wavelength for spectrum, in AA (that matches filter response curve’s.)</p>
</dd>
<dt>f_regist<span class="classifier"></span></dt><dd><p>If True, read filter response curve.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.filconv_cen">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">filconv_cen</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'FILT/'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.filconv_cen" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolution of templates with filter response curves.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.filconv_fast">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">filconv_fast</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.filconv_fast" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>filts, band<span class="classifier"></span></dt><dd><p>From MB.filts and MB.band, respectively.</p>
</dd>
<dt>f0: </dt><dd><p>Flux for spectrum, in fnu</p>
</dd>
<dt>l0: </dt><dd><p>Wavelength for spectrum, in AA (that matches filter response curve’s.)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.fit_spec">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">fit_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftmp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.fit_spec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.fit_specphot">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">fit_specphot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fbb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltmp_bb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftmp_bb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.fit_specphot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.flamtonu">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">flamtonu</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.flamtonu" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from Flam to Fnu, with mag zeropoint of m0set.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.fnutolam">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">fnutolam</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.fnutolam" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from Fnu to Flam, with mag zeropoint of m0set.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.fnutonu">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">fnutonu</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fnu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">48.6</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.fnutonu" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from Fnu (cgs) to Fnu (m0=m0set)</p>
<dl class="simple">
<dt>fnu<span class="classifier"></span></dt><dd><p>flux in cgs, with magnitude zero point of m0input.</p>
</dd>
<dt>m0set<span class="classifier"></span></dt><dd><p>Target mag zero point.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.gaus">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">gaus</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.gaus" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.gauss">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">gauss</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.gauss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.get_Fint">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">get_Fint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmtmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_Fint" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>lmtmp<span class="classifier"></span></dt><dd><p>Rest frame wave (AA)</p>
</dd>
<dt>ftmp :</dt><dd><p>Fnu ()</p>
</dd>
</dl>
<p>integrated flux.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.get_Fuv">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">get_Fuv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmtmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_Fuv" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>lmtmp<span class="classifier"></span></dt><dd><p>Rest-frame wavelength, in AA.</p>
</dd>
<dt>ftmp<span class="classifier"></span></dt><dd><p>Fnu</p>
</dd>
</dl>
<p>Convolved flux density. Not integrated sum.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.get_SFMS">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">get_SFMS</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">red</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IMF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_SFMS" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets SFMS at age ago from z=red.</p>
<dl class="simple">
<dt>red<span class="classifier">float</span></dt><dd><p>Observed redshift</p>
</dd>
<dt>age<span class="classifier">array</span></dt><dd><p>lookback time, in Gyr.</p>
</dd>
<dt>mass<span class="classifier">array</span></dt><dd><p>stellar mass (array) at each age, in Msun (not logM).</p>
</dd>
</dl>
<p>SFR, in logMsun/yr.</p>
<p>From Speagle+14 Eq28.
Chabrier IMF, in default</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.get_filt">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">get_filt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">LIBFILT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NFILT</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_filt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.get_fit">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">get_fit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsfh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Del.'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.get_ind">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">get_ind</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets Lick index for input input</p>
<p>equivalent width</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.get_input">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">get_input</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a default dictionary for input params.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.get_leastsq">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">get_leastsq</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ZZtmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fneld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chidef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zbest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_leastsq" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets initial parameters at various Z</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.loadcpkl">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">loadcpkl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpklfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.loadcpkl" title="Permalink to this definition">¶</a></dt>
<dd><p>Load cpkl files.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.moffat">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">moffat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.moffat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function.printProgressBar">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">printProgressBar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'█'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">printEnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emojis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.printProgressBar" title="Permalink to this definition">¶</a></dt>
<dd><p>Call in a loop to create terminal progress bar.</p>
<dl class="simple">
<dt>iteration<span class="classifier">int </span></dt><dd><p>current iteration</p>
</dd>
<dt>total<span class="classifier">int </span></dt><dd><p>total iterations</p>
</dd>
<dt>prefix<span class="classifier">str</span></dt><dd><p>prefix string</p>
</dd>
<dt>suffix<span class="classifier">str</span></dt><dd><p>suffix string</p>
</dd>
<dt>decimals<span class="classifier">int</span></dt><dd><p>positive number of decimals in percent complete</p>
</dd>
<dt>length<span class="classifier">int</span></dt><dd><p>character length of bar</p>
</dd>
<dt>fill<span class="classifier">str</span></dt><dd><p>bar fill character</p>
</dd>
<dt>printEnd<span class="classifier">str </span></dt><dd><p>end character</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.read_input">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">read_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.read_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets info from param file.</p>
<p>Input dictionary.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.savecpkl">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">savecpkl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpklfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.savecpkl" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data into cpklfile.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function.write_input">
<code class="sig-prename descclassname"><span class="pre">gsf.function.</span></code><code class="sig-name descname"><span class="pre">write_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gsf.input'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.write_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets an ascii format param file.</p>
<p>file_out</p>
</dd></dl>

</div>
<div class="section" id="module-gsf.function_class">
<span id="gsf-function-class-module"></span><h2>gsf.function_class module<a class="headerlink" href="#module-gsf.function_class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="gsf.function_class.Func">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gsf.function_class.</span></code><code class="sig-name descname"><span class="pre">Func</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The list of (possible) <cite>Func</cite> attributes is given below:</p>
<dl class="py method">
<dt id="gsf.function_class.Func.demo">
<code class="sig-name descname"><span class="pre">demo</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.demo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="gsf.function_class.Func.get_template">
<code class="sig-name descname"><span class="pre">get_template</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lib</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Amp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_bb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.get_template" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets an element template given a set of parameters.
Not necessarily the most efficient way, but easy to use.</p>
<dl class="simple">
<dt>lib<span class="classifier">dict</span></dt><dd><p>library dictionary.</p>
</dd>
<dt>Amp<span class="classifier">float</span></dt><dd><p>Amplitude of the target template. Note that each template has Lbol = 1e10Lsun.</p>
</dd>
<dt>T<span class="classifier">float</span></dt><dd><p>Age, in Gyr.</p>
</dd>
<dt>Av<span class="classifier">float</span></dt><dd><p>Dust attenuation, in mag.</p>
</dd>
<dt>Z<span class="classifier">float</span></dt><dd><p>Metallicity, in log(Z/Zsun).</p>
</dd>
<dt>zgal<span class="classifier">float</span></dt><dd><p>Redshift.</p>
</dd>
<dt>f_bb: bool</dt><dd><p>If calculate bb photometry for the spectrum requested.</p>
</dd>
<dt>Returns</dt><dd><p>flux : float array. Flux in Fnu. 
wavelength : float array. Wave in AA.
lcen, lflux : , if f_bb==True.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gsf.function_class.Func.open_spec_dust_fits">
<code class="sig-name descname"><span class="pre">open_spec_dust_fits</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.open_spec_dust_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads dust template in obs range.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.function_class.Func.open_spec_fits">
<code class="sig-name descname"><span class="pre">open_spec_fits</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.open_spec_fits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="gsf.function_class.Func.open_spec_fits_dir">
<code class="sig-name descname"><span class="pre">open_spec_fits_dir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A00</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.open_spec_fits_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Load template in obs range.
But for weird template.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.function_class.Func.tmp03">
<code class="sig-name descname"><span class="pre">tmp03</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.tmp03" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="gsf.function_class.Func.tmp04">
<code class="sig-name descname"><span class="pre">tmp04</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.tmp04" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes model template with a given param set.
Also dust attenuation.</p>
<dl class="simple">
<dt>nprec<span class="classifier">int</span></dt><dd><p>Precision when redshift is refined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gsf.function_class.Func.tmp04_dust">
<code class="sig-name descname"><span class="pre">tmp04_dust</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.tmp04_dust" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes model template with a given param setself.
Also dust attenuation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gsf.function_class.Func_tau">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gsf.function_class.</span></code><code class="sig-name descname"><span class="pre">Func_tau</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="gsf.function_class.Func_tau.demo">
<code class="sig-name descname"><span class="pre">demo</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau.demo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="gsf.function_class.Func_tau.open_spec_dust_fits">
<code class="sig-name descname"><span class="pre">open_spec_dust_fits</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau.open_spec_dust_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Load dust template in obs range.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.function_class.Func_tau.open_spec_fits">
<code class="sig-name descname"><span class="pre">open_spec_fits</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau.open_spec_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads template in obs range.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.function_class.Func_tau.open_spec_fits_dir">
<code class="sig-name descname"><span class="pre">open_spec_fits_dir</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A00</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau.open_spec_fits_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads template in obs range.
But for weird template.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.function_class.Func_tau.tmp04">
<code class="sig-name descname"><span class="pre">tmp04</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau.tmp04" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes model template with a given param set.
Also dust attenuation.</p>
<dl class="simple">
<dt>nprec<span class="classifier">int</span></dt><dd><p>Precision when redshift is refined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gsf.function_class.Func_tau.tmp04_dust">
<code class="sig-name descname"><span class="pre">tmp04_dust</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau.tmp04_dust" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes model template with a given param setself.
Also dust attenuation.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gsf.function_igm">
<span id="gsf-function-igm-module"></span><h2>gsf.function_igm module<a class="headerlink" href="#module-gsf.function_igm" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="gsf.function_igm.get_H">
<code class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></code><code class="sig-name descname"><span class="pre">get_H</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.get_H" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function_igm.get_column">
<code class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></code><code class="sig-name descname"><span class="pre">get_column</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mpc_cm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.08568025e+24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.get_column" title="Permalink to this definition">¶</a></dt>
<dd><p>HI column density of IGM at zin, in cm^-3.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function_igm.get_nH">
<code class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></code><code class="sig-name descname"><span class="pre">get_nH</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.get_nH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.function_igm.get_sig_lya">
<code class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></code><code class="sig-name descname"><span class="pre">get_sig_lya</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lam_o</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e+18</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.get_sig_lya" title="Permalink to this definition">¶</a></dt>
<dd><p>lam_o : Observed wavelength.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.function_igm.madau_igm_abs">
<code class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></code><code class="sig-name descname"><span class="pre">madau_igm_abs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xtmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.madau_igm_abs" title="Permalink to this definition">¶</a></dt>
<dd><p>IMG-attenuates the input flux at zin.</p>
<p>xtmp: RF wavelength in AA.
ytmp: flux in f_lambda.
z_in: observed redshift.</p>
<p>IGM attenuated flux.</p>
</dd></dl>

</div>
<div class="section" id="module-gsf.gsf">
<span id="gsf-gsf-module"></span><h2>gsf.gsf module<a class="headerlink" href="#module-gsf.gsf" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="gsf.gsf.run_gsf_all">
<code class="sig-prename descclassname"><span class="pre">gsf.gsf.</span></code><code class="sig-name descname"><span class="pre">run_gsf_all</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fplt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cornerplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_SFMS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_sed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figpdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_sfh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fancyplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_zhist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tset_SFR_SED</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zini</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.gsf.run_gsf_all" title="Permalink to this definition">¶</a></dt>
<dd><p>gsf pipeline, which runs all steps.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.gsf.run_gsf_template">
<code class="sig-prename descclassname"><span class="pre">gsf.gsf.</span></code><code class="sig-name descname"><span class="pre">run_gsf_template</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fplt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.gsf.run_gsf_template" title="Permalink to this definition">¶</a></dt>
<dd><p>This is only for 0 and 1, to get templates.
Not for fitting, nor plotting.</p>
</dd></dl>

</div>
<div class="section" id="module-gsf.maketmp_filt">
<span id="gsf-maketmp-filt-module"></span><h2>gsf.maketmp_filt module<a class="headerlink" href="#module-gsf.maketmp_filt" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="gsf.maketmp_filt.check_library">
<code class="sig-prename descclassname"><span class="pre">gsf.maketmp_filt.</span></code><code class="sig-name descname"><span class="pre">check_library</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">af</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_filt.check_library" title="Permalink to this definition">¶</a></dt>
<dd><p>Check library if it has a consistency setup as input file.</p>
<p>True is no problem.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.maketmp_filt.get_LSF">
<code class="sig-prename descclassname"><span class="pre">gsf.maketmp_filt.</span></code><code class="sig-name descname"><span class="pre">get_LSF</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_EXTR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e+18</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_filt.get_LSF" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets Morphology params, and returns LSF</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.maketmp_filt.get_spectrum_draine">
<code class="sig-prename descclassname"><span class="pre">gsf.maketmp_filt.</span></code><code class="sig-name descname"><span class="pre">get_spectrum_draine</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda_d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zbest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_DUST</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/tmorishita/Downloads/DL07spec/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.055</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_filt.get_spectrum_draine" title="Permalink to this definition">¶</a></dt>
<dd><p>lambda_d : Wavelength array, in AA.
phi (default: 0.055): Eq.34 of Draine &amp; Li 2007.</p>
<p>Interpolated dust emission in Fnu of m0=25.0. In units of Fnu/Msun</p>
<p>umins = [‘0.10’, ‘0.15’, ‘0.20’, ‘0.30’, ‘0.40’, ‘0.50’, ‘0.70’, ‘0.80’, ‘1.00’, ‘1.20’,            ‘1.50’, ‘2.00’, ‘2.50’, ‘3.00’, ‘4.00’, ‘5.00’, ‘7.00’, ‘8.00’, ‘10.0’, ‘12.0’, ‘15.0’,            ‘20.0’, ‘25.0’]
umaxs = [‘1e3’, ‘1e4’, ‘1e5’, ‘1e6’, ‘1e7’]</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.maketmp_filt.maketemp">
<code class="sig-prename descclassname"><span class="pre">gsf.maketmp_filt.</span></code><code class="sig-name descname"><span class="pre">maketemp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebblim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamliml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamlimu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolbb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_filt.maketemp" title="Permalink to this definition">¶</a></dt>
<dd><p>Make SPECTRA at given z and filter set.</p>
<p>inputs      : Configuration file.
zbest(float): Best redshift at this iteration. Templates are generated based on this reshift.
Z (array)   : Stellar phase metallicity in logZsun.
age (array) : Age, in Gyr.
fneb (int)  : flag for adding nebular emissionself.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.maketmp_filt.maketemp_tau">
<code class="sig-prename descclassname"><span class="pre">gsf.maketmp_filt.</span></code><code class="sig-name descname"><span class="pre">maketemp_tau</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebblim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamliml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamlimu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolbb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_IGM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_filt.maketemp_tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Make SPECTRA at given z and filter set.</p>
<p>inputs      : Configuration file.
zbest(float): Best redshift at this iteration. Templates are generated based on this reshift.
Z (array)   : Stellar phase metallicity in logZsun.
age (array) : Age, in Gyr.
fneb (int)  : flag for adding nebular emissionself.
f_IGM (bool): IGM attenuation. Madau.
nthin (int) : Thinning templates.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.maketmp_filt.sim_spec">
<code class="sig-prename descclassname"><span class="pre">gsf.maketmp_filt.</span></code><code class="sig-name descname"><span class="pre">sim_spec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_filt.sim_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>SIMULATION of SPECTRA.</p>
<p>wave_obs, wave_temp, flux_temp, sn_obs
Return: frand, erand</p>
</dd></dl>

</div>
<div class="section" id="module-gsf.maketmp_z0">
<span id="gsf-maketmp-z0-module"></span><h2>gsf.maketmp_z0 module<a class="headerlink" href="#module-gsf.maketmp_z0" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="gsf.maketmp_z0.make_tmp_z0">
<code class="sig-prename descclassname"><span class="pre">gsf.maketmp_z0.</span></code><code class="sig-name descname"><span class="pre">make_tmp_z0</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_z0.make_tmp_z0" title="Permalink to this definition">¶</a></dt>
<dd><p>This is for the preparation of default template, with FSPS, at z=0.
Should be run before SED fitting.</p>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.fitting.Mainbody" title="gsf.fitting.Mainbody"><code class="xref py py-class docutils literal notranslate"><span class="pre">gsf.fitting.Mainbody</span></code></a><span class="classifier">class</span></dt><dd><p>Mainbody class, that contains attributes.</p>
</dd>
<dt>lammin<span class="classifier">float, optional</span></dt><dd><p>Minimum value of the rest-frame wavelength of the template, in AA.</p>
</dd>
<dt>lammax<span class="classifier">float, optional</span></dt><dd><p>Maximum value of the rest-frame wavelength of the template, in AA.</p>
</dd>
<dt>tau_lim<span class="classifier">float, optional</span></dt><dd><p>Maximum value of tau of the template, in Gyr. Tau smaller than this 
value would be approximated by SSP.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.maketmp_z0.make_tmp_z0_bpass">
<code class="sig-prename descclassname"><span class="pre">gsf.maketmp_z0.</span></code><code class="sig-name descname"><span class="pre">make_tmp_z0_bpass</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BPASS_DIR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/astro/udfcen3/Takahiro/BPASS/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BPASS_ver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'v2.2.1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zsun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_z0.make_tmp_z0_bpass" title="Permalink to this definition">¶</a></dt>
<dd><p>This is for the preparation of default template, with BPASS templates, at z=0.
Should be run before SED fitting.</p>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.fitting.Mainbody" title="gsf.fitting.Mainbody"><code class="xref py py-class docutils literal notranslate"><span class="pre">gsf.fitting.Mainbody</span></code></a><span class="classifier">class</span></dt><dd><p>Mainbody class, that contains attributes.</p>
</dd>
<dt>lammin<span class="classifier">float, optional</span></dt><dd><p>Minimum value of the rest-frame wavelength of the template, in AA.</p>
</dd>
<dt>lammax<span class="classifier">float, optional</span></dt><dd><p>Maximum value of the rest-frame wavelength of the template, in AA.</p>
</dd>
<dt>BPASS_DIR<span class="classifier">str, optional</span></dt><dd><p>Path to the ditectory where BPASS templates are storesd.</p>
</dd>
<dt>BPASS_ver<span class="classifier">str, optional</span></dt><dd><p>Version of BPASS. Used to identify template files.</p>
</dd>
<dt>Zsun<span class="classifier">float, optional</span></dt><dd><p>Metallicity of templates, in units of absolute value (e.g. Zsun=0.02 for BPASS).</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-gsf.maketmp_z0_tau">
<span id="gsf-maketmp-z0-tau-module"></span><h2>gsf.maketmp_z0_tau module<a class="headerlink" href="#module-gsf.maketmp_z0_tau" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="gsf.maketmp_z0_tau.get_lognorm">
<code class="sig-prename descclassname"><span class="pre">gsf.maketmp_z0_tau.</span></code><code class="sig-name descname"><span class="pre">get_lognorm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltau0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_z0_tau.get_lognorm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.maketmp_z0_tau.make_tmp_z0">
<code class="sig-prename descclassname"><span class="pre">gsf.maketmp_z0_tau.</span></code><code class="sig-name descname"><span class="pre">make_tmp_z0</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_z0_tau.make_tmp_z0" title="Permalink to this definition">¶</a></dt>
<dd><p>This is for the preparation of default template, with FSPS, at z=0.
Should be run before SED fitting.</p>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.fitting.Mainbody" title="gsf.fitting.Mainbody"><code class="xref py py-class docutils literal notranslate"><span class="pre">gsf.fitting.Mainbody</span></code></a><span class="classifier">class</span></dt><dd><p>Mainbody class, that contains attributes.</p>
</dd>
<dt>lammin<span class="classifier">float, optional</span></dt><dd><p>Minimum value of the rest-frame wavelength of the template, in AA.</p>
</dd>
<dt>lammax<span class="classifier">float, optional</span></dt><dd><p>Maximum value of the rest-frame wavelength of the template, in AA.</p>
</dd>
<dt>tau_lim<span class="classifier">float, optional</span></dt><dd><p>Maximum value of tau of the template, in Gyr. Tau smaller than this 
value would be approximated by SSP.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-gsf.minimizer">
<span id="gsf-minimizer-module"></span><h2>gsf.minimizer module<a class="headerlink" href="#module-gsf.minimizer" title="Permalink to this headline">¶</a></h2>
<p>Simple minimizer is a wrapper around scipy.leastsq, allowing a user to build
a fitting model as a function of general purpose Fit Parameters that can be
fixed or varied, bounded, and written as a simple expression of other Fit
Parameters.</p>
<p>The user sets up a model in terms of instance of Parameters and writes a
function-to-be-minimized (residual function) in terms of these Parameters.</p>
<dl class="simple">
<dt>Original copyright:</dt><dd><p>Copyright (c) 2011 Matthew Newville, The University of Chicago</p>
</dd>
</dl>
<p>See LICENSE for more complete authorship information and license.</p>
<dl class="py exception">
<dt id="gsf.minimizer.AbortFitException">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></code><code class="sig-name descname"><span class="pre">AbortFitException</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.AbortFitException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gsf.minimizer.MinimizerException" title="gsf.minimizer.MinimizerException"><code class="xref py py-class docutils literal notranslate"><span class="pre">gsf.minimizer.MinimizerException</span></code></a></p>
<p>Raised when a fit is aborted by the user.</p>
</dd></dl>

<dl class="py class">
<dt id="gsf.minimizer.Candidate">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></code><code class="sig-name descname"><span class="pre">Candidate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Candidate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt id="gsf.minimizer.Candidate.params">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">params</span></code><a class="headerlink" href="#gsf.minimizer.Candidate.params" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Candidate.score">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">score</span></code><a class="headerlink" href="#gsf.minimizer.Candidate.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gsf.minimizer.Minimizer">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></code><code class="sig-name descname"><span class="pre">Minimizer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">userfcn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn_kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_cb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_fcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A general minimizer for curve fitting and optimization.</p>
<dl class="py method">
<dt id="gsf.minimizer.Minimizer.ampgo">
<code class="sig-name descname"><span class="pre">ampgo</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.ampgo" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the global minimum of a multivariate function using AMPGO.</p>
<p>AMPGO stands for ‘Adaptive Memory Programming for Global Optimization’
and is an efficient algorithm to find the global minimum.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</p>
</dd>
<dt><a href="#id1"><span class="problematic" id="id2">**</span></a>kws<span class="classifier">dict, optional</span></dt><dd><p>Minimizer options to pass to the ampgo algorithm, the options are
listed below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>local: str (default is &#39;L-BFGS-B&#39;)
    Name of the local minimization method. Valid options are:
    - &#39;L-BFGS-B&#39;
    - &#39;Nelder-Mead&#39;
    - &#39;Powell&#39;
    - &#39;TNC&#39;
    - &#39;SLSQP&#39;
local_opts: dict (default is None)
    Options to pass to the local minimizer.
maxfunevals: int (default is None)
    Maximum number of function evaluations. If None, the optimization will stop
    after `totaliter` number of iterations.
totaliter: int (default is 20)
    Maximum number of global iterations.
maxiter: int (default is 5)
    Maximum number of `Tabu Tunneling` iterations during each global iteration.
glbtol: float (default is 1e-5)
    Tolerance whether or not to accept a solution after a tunneling phase.
eps1: float (default is 0.02)
    Constant used to define an aspiration value for the objective function during
    the Tunneling phase.
eps2: float (default is 0.1)
    Perturbation factor used to move away from the latest local minimum at the
    start of a Tunneling phase.
tabulistsize: int (default is 5)
    Size of the (circular) tabu search list.
tabustrategy: str (default is &#39;farthest&#39;)
    Strategy to use when the size of the tabu list exceeds `tabulistsize`. It
    can be &#39;oldest&#39; to drop the oldest point from the tabu list or &#39;farthest&#39;
    to drop the element farthest from the last local minimum found.
disp: bool (default is False)
    Set to True to print convergence messages.
</pre></div>
</div>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the parameters from the ampgo method, with fit
parameters, statistics and such. The return values (<cite>x0</cite>, <cite>fval</cite>,
<cite>eval</cite>, <cite>msg</cite>, <cite>tunnel</cite>) are stored as <cite>ampgo_&lt;parname&gt;</cite> attributes.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.10.</span></p>
</div>
<p>The Python implementation was written by Andrea Gavana in 2014
(<a class="reference external" href="http://infinity77.net/global_optimization/index.html">http://infinity77.net/global_optimization/index.html</a>).</p>
<p>The details of the AMPGO algorithm are described in the paper
“Adaptive Memory Programming for Constrained Global Optimization”
located here:</p>
<p><a class="reference external" href="http://leeds-faculty.colorado.edu/glover/fred%20pubs/416%20-%20AMP%20(TS)%20for%20Constrained%20Global%20Opt%20w%20Lasdon%20et%20al%20.pdf">http://leeds-faculty.colorado.edu/glover/fred%20pubs/416%20-%20AMP%20(TS)%20for%20Constrained%20Global%20Opt%20w%20Lasdon%20et%20al%20.pdf</a></p>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.basinhopping">
<code class="sig-name descname"><span class="pre">basinhopping</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.basinhopping" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the <cite>basinhopping</cite> algorithm to find the global minimum of a function.</p>
<p>This method calls <a href="#id3"><span class="problematic" id="id4">:scipydoc:`optimize.basinhopping`</span></a> using the default
arguments. The default minimizer is <cite>BFGS</cite>, but since lmfit supports
parameter bounds for all minimizers, the user can choose any of the
solvers present in <a href="#id5"><span class="problematic" id="id6">:scipydoc:`optimize.minimize`</span></a>.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code> object, optional</span></dt><dd><p>Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the optimization results from the basinhopping
algorithm.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.10.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.brute">
<code class="sig-name descname"><span class="pre">brute</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.brute" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the <cite>brute</cite> method to find the global minimum of a function.</p>
<p>The following parameters are passed to <a href="#id7"><span class="problematic" id="id8">:scipydoc:`optimize.brute`</span></a>
and cannot be changed:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 11%" />
<col style="width: 61%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><a class="reference internal" href="#gsf.minimizer.Minimizer.brute" title="gsf.minimizer.Minimizer.brute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">brute()</span></code></a> arg</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>full_output</p></td>
<td><p>1</p></td>
<td><p>Return the evaluation grid and
the objective function’s values on it.</p></td>
</tr>
<tr class="row-odd"><td><p>finish</p></td>
<td><p>None</p></td>
<td><p>No “polishing” function is to be used
after the grid search.</p></td>
</tr>
<tr class="row-even"><td><p>disp</p></td>
<td><p>False</p></td>
<td><p>Do not print convergence messages
(when finish is not None).</p></td>
</tr>
</tbody>
</table>
<p>It assumes that the input Parameters have been initialized, and a
function to minimize has been properly set up.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</p>
</dd>
<dt>Ns<span class="classifier">int, optional</span></dt><dd><p>Number of grid points along the axes, if not otherwise specified
(see Notes).</p>
</dd>
<dt>keep<span class="classifier">int, optional</span></dt><dd><p>Number of best candidates from the brute force method that are
stored in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">candidates</span></code> attribute. If ‘all’, then all grid
points from <a href="#id9"><span class="problematic" id="id10">:scipydoc:`optimize.brute`</span></a> are stored as candidates.</p>
</dd>
<dt>workers<span class="classifier">int or map-like callable, optional</span></dt><dd><p>For parallel evaluation of the grid, added in SciPy v1.3 (see
<a href="#id11"><span class="problematic" id="id12">:scipydoc:`optimize.brute`</span></a> for more details).</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the parameters from the brute force method.
The return values (<cite>x0</cite>, <cite>fval</cite>, <cite>grid</cite>, <cite>Jout</cite>) from
<a href="#id13"><span class="problematic" id="id14">:scipydoc:`optimize.brute`</span></a> are stored as <cite>brute_&lt;parname&gt;</cite> attributes.
The <cite>MinimizerResult</cite> also contains the <cite>candidates</cite> attribute and
<cite>show_candidates()</cite> method. The <cite>candidates</cite> attribute contains the
parameters and chisqr from the brute force method as a namedtuple,
(‘Candidate’, [‘params’, ‘score’]), sorted on the (lowest) chisqr
value. To access the values for a particular candidate one can use
<cite>result.candidate[#].params</cite> or <cite>result.candidate[#].score</cite>, where
a lower # represents a better candidate. The <cite>show_candidates(#)</cite>
uses the <code class="xref py py-meth docutils literal notranslate"><span class="pre">pretty_print()</span></code> method to show a specific candidate-#
or all candidates when no number is specified.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.6.</span></p>
</div>
<p>The <a class="reference internal" href="#gsf.minimizer.Minimizer.brute" title="gsf.minimizer.Minimizer.brute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">brute()</span></code></a> method evalutes the function at each point of a
multidimensional grid of points. The grid points are generated from the
parameter ranges using <cite>Ns</cite> and (optional) <cite>brute_step</cite>.
The implementation in <a href="#id15"><span class="problematic" id="id16">:scipydoc:`optimize.brute`</span></a> requires finite bounds
and the <cite>range</cite> is specified as a two-tuple <cite>(min, max)</cite> or slice-object
<cite>(min, max, brute_step)</cite>. A slice-object is used directly, whereas a
two-tuple is converted to a slice object that interpolates <cite>Ns</cite> points
from <cite>min</cite> to <cite>max</cite>, inclusive.</p>
<p>In addition, the <a class="reference internal" href="#gsf.minimizer.Minimizer.brute" title="gsf.minimizer.Minimizer.brute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">brute()</span></code></a> method in lmfit, handles three other
scenarios given below with their respective slice-object:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>lower bound (<code class="xref py py-attr docutils literal notranslate"><span class="pre">min</span></code>) and <code class="xref py py-attr docutils literal notranslate"><span class="pre">brute_step</span></code> are specified:</dt><dd><p>range = (<cite>min</cite>, <cite>min</cite> + <cite>Ns</cite> * <cite>brute_step</cite>, <cite>brute_step</cite>).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>upper bound (<code class="xref py py-attr docutils literal notranslate"><span class="pre">max</span></code>) and <code class="xref py py-attr docutils literal notranslate"><span class="pre">brute_step</span></code> are specified:</dt><dd><p>range = (<cite>max</cite> - <cite>Ns</cite> * <cite>brute_step</cite>, <cite>max</cite>, <cite>brute_step</cite>).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>numerical value (<code class="xref py py-attr docutils literal notranslate"><span class="pre">value</span></code>) and <code class="xref py py-attr docutils literal notranslate"><span class="pre">brute_step</span></code> are specified:</dt><dd><p>range = (<cite>value</cite> - (<cite>Ns</cite>//2) * <cite>brute_step</cite>, <cite>value</cite> +
(<cite>Ns</cite>//2) * <cite>brute_step</cite>, <cite>brute_step</cite>).</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.dual_annealing">
<code class="sig-name descname"><span class="pre">dual_annealing</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.dual_annealing" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the <cite>dual_annealing</cite> algorithm to find the global minimum.</p>
<p>This method calls <a href="#id17"><span class="problematic" id="id18">:scipydoc:`optimize.dual_annealing`</span></a> using its
default arguments.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</p>
</dd>
<dt><a href="#id19"><span class="problematic" id="id20">**</span></a>kws<span class="classifier">dict, optional</span></dt><dd><p>Minimizer options to pass to the dual_annealing algorithm.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the parameters from the dual_annealing method.
The return values specific to <a href="#id21"><span class="problematic" id="id22">:scipydoc:`optimize.dual_annealing`</span></a>
(<cite>x</cite>, <cite>fun</cite>, <cite>nfev</cite>, <cite>nhev</cite>, <cite>njev</cite>, and <cite>nit</cite>) are stored as
<cite>da_&lt;parname&gt;</cite> attributes.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.14.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.emcee">
<code class="sig-name descname"><span class="pre">emcee</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntemps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_sampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float_behavior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'posterior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_converge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nevery</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.emcee" title="Permalink to this definition">¶</a></dt>
<dd><p>Bayesian sampling of the posterior distribution using the <cite>emcee</cite>
Markov Chain Monte Carlo package.</p>
<p>The method assumes that the prior is Uniform. You need to have <cite>emcee</cite>
version 3 installed to use this method.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Parameters to use as starting point. If this is not specified then
the Parameters used to initialize the Minimizer object are used.</p>
</dd>
<dt>steps<span class="classifier">int, optional</span></dt><dd><p>How many samples you would like to draw from the posterior
distribution for each of the walkers?</p>
</dd>
<dt>nwalkers<span class="classifier">int, optional</span></dt><dd><p>Should be set so <span class="math notranslate nohighlight">\(nwalkers &gt;&gt; nvarys\)</span>, where <cite>nvarys</cite> are
the number of parameters being varied during the fit.
‘Walkers are the members of the ensemble. They are almost like
separate Metropolis-Hastings chains but, of course, the proposal
distribution for a given walker depends on the positions of all
the other walkers in the ensemble.’ - from the <cite>emcee</cite> webpage.</p>
</dd>
<dt>burn<span class="classifier">int, optional</span></dt><dd><p>Discard this many samples from the start of the sampling regime.</p>
</dd>
<dt>thin<span class="classifier">int, optional</span></dt><dd><p>Only accept 1 in every <cite>thin</cite> samples.</p>
</dd>
<dt>ntemps<span class="classifier">int, deprecated</span></dt><dd><p>ntemps has no effect.</p>
</dd>
<dt>pos<span class="classifier">numpy.ndarray, optional</span></dt><dd><p>Specify the initial positions for the sampler, an ndarray of shape
<cite>(nwalkers, nvarys)</cite>.  You can also initialise using a previous
chain of the same <cite>nwalkers</cite> and <cite>nvarys</cite>. Note that <cite>nvarys</cite> may
be one larger than you expect it to be if your <cite>userfcn</cite> returns
an array and <cite>is_weighted</cite> is <cite>False</cite>.</p>
</dd>
<dt>reuse_sampler<span class="classifier">bool, optional</span></dt><dd><p>Set to <cite>True</cite> if you have already run <cite>emcee</cite> with the <cite>Minimizer</cite>
instance and want to continue to draw from its <code class="docutils literal notranslate"><span class="pre">sampler</span></code> (and so
retain the chain history). If <cite>False</cite>,  a new sampler is created.
The keywords <cite>nwalkers</cite>, <cite>pos</cite>, and <cite>params</cite> will be ignored when
this is set, as they will be set by the existing sampler.
<strong>Important</strong>: the Parameters used to create the sampler must not
change in-between calls to <cite>emcee</cite>. Alteration of Parameters
would include changed <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">vary</span></code> and <code class="docutils literal notranslate"><span class="pre">expr</span></code>
attributes. This may happen, for example, if you use an altered
Parameters object and call the <cite>minimize</cite> method in-between calls
to <cite>emcee</cite>.</p>
</dd>
<dt>workers<span class="classifier">Pool-like or int, optional</span></dt><dd><p>For parallelization of sampling.  It can be any Pool-like object
with a map method that follows the same calling sequence as the
built-in <cite>map</cite> function. If int is given as the argument, then a
multiprocessing-based pool is spawned internally with the
corresponding number of parallel processes. ‘mpi4py’-based
parallelization and ‘joblib’-based parallelization pools can also
be used here. <strong>Note</strong>: because of multiprocessing overhead it may
only be worth parallelising if the objective function is expensive
to calculate, or if there are a large number of objective
evaluations per step (<cite>nwalkers * nvarys</cite>).</p>
</dd>
<dt>float_behavior<span class="classifier">str, optional</span></dt><dd><p>Meaning of float (scalar) output of objective function. Use
‘posterior’ if it returns a log-posterior probability or ‘chi2’
if it returns <span class="math notranslate nohighlight">\(\chi^2\)</span>. See Notes for further details.</p>
</dd>
<dt>is_weighted<span class="classifier">bool, optional</span></dt><dd><p>Has your objective function been weighted by measurement
uncertainties? If <cite>is_weighted is True</cite> then your objective
function is assumed to return residuals that have been divided by
the true measurement uncertainty <cite>(data - model) / sigma</cite>. If
<cite>is_weighted is False</cite> then the objective function is assumed to
return unweighted residuals, <cite>data - model</cite>. In this case <cite>emcee</cite>
will employ a positive measurement uncertainty during the sampling.
This measurement uncertainty will be present in the output params
and output chain with the name <cite>__lnsigma</cite>. A side effect of this
is that you cannot use this parameter name yourself.
<strong>Important</strong> this parameter only has any effect if your objective
function returns an array. If your objective function returns a
float, then this parameter is ignored. See Notes for more details.</p>
</dd>
<dt>seed<span class="classifier">int or <cite>numpy.random.RandomState</cite>, optional</span></dt><dd><p>If <cite>seed</cite> is an int, a new <cite>numpy.random.RandomState</cite> instance is
used, seeded with <cite>seed</cite>.
If <cite>seed</cite> is already a <cite>numpy.random.RandomState</cite> instance, then
that <cite>numpy.random.RandomState</cite> instance is used.
Specify <cite>seed</cite> for repeatable minimizations.</p>
</dd>
<dt>progress<span class="classifier">bool, optional</span></dt><dd><p>Print a progress bar to the console while running.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>MinimizerResult object containing updated params, statistics,
etc. The updated params represent the median of the samples,
while the uncertainties are half the difference of the 15.87
and 84.13 percentiles.  The <cite>MinimizerResult</cite> contains a few
additional attributes: <code class="docutils literal notranslate"><span class="pre">chain</span></code> contain the samples and has
shape <cite>((steps - burn) // thin, nwalkers, nvarys)</cite>.
<code class="docutils literal notranslate"><span class="pre">flatchain</span></code> is a <cite>pandas.DataFrame</cite> of the flattened chain,
that can be accessed with <cite>result.flatchain[parname]</cite>.
<code class="docutils literal notranslate"><span class="pre">lnprob</span></code> contains the log probability for each sample in
<code class="docutils literal notranslate"><span class="pre">chain</span></code>.  The sample with the highest probability corresponds
to the maximum likelihood estimate.  <code class="docutils literal notranslate"><span class="pre">acor</span></code> is an array
containing the autocorrelation time for each parameter if the
autocorrelation time can be computed from the chain. Finally,
<code class="docutils literal notranslate"><span class="pre">acceptance_fraction</span></code> (an array of the fraction of steps
accepted for each walker).</p>
</dd>
</dl>
<p>This method samples the posterior distribution of the parameters
using Markov Chain Monte Carlo.  It calculates the log-posterior
probability of the model parameters, <cite>F</cite>, given the data, <cite>D</cite>,
<span class="math notranslate nohighlight">\(\ln p(F_{true} | D)\)</span>. This ‘posterior probability’ is given by:</p>
<div class="math notranslate nohighlight">
\[\ln p(F_{true} | D) \propto \ln p(D | F_{true}) + \ln p(F_{true})\]</div>
<p>where <span class="math notranslate nohighlight">\(\ln p(D | F_{true})\)</span> is the ‘log-likelihood’ and
<span class="math notranslate nohighlight">\(\ln p(F_{true})\)</span> is the ‘log-prior’. The default log-prior
encodes prior information known about the model that the log-prior
probability is <cite>-numpy.inf</cite> (impossible) if any of the parameters
is outside its limits, and is zero if all the parameters are inside
their bounds (uniform prior). The log-likelihood function is <a class="footnote-reference brackets" href="#id24" id="id23">1</a>:</p>
<div class="math notranslate nohighlight">
\[\ln p(D|F_{true}) = -\frac{1}{2}\sum_n \left[\frac{(g_n(F_{true}) - D_n)^2}{s_n^2}+\ln (2\pi s_n^2)\right]\]</div>
<p>The first term represents the residual (<span class="math notranslate nohighlight">\(g\)</span> being the generative
model, <span class="math notranslate nohighlight">\(D_n\)</span> the data and <span class="math notranslate nohighlight">\(s_n\)</span> the measurement
uncertainty). This gives <span class="math notranslate nohighlight">\(\chi^2\)</span> when summed over all data
points.  The objective function may also return the log-posterior
probability, <span class="math notranslate nohighlight">\(\ln p(F_{true} | D)\)</span>.  Since the default
log-prior term is zero, the objective function can also just return
the log-likelihood, unless you wish to create a non-uniform prior.</p>
<p>If the objective function returns a float value, this is assumed by
default to be the log-posterior probability, (<cite>float_behavior</cite> default
is ‘posterior’. If your objective function returns <span class="math notranslate nohighlight">\(\chi^2\)</span>,
then you should use a value of <cite>float_behavior=’chi2’</cite>.</p>
<p>By default objective functions may return an ndarray of (possibly
weighted) residuals. In this case, use <cite>is_weighted</cite> to select whether
these are correctly weighted by measurement uncertainty.  Note that
this ignores the second term above, so that to calculate a correct
log-posterior probability value your objective function should return
a float value.  With <cite>is_weighted=False</cite> the data uncertainty, <cite>s_n</cite>,
will be treated as a nuisance parameter to be marginalized out. This
uses strictly positive uncertainty (homoscedasticity) for each data
point, <span class="math notranslate nohighlight">\(s_n = \exp(\rm{\_\_lnsigma})\)</span>.  <cite>__lnsigma</cite> will be
present in <cite>MinimizerResult.params</cite>, as well as <cite>Minimizer.chain</cite> and
<cite>nvarys</cite> will be increased by one.</p>
<dl class="footnote brackets">
<dt class="label" id="id24"><span class="brackets"><a class="fn-backref" href="#id23">1</a></span></dt>
<dd><p><a class="reference external" href="https://emcee.readthedocs.io">https://emcee.readthedocs.io</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.least_squares">
<code class="sig-name descname"><span class="pre">least_squares</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.least_squares" title="Permalink to this definition">¶</a></dt>
<dd><p>Least-squares minimization using <a href="#id25"><span class="problematic" id="id26">:scipydoc:`optimize.least_squares`</span></a>.</p>
<p>This method wraps <a href="#id27"><span class="problematic" id="id28">:scipydoc:`optimize.least_squares`</span></a>, which has inbuilt
support for bounds and robust loss functions. By default it uses the
Trust Region Reflective algorithm with a linear loss function (i.e.,
the standard least-squares problem).</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Parameters to use as starting point.</p>
</dd>
<dt><a href="#id29"><span class="problematic" id="id30">**</span></a>kws<span class="classifier">dict, optional</span></dt><dd><p>Minimizer options to pass to <a href="#id31"><span class="problematic" id="id32">:scipydoc:`optimize.least_squares`</span></a>.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the optimized parameter and several
goodness-of-fit statistics.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.leastsq">
<code class="sig-name descname"><span class="pre">leastsq</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.leastsq" title="Permalink to this definition">¶</a></dt>
<dd><p>Use Levenberg-Marquardt minimization to perform a fit.</p>
<p>It assumes that the input Parameters have been initialized, and
a function to minimize has been properly set up.
When possible, this calculates the estimated uncertainties and
variable correlations from the covariance matrix.</p>
<p>This method calls <a href="#id33"><span class="problematic" id="id34">:scipydoc:`optimize.leastsq`</span></a>.
By default, numerical derivatives are used, and the following
arguments are set:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 17%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><a class="reference internal" href="#gsf.minimizer.Minimizer.leastsq" title="gsf.minimizer.Minimizer.leastsq"><code class="xref py py-meth docutils literal notranslate"><span class="pre">leastsq()</span></code></a>
arg</p></th>
<th class="head"><p>Default Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>xtol</p></td>
<td><p>1.e-7</p></td>
<td><p>Relative error in the approximate solution</p></td>
</tr>
<tr class="row-odd"><td><p>ftol</p></td>
<td><p>1.e-7</p></td>
<td><p>Relative error in the desired sum of squares</p></td>
</tr>
<tr class="row-even"><td><p>maxfev</p></td>
<td><p>2000*(nvar+1)</p></td>
<td><p>Maximum number of function calls (nvar= # of variables)</p></td>
</tr>
<tr class="row-odd"><td><p>Dfun</p></td>
<td><p>None</p></td>
<td><p>Function to call for Jacobian calculation</p></td>
</tr>
</tbody>
</table>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Parameters to use as starting point.</p>
</dd>
<dt><a href="#id35"><span class="problematic" id="id36">**</span></a>kws<span class="classifier">dict, optional</span></dt><dd><p>Minimizer options to pass to <a href="#id37"><span class="problematic" id="id38">:scipydoc:`optimize.leastsq`</span></a>.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the optimized parameter
and several goodness-of-fit statistics.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.minimize">
<code class="sig-name descname"><span class="pre">minimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'leastsq'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the minimization.</p>
<dl>
<dt>method<span class="classifier">str, optional</span></dt><dd><p>Name of the fitting method to use. Valid values are:</p>
<ul class="simple">
<li><p><cite>‘leastsq’</cite>: Levenberg-Marquardt (default)</p></li>
<li><p><cite>‘least_squares’</cite>: Least-Squares minimization, using Trust Region Reflective method</p></li>
<li><p><cite>‘differential_evolution’</cite>: differential evolution</p></li>
<li><p><cite>‘brute’</cite>: brute force method</p></li>
<li><p><cite>‘basinhopping’</cite>: basinhopping</p></li>
<li><p><cite>‘ampgo’</cite>: Adaptive Memory Programming for Global Optimization</p></li>
<li><p>‘<cite>nelder</cite>’: Nelder-Mead</p></li>
<li><p><cite>‘lbfgsb’</cite>: L-BFGS-B</p></li>
<li><p><cite>‘powell’</cite>: Powell</p></li>
<li><p><cite>‘cg’</cite>: Conjugate-Gradient</p></li>
<li><p><cite>‘newton’</cite>: Newton-CG</p></li>
<li><p><cite>‘cobyla’</cite>: Cobyla</p></li>
<li><p><cite>‘bfgs’</cite>: BFGS</p></li>
<li><p><cite>‘tnc’</cite>: Truncated Newton</p></li>
<li><p><cite>‘trust-ncg’</cite>: Newton-CG trust-region</p></li>
<li><p><cite>‘trust-exact’</cite>: nearly exact trust-region</p></li>
<li><p><cite>‘trust-krylov’</cite>: Newton GLTR trust-region</p></li>
<li><p><cite>‘trust-constr’</cite>: trust-region for constrained optimization</p></li>
<li><p><cite>‘dogleg’</cite>: Dog-leg trust-region</p></li>
<li><p><cite>‘slsqp’</cite>: Sequential Linear Squares Programming</p></li>
<li><p><cite>‘emcee’</cite>: Maximum likelihood via Monte-Carlo Markov Chain</p></li>
<li><p><cite>‘shgo’</cite>: Simplicial Homology Global Optimization</p></li>
<li><p><cite>‘dual_annealing’</cite>: Dual Annealing optimization</p></li>
</ul>
<p>In most cases, these methods wrap and use the method with the
same name from <cite>scipy.optimize</cite>, or use
<cite>scipy.optimize.minimize</cite> with the same <cite>method</cite> argument.
Thus ‘<cite>leastsq</cite>’ will use <cite>scipy.optimize.leastsq</cite>, while
‘<cite>powell</cite>’ will use <cite>scipy.optimize.minimizer(…,
method=’powell’)</cite></p>
<p>For more details on the fitting methods please refer to the
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html">SciPy docs</a>.</p>
</dd>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Parameters of the model to use as starting values.</p>
</dd>
<dt><a href="#id39"><span class="problematic" id="id40">**</span></a>kws<span class="classifier">optional</span></dt><dd><p>Additional arguments are passed to the underlying minimization
method.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the optimized parameter and several
goodness-of-fit statistics.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.penalty">
<code class="sig-name descname"><span class="pre">penalty</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fvars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.penalty" title="Permalink to this definition">¶</a></dt>
<dd><p>Penalty function for scalar minimizers.</p>
<dl class="simple">
<dt>fvars<span class="classifier">numpy.ndarray</span></dt><dd><p>Array of values for the variable parameters.</p>
</dd>
</dl>
<dl>
<dt>r<span class="classifier">float</span></dt><dd><p>The evaluated user-supplied objective function.</p>
<p>If the objective function is an array of size greater than 1,
use the scalar returned by <cite>self.reduce_fcn</cite>.  This defaults
to sum-of-squares, but can be replaced by other options.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.prepare_fit">
<code class="sig-name descname"><span class="pre">prepare_fit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.prepare_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare parameters for fitting.</p>
<p>Prepares and initializes model and Parameters for subsequent
fitting. This routine prepares the conversion of <code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>
into fit variables, organizes parameter bounds, and parses, “compiles”
and checks constrain expressions.   The method also creates and returns
a new instance of a <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a> object that contains the
copy of the Parameters that will actually be varied in the fit.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Contains the Parameters for the model; if None, then the
Parameters used to initialize the Minimizer object are used.</p>
</dd>
</dl>
<p><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></p>
<p>This method is called directly by the fitting methods, and it is
generally not necessary to call this function explicitly.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.scalar_minimize">
<code class="sig-name descname"><span class="pre">scalar_minimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Nelder-Mead'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.scalar_minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Scalar minimization using <a href="#id41"><span class="problematic" id="id42">:scipydoc:`optimize.minimize`</span></a>.</p>
<p>Perform fit with any of the scalar minimization algorithms supported by
<a href="#id43"><span class="problematic" id="id44">:scipydoc:`optimize.minimize`</span></a>. Default argument values are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 18%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><a class="reference internal" href="#gsf.minimizer.Minimizer.scalar_minimize" title="gsf.minimizer.Minimizer.scalar_minimize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">scalar_minimize()</span></code></a>
arg</p></th>
<th class="head"><p>Default Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>method</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Nelder-Mead</span></code></p></td>
<td><p>fitting method</p></td>
</tr>
<tr class="row-odd"><td><p>tol</p></td>
<td><p>1.e-7</p></td>
<td><p>fitting and parameter tolerance</p></td>
</tr>
<tr class="row-even"><td><p>hess</p></td>
<td><p>None</p></td>
<td><p>Hessian of objective function</p></td>
</tr>
</tbody>
</table>
<dl>
<dt>method<span class="classifier">str, optional</span></dt><dd><p>Name of the fitting method to use. One of:</p>
<ul class="simple">
<li><p>‘Nelder-Mead’ (default)</p></li>
<li><p>‘L-BFGS-B’</p></li>
<li><p>‘Powell’</p></li>
<li><p>‘CG’</p></li>
<li><p>‘Newton-CG’</p></li>
<li><p>‘COBYLA’</p></li>
<li><p>‘BFGS’</p></li>
<li><p>‘TNC’</p></li>
<li><p>‘trust-ncg’</p></li>
<li><p>‘trust-exact’</p></li>
<li><p>‘trust-krylov’</p></li>
<li><p>‘trust-constr’</p></li>
<li><p>‘dogleg’</p></li>
<li><p>‘SLSQP’</p></li>
<li><p>‘differential_evolution’</p></li>
</ul>
</dd>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Parameters to use as starting point.</p>
</dd>
<dt><a href="#id45"><span class="problematic" id="id46">**</span></a>kws<span class="classifier">dict, optional</span></dt><dd><p>Minimizer options pass to <a href="#id47"><span class="problematic" id="id48">:scipydoc:`optimize.minimize`</span></a>.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the optimized parameter and several
goodness-of-fit statistics.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
<p>If the objective function returns a NumPy array instead
of the expected scalar, the sum of squares of the array
will be used.</p>
<p>Note that bounds and constraints can be set on Parameters
for any of these methods, so are not supported separately
for those designed to use bounds. However, if you use the
differential_evolution method you must specify finite
(min, max) for each varying Parameter.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.shgo">
<code class="sig-name descname"><span class="pre">shgo</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.shgo" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the <cite>SHGO</cite> algorithm to find the global minimum.</p>
<p>SHGO stands for “simplicial homology global optimization” and calls
<a href="#id49"><span class="problematic" id="id50">:scipydoc:`optimize.shgo`</span></a> using its default arguments.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</p>
</dd>
<dt><a href="#id51"><span class="problematic" id="id52">**</span></a>kws<span class="classifier">dict, optional</span></dt><dd><p>Minimizer options to pass to the SHGO algorithm.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the parameters from the SHGO method.
The return values specific to <a href="#id53"><span class="problematic" id="id54">:scipydoc:`optimize.shgo`</span></a> (<cite>x</cite>,
<cite>xl</cite>, <cite>fun</cite>, <cite>funl</cite>, <cite>nfev</cite>, <cite>nit</cite>, <cite>nlfev</cite>, <cite>nlhev</cite>, and
<cite>nljev</cite>) are stored as <cite>shgo_&lt;parname&gt;</cite> attributes.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.14.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.unprepare_fit">
<code class="sig-name descname"><span class="pre">unprepare_fit</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.unprepare_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean fit state, so that subsequent fits need to call prepare_fit().</p>
<p>removes AST compilations of constraint expressions.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.Minimizer.values">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">values</span></code><a class="headerlink" href="#gsf.minimizer.Minimizer.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Parameter values in a simple dictionary.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="gsf.minimizer.MinimizerException">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></code><code class="sig-name descname"><span class="pre">MinimizerException</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.MinimizerException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>General Purpose Exception.</p>
</dd></dl>

<dl class="py class">
<dt id="gsf.minimizer.MinimizerResult">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></code><code class="sig-name descname"><span class="pre">MinimizerResult</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.MinimizerResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The results of a minimization.</p>
<p>Minimization results include data such as status and error messages,
fit statistics, and the updated (i.e., best-fit) parameters themselves
in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">params</span></code> attribute.</p>
<p>The list of (possible) <cite>MinimizerResult</cite> attributes is given below:</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></span></dt><dd><p>The best-fit parameters resulting from the fit.</p>
</dd>
<dt>status<span class="classifier">int</span></dt><dd><p>Termination status of the optimizer. Its value depends on the
underlying solver. Refer to <cite>message</cite> for details.</p>
</dd>
<dt>var_names<span class="classifier">list</span></dt><dd><p>Ordered list of variable parameter names used in optimization, and
useful for understanding the values in <code class="xref py py-attr docutils literal notranslate"><span class="pre">init_vals</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">covar</span></code>.</p>
</dd>
<dt>covar<span class="classifier">numpy.ndarray</span></dt><dd><p>Covariance matrix from minimization, with rows and columns
corresponding to <code class="xref py py-attr docutils literal notranslate"><span class="pre">var_names</span></code>.</p>
</dd>
<dt>init_vals<span class="classifier">list</span></dt><dd><p>List of initial values for variable parameters using <code class="xref py py-attr docutils literal notranslate"><span class="pre">var_names</span></code>.</p>
</dd>
<dt>init_values<span class="classifier">dict</span></dt><dd><p>Dictionary of initial values for variable parameters.</p>
</dd>
<dt>nfev<span class="classifier">int</span></dt><dd><p>Number of function evaluations.</p>
</dd>
<dt>success<span class="classifier">bool</span></dt><dd><p>True if the fit succeeded, otherwise False.</p>
</dd>
<dt>errorbars<span class="classifier">bool</span></dt><dd><p>True if uncertainties were estimated, otherwise False.</p>
</dd>
<dt>message<span class="classifier">str</span></dt><dd><p>Message about fit success.</p>
</dd>
<dt>ier<span class="classifier">int</span></dt><dd><p>Integer error value from <a href="#id55"><span class="problematic" id="id56">:scipydoc:`optimize.leastsq`</span></a> (<cite>leastsq</cite> only).</p>
</dd>
<dt>lmdif_message<span class="classifier">str</span></dt><dd><p>Message from <a href="#id57"><span class="problematic" id="id58">:scipydoc:`optimize.leastsq`</span></a> (<cite>leastsq</cite> only).</p>
</dd>
<dt>nvarys<span class="classifier">int</span></dt><dd><p>Number of variables in fit: <span class="math notranslate nohighlight">\(N_{\rm varys}\)</span>.</p>
</dd>
<dt>ndata<span class="classifier">int</span></dt><dd><p>Number of data points: <span class="math notranslate nohighlight">\(N\)</span>.</p>
</dd>
<dt>nfree<span class="classifier">int</span></dt><dd><p>Degrees of freedom in fit: <span class="math notranslate nohighlight">\(N - N_{\rm varys}\)</span>.</p>
</dd>
<dt>residual<span class="classifier">numpy.ndarray</span></dt><dd><p>Residual array <span class="math notranslate nohighlight">\({\rm Resid_i}\)</span>. Return value of the objective
function when using the best-fit values of the parameters.</p>
</dd>
<dt>chisqr<span class="classifier">float</span></dt><dd><p>Chi-square: <span class="math notranslate nohighlight">\(\chi^2 = \sum_i^N [{\rm Resid}_i]^2\)</span>.</p>
</dd>
<dt>redchi<span class="classifier">float</span></dt><dd><p>Reduced chi-square:
<span class="math notranslate nohighlight">\(\chi^2_{\nu}= {\chi^2} / {(N - N_{\rm varys})}\)</span>.</p>
</dd>
<dt>aic<span class="classifier">float</span></dt><dd><p>Akaike Information Criterion statistic:
<span class="math notranslate nohighlight">\(N \ln(\chi^2/N) + 2 N_{\rm varys}\)</span>.</p>
</dd>
<dt>bic<span class="classifier">float</span></dt><dd><p>Bayesian Information Criterion statistic:
<span class="math notranslate nohighlight">\(N \ln(\chi^2/N) + \ln(N) N_{\rm varys}\)</span>.</p>
</dd>
<dt>flatchain<span class="classifier">pandas.DataFrame</span></dt><dd><p>A flatchain view of the sampling chain from the <cite>emcee</cite> method.</p>
</dd>
</dl>
<dl class="simple">
<dt>show_candidates</dt><dd><p>Pretty_print() representation of candidates from the <cite>brute</cite> method.</p>
</dd>
</dl>
<dl class="py method">
<dt id="gsf.minimizer.MinimizerResult.flatchain">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">flatchain</span></code><a class="headerlink" href="#gsf.minimizer.MinimizerResult.flatchain" title="Permalink to this definition">¶</a></dt>
<dd><p>Show flatchain view of the sampling chain from <cite>emcee</cite> method.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.minimizer.MinimizerResult.show_candidates">
<code class="sig-name descname"><span class="pre">show_candidates</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidate_nmb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.MinimizerResult.show_candidates" title="Permalink to this definition">¶</a></dt>
<dd><p>Show pretty_print() representation of candidates from <cite>brute</cite> method.</p>
<p>Showing all stored candidates (default) or the specified candidate-#
from the <cite>brute</cite> method.</p>
<dl class="simple">
<dt>candidate_nmb<span class="classifier">int or ‘all’</span></dt><dd><p>The candidate-number to show using the <code class="xref py py-meth docutils literal notranslate"><span class="pre">pretty_print()</span></code> method.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="gsf.minimizer.asteval_with_uncertainties">
<code class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></code><code class="sig-name descname"><span class="pre">asteval_with_uncertainties</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.asteval_with_uncertainties" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate object value, given values for variables.</p>
<p>This is used by the uncertainties package to calculate the
uncertainty in an object even with a complicated expression.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.minimizer.eval_stderr">
<code class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></code><code class="sig-name descname"><span class="pre">eval_stderr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.eval_stderr" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate uncertainty and set .stderr for a parameter <cite>obj</cite>.</p>
<p>Given the uncertain values <cite>uvars</cite> (a list of uncertainties.ufloats), a
list of parameter names that matches uvars, and a dict of param objects,
keyed by name.</p>
<p>This uses the uncertainties package wrapped function to evaluate the
uncertainty for an arbitrary expression (in obj._expr_ast) of parameters.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.minimizer.minimize">
<code class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></code><code class="sig-name descname"><span class="pre">minimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'leastsq'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_cb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_fcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">fit_kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a fit of a set of parameters by minimizing an objective (or
cost) function using one of the several available methods.</p>
<p>The minimize function takes an objective function to be minimized,
a dictionary (<code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>) containing the model
parameters, and several optional arguments.</p>
<dl>
<dt>fcn<span class="classifier">callable</span></dt><dd><p>Objective function to be minimized. When method is <cite>leastsq</cite> or
<cite>least_squares</cite>, the objective function should return an array
of residuals (difference between model and data) to be minimized
in a least-squares sense. With the scalar methods the objective
function can either return the residuals array or a single scalar
value. The function must have the signature:
<cite>fcn(params, *args, **kws)</cite></p>
</dd>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></span></dt><dd><p>Contains the Parameters for the model.</p>
</dd>
<dt>method<span class="classifier">str, optional</span></dt><dd><p>Name of the fitting method to use. Valid values are:</p>
<ul class="simple">
<li><p><cite>‘leastsq’</cite>: Levenberg-Marquardt (default)</p></li>
<li><p><cite>‘least_squares’</cite>: Least-Squares minimization, using Trust Region Reflective method</p></li>
<li><p><cite>‘differential_evolution’</cite>: differential evolution</p></li>
<li><p><cite>‘brute’</cite>: brute force method</p></li>
<li><p><cite>‘basinhopping’</cite>: basinhopping</p></li>
<li><p><cite>‘ampgo’</cite>: Adaptive Memory Programming for Global Optimization</p></li>
<li><p>‘<cite>nelder</cite>’: Nelder-Mead</p></li>
<li><p><cite>‘lbfgsb’</cite>: L-BFGS-B</p></li>
<li><p><cite>‘powell’</cite>: Powell</p></li>
<li><p><cite>‘cg’</cite>: Conjugate-Gradient</p></li>
<li><p><cite>‘newton’</cite>: Newton-CG</p></li>
<li><p><cite>‘cobyla’</cite>: Cobyla</p></li>
<li><p><cite>‘bfgs’</cite>: BFGS</p></li>
<li><p><cite>‘tnc’</cite>: Truncated Newton</p></li>
<li><p><cite>‘trust-ncg’</cite>: Newton-CG trust-region</p></li>
<li><p><cite>‘trust-exact’</cite>: nearly exact trust-region</p></li>
<li><p><cite>‘trust-krylov’</cite>: Newton GLTR trust-region</p></li>
<li><p><cite>‘trust-constr’</cite>: trust-region for constrained optimization</p></li>
<li><p><cite>‘dogleg’</cite>: Dog-leg trust-region</p></li>
<li><p><cite>‘slsqp’</cite>: Sequential Linear Squares Programming</p></li>
<li><p><cite>‘emcee’</cite>: Maximum likelihood via Monte-Carlo Markov Chain</p></li>
<li><p><cite>‘shgo’</cite>: Simplicial Homology Global Optimization</p></li>
<li><p><cite>‘dual_annealing’</cite>: Dual Annealing optimization</p></li>
</ul>
<p>In most cases, these methods wrap and use the method of the same
name from <cite>scipy.optimize</cite>, or use <cite>scipy.optimize.minimize</cite> with
the same <cite>method</cite> argument.  Thus ‘<cite>leastsq</cite>’ will use
<cite>scipy.optimize.leastsq</cite>, while ‘<cite>powell</cite>’ will use
<cite>scipy.optimize.minimizer(…, method=’powell’)</cite></p>
<p>For more details on the fitting methods please refer to the
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html">SciPy docs</a>.</p>
</dd>
<dt>args<span class="classifier">tuple, optional</span></dt><dd><p>Positional arguments to pass to <cite>fcn</cite>.</p>
</dd>
<dt>kws<span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments to pass to <cite>fcn</cite>.</p>
</dd>
<dt>iter_cb<span class="classifier">callable, optional</span></dt><dd><p>Function to be called at each fit iteration. This function should
have the signature <cite>iter_cb(params, iter, resid, *args, **kws)</cite>,
where <cite>params</cite> will have the current parameter values, <cite>iter</cite>
the iteration number, <cite>resid</cite> the current residual array, and <cite>*args</cite>
and <cite>**kws</cite> as passed to the objective function.</p>
</dd>
<dt>scale_covar<span class="classifier">bool, optional</span></dt><dd><p>Whether to automatically scale the covariance matrix (default is True).</p>
</dd>
<dt>nan_policy<span class="classifier">str, optional</span></dt><dd><p>Specifies action if <cite>userfcn</cite> (or a Jacobian) returns NaN
values. One of:</p>
<ul class="simple">
<li><p>‘raise’ : a <cite>ValueError</cite> is raised</p></li>
<li><p>‘propagate’ : the values returned from <cite>userfcn</cite> are un-altered</p></li>
<li><p>‘omit’ : non-finite values are filtered</p></li>
</ul>
</dd>
<dt>reduce_fcn<span class="classifier">str or callable, optional</span></dt><dd><p>Function to convert a residual array to a scalar value for the scalar
minimizers. See notes in <cite>Minimizer</cite>.</p>
</dd>
<dt>calc_covar<span class="classifier">bool, optional</span></dt><dd><p>Whether to calculate the covariance matrix (default is True) for
solvers other than <cite>leastsq</cite> and <cite>least_squares</cite>. Requires the
<cite>numdifftools</cite> package to be installed.</p>
</dd>
<dt><a href="#id59"><span class="problematic" id="id60">**</span></a>fit_kws<span class="classifier">dict, optional</span></dt><dd><p>Options to pass to the minimizer being used.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the optimized parameter and several
goodness-of-fit statistics.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
<p>The objective function should return the value to be minimized. For the
Levenberg-Marquardt algorithm from leastsq(), this returned value must
be an array, with a length greater than or equal to the number of
fitting variables in the model. For the other methods, the return value
can either be a scalar or an array. If an array is returned, the sum of
squares of the array will be sent to the underlying fitting method,
effectively doing a least-squares optimization of the return values.</p>
<p>A common use for <cite>args</cite> and <cite>kws</cite> would be to pass in other
data needed to calculate the residual, including such things as the
data array, dependent variable, uncertainties in the data, and other
data structures for the model calculation.</p>
<p>On output, <cite>params</cite> will be unchanged.  The best-fit values and, where
appropriate, estimated uncertainties and correlations, will all be
contained in the returned <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.  See
<span class="xref std std-ref">fit-results-label</span> for further details.</p>
<p>This function is simply a wrapper around <a class="reference internal" href="#gsf.minimizer.Minimizer" title="gsf.minimizer.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a>
and is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fitter</span> <span class="o">=</span> <span class="n">Minimizer</span><span class="p">(</span><span class="n">fcn</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">fcn_args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">fcn_kws</span><span class="o">=</span><span class="n">kws</span><span class="p">,</span>
                   <span class="n">iter_cb</span><span class="o">=</span><span class="n">iter_cb</span><span class="p">,</span> <span class="n">scale_covar</span><span class="o">=</span><span class="n">scale_covar</span><span class="p">,</span>
                   <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span> <span class="n">reduce_fcn</span><span class="o">=</span><span class="n">reduce_fcn</span><span class="p">,</span>
                   <span class="n">calc_covar</span><span class="o">=</span><span class="n">calc_covar</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_kws</span><span class="p">)</span>
<span class="n">fitter</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="gsf.minimizer.reduce_cauchylogpdf">
<code class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></code><code class="sig-name descname"><span class="pre">reduce_cauchylogpdf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.reduce_cauchylogpdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce residual array to scalar (cauchylogpdf).</p>
<p>Reduce residual array <cite>r</cite> to scalar using negative log-likelihood and a
Cauchy (Lorentzian) distribution of <cite>r</cite>:</p>
<blockquote>
<div><p>-scipy.stats.cauchy.logpdf(r)</p>
</div></blockquote>
<p>(where the Cauchy pdf = 1/(pi*(1+r*r))). This gives greater
suppression of outliers compared to normal sum-of-squares.</p>
<dl class="simple">
<dt>r<span class="classifier">numpy.ndarray</span></dt><dd><p>Residual array.</p>
</dd>
</dl>
<dl class="simple">
<dt>float</dt><dd><p>Negative entropy value calculated from the residual array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.minimizer.reduce_chisquare">
<code class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></code><code class="sig-name descname"><span class="pre">reduce_chisquare</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.reduce_chisquare" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce residual array to scalar (chi-square).</p>
<p>Calculate the chi-square value from the residual array <cite>r</cite>: (r*r).sum()</p>
<dl class="simple">
<dt>r<span class="classifier">numpy.ndarray</span></dt><dd><p>Residual array.</p>
</dd>
</dl>
<dl class="simple">
<dt>float</dt><dd><p>Chi-square calculated from the residual array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gsf.minimizer.reduce_negentropy">
<code class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></code><code class="sig-name descname"><span class="pre">reduce_negentropy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.reduce_negentropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce residual array to scalar (negentropy).</p>
<p>Reduce residual array <cite>r</cite> to scalar using negative entropy and the normal
(Gaussian) probability distribution of <cite>r</cite> as pdf:</p>
<blockquote>
<div><p>(norm.pdf(r)*norm.logpdf(r)).sum()</p>
</div></blockquote>
<dl class="simple">
<dt>since pdf(r) = exp(-r*r/2)/sqrt(2*pi), this is</dt><dd><p>((r*r/2 - log(sqrt(2*pi))) * exp(-r*r/2)).sum()</p>
</dd>
</dl>
<dl class="simple">
<dt>r<span class="classifier">numpy.ndarray</span></dt><dd><p>Residual array.</p>
</dd>
</dl>
<dl class="simple">
<dt>float</dt><dd><p>Negative entropy value calculated from the residual array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="gsf-plot-mz-module">
<h2>gsf.plot_MZ module<a class="headerlink" href="#gsf-plot-mz-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-gsf.plot_sed_logA">
<span id="gsf-plot-sed-loga-module"></span><h2>gsf.plot_sed_logA module<a class="headerlink" href="#module-gsf.plot_sed_logA" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="gsf.plot_sed_logA.plot_corner_TZ">
<code class="sig-prename descclassname"><span class="pre">gsf.plot_sed_logA.</span></code><code class="sig-name descname"><span class="pre">plot_corner_TZ</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">1.2,</span> <span class="pre">-</span> <span class="pre">1.15,</span> <span class="pre">-</span> <span class="pre">1.1,</span> <span class="pre">-</span> <span class="pre">1.05,</span> <span class="pre">-</span> <span class="pre">1.0,</span> <span class="pre">-</span> <span class="pre">0.95,</span> <span class="pre">-</span> <span class="pre">0.9,</span> <span class="pre">-</span> <span class="pre">0.85,</span> <span class="pre">-</span> <span class="pre">0.8,</span> <span class="pre">-</span> <span class="pre">0.75,</span> <span class="pre">-</span> <span class="pre">0.7,</span> <span class="pre">-</span> <span class="pre">0.65,</span> <span class="pre">-</span> <span class="pre">0.6,</span> <span class="pre">-</span> <span class="pre">0.55,</span> <span class="pre">-</span> <span class="pre">0.5,</span> <span class="pre">-</span> <span class="pre">0.45,</span> <span class="pre">-</span> <span class="pre">0.4,</span> <span class="pre">-</span> <span class="pre">0.35,</span> <span class="pre">-</span> <span class="pre">0.3,</span> <span class="pre">-</span> <span class="pre">0.25,</span> <span class="pre">-</span> <span class="pre">0.2,</span> <span class="pre">-</span> <span class="pre">0.15,</span> <span class="pre">-</span> <span class="pre">0.1,</span> <span class="pre">-</span> <span class="pre">0.05,</span> <span class="pre">1.11022302e-15,</span> <span class="pre">0.05,</span> <span class="pre">0.1,</span> <span class="pre">0.15,</span> <span class="pre">0.2,</span> <span class="pre">0.25,</span> <span class="pre">0.3,</span> <span class="pre">0.35,</span> <span class="pre">0.4])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.01,</span> <span class="pre">0.1,</span> <span class="pre">0.3,</span> <span class="pre">0.7,</span> <span class="pre">1.0,</span> <span class="pre">3.0]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.plot_sed_logA.plot_corner_TZ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gsf.plot_sed_logA.plot_corner_physparam_cum_frame">
<code class="sig-prename descclassname"><span class="pre">gsf.plot_sed_logA.</span></code><code class="sig-name descname"><span class="pre">plot_corner_physparam_cum_frame</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">1.2,</span> <span class="pre">-</span> <span class="pre">1.15,</span> <span class="pre">-</span> <span class="pre">1.1,</span> <span class="pre">-</span> <span class="pre">1.05,</span> <span class="pre">-</span> <span class="pre">1.0,</span> <span class="pre">-</span> <span class="pre">0.95,</span> <span class="pre">-</span> <span class="pre">0.9,</span> <span class="pre">-</span> <span class="pre">0.85,</span> <span class="pre">-</span> <span class="pre">0.8,</span> <span class="pre">-</span> <span class="pre">0.75,</span> <span class="pre">-</span> <span class="pre">0.7,</span> <span class="pre">-</span> <span class="pre">0.65,</span> <span class="pre">-</span> <span class="pre">0.6,</span> <span class="pre">-</span> <span class="pre">0.55,</span> <span class="pre">-</span> <span class="pre">0.5,</span> <span class="pre">-</span> <span class="pre">0.45,</span> <span class="pre">-</span> <span class="pre">0.4,</span> <span class="pre">-</span> <span class="pre">0.35,</span> <span class="pre">-</span> <span class="pre">0.3,</span> <span class="pre">-</span> <span class="pre">0.25,</span> <span class="pre">-</span> <span class="pre">0.2,</span> <span class="pre">-</span> <span class="pre">0.15,</span> <span class="pre">-</span> <span class="pre">0.1,</span> <span class="pre">-</span> <span class="pre">0.05,</span> <span class="pre">1.11022302e-15,</span> <span class="pre">0.05,</span> <span class="pre">0.1,</span> <span class="pre">0.15,</span> <span class="pre">0.2,</span> <span class="pre">0.25,</span> <span class="pre">0.3,</span> <span class="pre">0.35,</span> <span class="pre">0.4])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.01,</span> <span class="pre">0.1,</span> <span class="pre">0.3,</span> <span class="pre">0.7,</span> <span class="pre">1.0,</span> <span class="pre">3.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.1,</span> <span class="pre">0.2,</span> <span class="pre">0.3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snlimbb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_OUT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.plot_sed_logA.plot_corner_physparam_cum_frame" title="Permalink to this definition">¶</a></dt>
<dd><p># Creat “cumulative” png for gif image.
#
#
# If you like to
# Creat temporal png for gif image.
#
# snlimbb: SN limit to show flux or up lim in SED.
#</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.plot_sed_logA.plot_corner_physparam_frame">
<code class="sig-prename descclassname"><span class="pre">gsf.plot_sed_logA.</span></code><code class="sig-name descname"><span class="pre">plot_corner_physparam_frame</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">1.2,</span> <span class="pre">-</span> <span class="pre">1.15,</span> <span class="pre">-</span> <span class="pre">1.1,</span> <span class="pre">-</span> <span class="pre">1.05,</span> <span class="pre">-</span> <span class="pre">1.0,</span> <span class="pre">-</span> <span class="pre">0.95,</span> <span class="pre">-</span> <span class="pre">0.9,</span> <span class="pre">-</span> <span class="pre">0.85,</span> <span class="pre">-</span> <span class="pre">0.8,</span> <span class="pre">-</span> <span class="pre">0.75,</span> <span class="pre">-</span> <span class="pre">0.7,</span> <span class="pre">-</span> <span class="pre">0.65,</span> <span class="pre">-</span> <span class="pre">0.6,</span> <span class="pre">-</span> <span class="pre">0.55,</span> <span class="pre">-</span> <span class="pre">0.5,</span> <span class="pre">-</span> <span class="pre">0.45,</span> <span class="pre">-</span> <span class="pre">0.4,</span> <span class="pre">-</span> <span class="pre">0.35,</span> <span class="pre">-</span> <span class="pre">0.3,</span> <span class="pre">-</span> <span class="pre">0.25,</span> <span class="pre">-</span> <span class="pre">0.2,</span> <span class="pre">-</span> <span class="pre">0.15,</span> <span class="pre">-</span> <span class="pre">0.1,</span> <span class="pre">-</span> <span class="pre">0.05,</span> <span class="pre">1.11022302e-15,</span> <span class="pre">0.05,</span> <span class="pre">0.1,</span> <span class="pre">0.15,</span> <span class="pre">0.2,</span> <span class="pre">0.25,</span> <span class="pre">0.3,</span> <span class="pre">0.35,</span> <span class="pre">0.4])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.01,</span> <span class="pre">0.1,</span> <span class="pre">0.3,</span> <span class="pre">0.7,</span> <span class="pre">1.0,</span> <span class="pre">3.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.1,</span> <span class="pre">0.2,</span> <span class="pre">0.3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.plot_sed_logA.plot_corner_physparam_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>#
# If you like to
# Creat temporal png for gif image.
#</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.plot_sed_logA.plot_corner_physparam_summary">
<code class="sig-prename descclassname"><span class="pre">gsf.plot_sed_logA.</span></code><code class="sig-name descname"><span class="pre">plot_corner_physparam_summary</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_OUT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TMIN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.plot_sed_logA.plot_corner_physparam_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>For summary. In the same format as plot_corner_physparam_frame.</p>
<p>Tau model not supported.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.plot_sed_logA.plot_sed">
<code class="sig-prename descclassname"><span class="pre">gsf.plot_sed_logA.</span></code><code class="sig-name descname"><span class="pre">plot_sed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fil_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-19</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_chind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figpdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_sed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_TMP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./templates/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_bbbox</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_silence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fancyplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.plot_sed_logA.plot_sed" title="Permalink to this definition">¶</a></dt>
<dd><p>MB.SNlim : SN limit to show flux or up lim in SED.
f_chind : If include non-detection in chi2 calculation, using Sawicki12.
mmax : Number of mcmc realization for plot. Not for calculation.
f_fancy: plot each SED component.
f_fill: if True, and so is f_fancy, fill each SED component.</p>
<p>plots</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.plot_sed_logA.plot_sed_tau">
<code class="sig-prename descclassname"><span class="pre">gsf.plot_sed_logA.</span></code><code class="sig-name descname"><span class="pre">plot_sed_tau</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fil_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-19</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_chind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figpdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_sed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_TMP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./templates/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_bbbox</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_silence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fancyplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.plot_sed_logA.plot_sed_tau" title="Permalink to this definition">¶</a></dt>
<dd><p>MB.SNlim : SN limit to show flux or up lim in SED.
f_chind : If include non-detection in chi2 calculation, using Sawicki12.
mmax : Number of mcmc realization for plot. Not for calculation.
f_fancy: plot each SED component.
f_fill: if True, and so is f_fancy, fill each SED component.</p>
<p>plots</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.plot_sed_logA.write_lines">
<code class="sig-prename descclassname"><span class="pre">gsf.plot_sed_logA.</span></code><code class="sig-name descname"><span class="pre">write_lines</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zbes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_grs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_OUT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.plot_sed_logA.write_lines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-gsf.plot_sfh_logA">
<span id="gsf-plot-sfh-loga-module"></span><h2>gsf.plot_sfh_logA module<a class="headerlink" href="#module-gsf.plot_sfh_logA" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="gsf.plot_sfh_logA.get_evolv">
<code class="sig-prename descclassname"><span class="pre">gsf.plot_sfh_logA.</span></code><code class="sig-name descname"><span class="pre">get_evolv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">1.2,</span> <span class="pre">-</span> <span class="pre">1.15,</span> <span class="pre">-</span> <span class="pre">1.1,</span> <span class="pre">-</span> <span class="pre">1.05,</span> <span class="pre">-</span> <span class="pre">1.0,</span> <span class="pre">-</span> <span class="pre">0.95,</span> <span class="pre">-</span> <span class="pre">0.9,</span> <span class="pre">-</span> <span class="pre">0.85,</span> <span class="pre">-</span> <span class="pre">0.8,</span> <span class="pre">-</span> <span class="pre">0.75,</span> <span class="pre">-</span> <span class="pre">0.7,</span> <span class="pre">-</span> <span class="pre">0.65,</span> <span class="pre">-</span> <span class="pre">0.6,</span> <span class="pre">-</span> <span class="pre">0.55,</span> <span class="pre">-</span> <span class="pre">0.5,</span> <span class="pre">-</span> <span class="pre">0.45,</span> <span class="pre">-</span> <span class="pre">0.4,</span> <span class="pre">-</span> <span class="pre">0.35,</span> <span class="pre">-</span> <span class="pre">0.3,</span> <span class="pre">-</span> <span class="pre">0.25,</span> <span class="pre">-</span> <span class="pre">0.2,</span> <span class="pre">-</span> <span class="pre">0.15,</span> <span class="pre">-</span> <span class="pre">0.1,</span> <span class="pre">-</span> <span class="pre">0.05,</span> <span class="pre">1.11022302e-15,</span> <span class="pre">0.05,</span> <span class="pre">0.1,</span> <span class="pre">0.15,</span> <span class="pre">0.2,</span> <span class="pre">0.25,</span> <span class="pre">0.3,</span> <span class="pre">0.35,</span> <span class="pre">0.4])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.01,</span> <span class="pre">0.1,</span> <span class="pre">0.3,</span> <span class="pre">0.7,</span> <span class="pre">1.0,</span> <span class="pre">3.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fil_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./FILT/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_TMP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./templates/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delt_sfh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.plot_sfh_logA.get_evolv" title="Permalink to this definition">¶</a></dt>
<dd><p>Reprocess output files to get spectra, UV color, and SFH at higher resolution.</p>
<p>#
# delt_sfh (float): delta t of input SFH in Gyr.
#
# Returns: SED as function of age, based on SF and Z histories;
#</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.plot_sfh_logA.plot_evolv">
<code class="sig-prename descclassname"><span class="pre">gsf.plot_sfh_logA.</span></code><code class="sig-name descname"><span class="pre">plot_evolv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">1.2,</span> <span class="pre">-</span> <span class="pre">1.15,</span> <span class="pre">-</span> <span class="pre">1.1,</span> <span class="pre">-</span> <span class="pre">1.05,</span> <span class="pre">-</span> <span class="pre">1.0,</span> <span class="pre">-</span> <span class="pre">0.95,</span> <span class="pre">-</span> <span class="pre">0.9,</span> <span class="pre">-</span> <span class="pre">0.85,</span> <span class="pre">-</span> <span class="pre">0.8,</span> <span class="pre">-</span> <span class="pre">0.75,</span> <span class="pre">-</span> <span class="pre">0.7,</span> <span class="pre">-</span> <span class="pre">0.65,</span> <span class="pre">-</span> <span class="pre">0.6,</span> <span class="pre">-</span> <span class="pre">0.55,</span> <span class="pre">-</span> <span class="pre">0.5,</span> <span class="pre">-</span> <span class="pre">0.45,</span> <span class="pre">-</span> <span class="pre">0.4,</span> <span class="pre">-</span> <span class="pre">0.35,</span> <span class="pre">-</span> <span class="pre">0.3,</span> <span class="pre">-</span> <span class="pre">0.25,</span> <span class="pre">-</span> <span class="pre">0.2,</span> <span class="pre">-</span> <span class="pre">0.15,</span> <span class="pre">-</span> <span class="pre">0.1,</span> <span class="pre">-</span> <span class="pre">0.05,</span> <span class="pre">1.11022302e-15,</span> <span class="pre">0.05,</span> <span class="pre">0.1,</span> <span class="pre">0.15,</span> <span class="pre">0.2,</span> <span class="pre">0.25,</span> <span class="pre">0.3,</span> <span class="pre">0.35,</span> <span class="pre">0.4])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.01,</span> <span class="pre">0.1,</span> <span class="pre">0.3,</span> <span class="pre">0.7,</span> <span class="pre">1.0,</span> <span class="pre">3.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fil_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./FILT/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_TMP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./templates/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delt_sfh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.plot_sfh_logA.plot_evolv" title="Permalink to this definition">¶</a></dt>
<dd><p>delt_sfh (float): delta t of input SFH in Gyr.</p>
<p>SED as function of age, based on SF and Z histories;</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.plot_sfh_logA.plot_sfh">
<code class="sig-prename descclassname"><span class="pre">gsf.plot_sfh_logA.</span></code><code class="sig-name descname"><span class="pre">plot_sfh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsfrl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Txmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Txmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fil_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./FILT/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_TMP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./templates/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_SFMS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_silence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_log_sfh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TMIN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_zhist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tset_SFR_SED</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.plot_sfh_logA.plot_sfh" title="Permalink to this definition">¶</a></dt>
<dd><p>Star formation history plot.</p>
<p>flim : Lower limit for plotting an age bin.
lsfrl : Lower limit for SFR, in logMsun/yr
f_SFMS : If true, plot SFR of the main sequence of a ginen stellar mass at each lookback time.
tset_SFR_SED : in Gyr. Time scale over which SFR estimate is averaged.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.plot_sfh_logA.plot_sfh_tau">
<code class="sig-prename descclassname"><span class="pre">gsf.plot_sfh_logA.</span></code><code class="sig-name descname"><span class="pre">plot_sfh_tau</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsfrl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Txmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Txmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fil_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./FILT/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_TMP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./templates/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_SFMS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_silence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_log_sfh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TMIN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_zhist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tset_SFR_SED</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.plot_sfh_logA.plot_sfh_tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Star formation history plot.</p>
<p>flim : Lower limit for plotting an age bin.
lsfrl : Lower limit for SFR, in logMsun/yr
f_SFMS : If true, plot SFR of the main sequence of a ginen stellar mass at each lookback time.
tset_SFR_SED : in Gyr. Time scale over which SFR estimate is averaged.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.plot_sfh_logA.sfr_tau">
<code class="sig-prename descclassname"><span class="pre">gsf.plot_sfh_logA.</span></code><code class="sig-name descname"><span class="pre">sfr_tau</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.0,</span> <span class="pre">0.1,</span> <span class="pre">0.2,</span> <span class="pre">0.3,</span> <span class="pre">0.4,</span> <span class="pre">0.5,</span> <span class="pre">0.6,</span> <span class="pre">0.7,</span> <span class="pre">0.8,</span> <span class="pre">0.9,</span> <span class="pre">1.0,</span> <span class="pre">1.1,</span> <span class="pre">1.2,</span> <span class="pre">1.3,</span> <span class="pre">1.4,</span> <span class="pre">1.5,</span> <span class="pre">1.6,</span> <span class="pre">1.7,</span> <span class="pre">1.8,</span> <span class="pre">1.9,</span> <span class="pre">2.0,</span> <span class="pre">2.1,</span> <span class="pre">2.2,</span> <span class="pre">2.3,</span> <span class="pre">2.4,</span> <span class="pre">2.5,</span> <span class="pre">2.6,</span> <span class="pre">2.7,</span> <span class="pre">2.8,</span> <span class="pre">2.9,</span> <span class="pre">3.0,</span> <span class="pre">3.1,</span> <span class="pre">3.2,</span> <span class="pre">3.3,</span> <span class="pre">3.4,</span> <span class="pre">3.5,</span> <span class="pre">3.6,</span> <span class="pre">3.7,</span> <span class="pre">3.8,</span> <span class="pre">3.9,</span> <span class="pre">4.0,</span> <span class="pre">4.1,</span> <span class="pre">4.2,</span> <span class="pre">4.3,</span> <span class="pre">4.4,</span> <span class="pre">4.5,</span> <span class="pre">4.6,</span> <span class="pre">4.7,</span> <span class="pre">4.8,</span> <span class="pre">4.9,</span> <span class="pre">5.0,</span> <span class="pre">5.1,</span> <span class="pre">5.2,</span> <span class="pre">5.3,</span> <span class="pre">5.4,</span> <span class="pre">5.5,</span> <span class="pre">5.6,</span> <span class="pre">5.7,</span> <span class="pre">5.8,</span> <span class="pre">5.9,</span> <span class="pre">6.0,</span> <span class="pre">6.1,</span> <span class="pre">6.2,</span> <span class="pre">6.3,</span> <span class="pre">6.4,</span> <span class="pre">6.5,</span> <span class="pre">6.6,</span> <span class="pre">6.7,</span> <span class="pre">6.8,</span> <span class="pre">6.9,</span> <span class="pre">7.0,</span> <span class="pre">7.1,</span> <span class="pre">7.2,</span> <span class="pre">7.3,</span> <span class="pre">7.4,</span> <span class="pre">7.5,</span> <span class="pre">7.6,</span> <span class="pre">7.7,</span> <span class="pre">7.8,</span> <span class="pre">7.9,</span> <span class="pre">8.0,</span> <span class="pre">8.1,</span> <span class="pre">8.2,</span> <span class="pre">8.3,</span> <span class="pre">8.4,</span> <span class="pre">8.5,</span> <span class="pre">8.6,</span> <span class="pre">8.7,</span> <span class="pre">8.8,</span> <span class="pre">8.9,</span> <span class="pre">9.0,</span> <span class="pre">9.1,</span> <span class="pre">9.2,</span> <span class="pre">9.3,</span> <span class="pre">9.4,</span> <span class="pre">9.5,</span> <span class="pre">9.6,</span> <span class="pre">9.7,</span> <span class="pre">9.8,</span> <span class="pre">9.9,</span> <span class="pre">10.0,</span> <span class="pre">10.1,</span> <span class="pre">10.2,</span> <span class="pre">10.3,</span> <span class="pre">10.4,</span> <span class="pre">10.5,</span> <span class="pre">10.6,</span> <span class="pre">10.7,</span> <span class="pre">10.8,</span> <span class="pre">10.9,</span> <span class="pre">11.0,</span> <span class="pre">11.1,</span> <span class="pre">11.2,</span> <span class="pre">11.3,</span> <span class="pre">11.4,</span> <span class="pre">11.5,</span> <span class="pre">11.6,</span> <span class="pre">11.7,</span> <span class="pre">11.8,</span> <span class="pre">11.9,</span> <span class="pre">12.0,</span> <span class="pre">12.1,</span> <span class="pre">12.2,</span> <span class="pre">12.3,</span> <span class="pre">12.4,</span> <span class="pre">12.5,</span> <span class="pre">12.6,</span> <span class="pre">12.7,</span> <span class="pre">12.8,</span> <span class="pre">12.9])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mtot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.plot_sfh_logA.sfr_tau" title="Permalink to this definition">¶</a></dt>
<dd><p># sfh: 1:exponential, 4:delayed exp, 5:, 6:lognormal
ML : Total Mass.
tt: Lookback time, in Gyr
tau0: in Gyr
t0: age, in Gyr</p>
<p>Returns:
SFR, in Msun/yr
MFR, in Msun</p>
</dd></dl>

</div>
<div class="section" id="module-gsf.posterior_flexible">
<span id="gsf-posterior-flexible-module"></span><h2>gsf.posterior_flexible module<a class="headerlink" href="#module-gsf.posterior_flexible" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="gsf.posterior_flexible.Post">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gsf.posterior_flexible.</span></code><code class="sig-name descname"><span class="pre">Post</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mainbody</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="gsf.posterior_flexible.Post.func_tmp">
<code class="sig-name descname"><span class="pre">func_tmp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.func_tmp" title="Permalink to this definition">¶</a></dt>
<dd><p>A function used for chi2 calculation for non-detection in lnprob.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.posterior_flexible.Post.lnprob">
<code class="sig-name descname"><span class="pre">lnprob</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_chind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lnpreject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_like</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gauss_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>f_chind (bool) : If true, includes non-detection in likelihood calculation.
lnpreject : A replaced value when lnprob gets -inf value.
flat_prior : Assumes flat prior for Mdyn. Used only when MB.f_Mdyn==True.
gauss_prior : Assumes gaussian prior for Mdyn. Used only when MB.f_Mdyn==True.</p>
<p>dammy : This is a dammy parameter, to make use of EMCEE, while keeping pars a dictionary obtained by lmfit.</p>
<p>If f_like, log Likelihood. Else, log Posterior prob.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.posterior_flexible.Post.lnprob_emcee">
<code class="sig-name descname"><span class="pre">lnprob_emcee</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dammy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_chind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lnpreject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_like</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gauss_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.lnprob_emcee" title="Permalink to this definition">¶</a></dt>
<dd><p>f_chind (bool) : If true, includes non-detection in likelihood calculation.
lnpreject : A replaced value when lnprob gets -inf value.
flat_prior : Assumes flat prior for Mdyn. Used only when MB.f_Mdyn==True.
gauss_prior : Assumes gaussian prior for Mdyn. Used only when MB.f_Mdyn==True.</p>
<p>dammy : This is a dammy parameter, to make use of EMCEE, while keeping pars a dictionary obtained by lmfit.</p>
<p>If f_like, log Likelihood. Else, log Posterior prob.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.posterior_flexible.Post.prior_transform">
<code class="sig-name descname"><span class="pre">prior_transform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.prior_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>A function defining the tranform between the parameterisation in the unit hypercube
to the true parameters.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>theta (tuple): a tuple containing the parameters.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: a new tuple or array with the transformed parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gsf.posterior_flexible.Post.residual">
<code class="sig-name descname"><span class="pre">residual</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>out   : model as second output. For lnprob func.
f_fir : Bool. If dust component is on or off.</p>
<p>residual of model and data.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.posterior_flexible.Post.swap_pars">
<code class="sig-name descname"><span class="pre">swap_pars</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.swap_pars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="gsf.posterior_flexible.Post.swap_pars_inv">
<code class="sig-name descname"><span class="pre">swap_pars_inv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.swap_pars_inv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gsf.posterior_nested">
<span id="gsf-posterior-nested-module"></span><h2>gsf.posterior_nested module<a class="headerlink" href="#module-gsf.posterior_nested" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="gsf.posterior_nested.Post_nested">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gsf.posterior_nested.</span></code><code class="sig-name descname"><span class="pre">Post_nested</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mainbody</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="gsf.posterior_nested.Post_nested.func_tmp">
<code class="sig-name descname"><span class="pre">func_tmp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.func_tmp" title="Permalink to this definition">¶</a></dt>
<dd><p>A function used for chi2 calculation for non-detection in lnprob.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.posterior_nested.Post_nested.get_dict">
<code class="sig-name descname"><span class="pre">get_dict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.get_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="gsf.posterior_nested.Post_nested.lnlike">
<code class="sig-name descname"><span class="pre">lnlike</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_chind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lnpreject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.lnlike" title="Permalink to this definition">¶</a></dt>
<dd><p>log likelihood</p>
<p>This is a copy from lnprob, with respr=0.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.posterior_nested.Post_nested.lnprob">
<code class="sig-name descname"><span class="pre">lnprob</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_chind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lnpreject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>log posterior</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.posterior_nested.Post_nested.prior_transform">
<code class="sig-name descname"><span class="pre">prior_transform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.prior_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>A function defining the tranform between the parameterisation in the unit hypercube
to the true parameters.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>theta (tuple): a tuple containing the parameters.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: a new tuple or array with the transformed parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gsf.posterior_nested.Post_nested.residual">
<code class="sig-name descname"><span class="pre">residual</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.residual" title="Permalink to this definition">¶</a></dt>
<dd><p>out   : model as second output. For lnprob func.
f_fir : Bool. If dust component is on or off.</p>
<p>residual of model and data.</p>
</dd></dl>

<dl class="py method">
<dt id="gsf.posterior_nested.Post_nested.residual_nest">
<code class="sig-name descname"><span class="pre">residual_nest</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.residual_nest" title="Permalink to this definition">¶</a></dt>
<dd><p>out   : model as second output. For lnprob func.
f_fir : Bool. If dust component is on or off.</p>
<p>residual of model and data.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gsf.version">
<span id="gsf-version-module"></span><h2>gsf.version module<a class="headerlink" href="#module-gsf.version" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-gsf.writing">
<span id="gsf-writing-module"></span><h2>gsf.writing module<a class="headerlink" href="#module-gsf.writing" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="gsf.writing.get_index">
<code class="sig-prename descclassname"><span class="pre">gsf.writing.</span></code><code class="sig-name descname"><span class="pre">get_index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.writing.get_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve spectral indices from each realization.</p>
</dd></dl>

<dl class="py function">
<dt id="gsf.writing.get_param">
<code class="sig-prename descclassname"><span class="pre">gsf.writing.</span></code><code class="sig-name descname"><span class="pre">get_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tcalc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.writing.get_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a parameter file.</p>
</dd></dl>

</div>
<div class="section" id="module-gsf.zfit">
<span id="gsf-zfit-module"></span><h2>gsf.zfit module<a class="headerlink" href="#module-gsf.zfit" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="gsf.zfit.check_redshift">
<code class="sig-prename descclassname"><span class="pre">gsf.zfit.</span></code><code class="sig-name descname"><span class="pre">check_redshift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zbest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zprior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zliml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlimu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmc_cz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalk_cz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_line_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_vary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.zfit.check_redshift" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit observed flux with a template to get redshift probability.</p>
<p>zbest : Initial value for redshift.
zprior : Redshift grid for prior.
prior : Prior for redshift determination. E.g., Eazy z-probability.
zliml : Lowest redshift for fitting range.
zlimu : Highest redshift for fitting range.
f_vary: Bool. If want to fix redshift.</p>
<p>fm_tmp, xm_tmp : Template spectrum at RF.
fobs, eobs, xobs: Observed spectrum. (Already scaled with Cz0prev.)</p>
<p>res_cz  :
fitc_cz :</p>
</dd></dl>

</div>
<div class="section" id="module-gsf">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-gsf" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="modules.html" class="btn btn-neutral float-left" title="gsf" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Takahiro Morishita.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>