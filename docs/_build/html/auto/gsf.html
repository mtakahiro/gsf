<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>gsf package &mdash; gsf 1.4 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="gsf" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> gsf
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing gsf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parameters.html">Paramter Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates.html">Generating templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fitting.html">Fitting process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output.html">Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prior.html">Prior</a></li>
<li class="toctree-l1"><a class="reference internal" href="../redshift_fitting.html">Redshift Fitting</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">gsf</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">gsf package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.basic_func">gsf.basic_func module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.fitting">gsf.fitting module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.function">gsf.function module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.function_class">gsf.function_class module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.function_igm">gsf.function_igm module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.gsf">gsf.gsf module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.maketmp_filt">gsf.maketmp_filt module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.maketmp_z0">gsf.maketmp_z0 module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.maketmp_z0_tau">gsf.maketmp_z0_tau module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.minimizer">gsf.minimizer module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gsf-plot-mz-module">gsf.plot_MZ module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gsf-plot-sed-loga-module">gsf.plot_sed_logA module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gsf-plot-sfh-loga-module">gsf.plot_sfh_logA module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.posterior_flexible">gsf.posterior_flexible module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.posterior_nested">gsf.posterior_nested module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gsf-version-module">gsf.version module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.writing">gsf.writing module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf.zfit">gsf.zfit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gsf">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gsf</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">gsf</a> &raquo;</li>
      <li>gsf package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto/gsf.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gsf-package">
<h1>gsf package<a class="headerlink" href="#gsf-package" title="Permalink to this headline"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-gsf.basic_func">
<span id="gsf-basic-func-module"></span><h2>gsf.basic_func module<a class="headerlink" href="#module-gsf.basic_func" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="gsf.basic_func.Basic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gsf.basic_func.</span></span><span class="sig-name descname"><span class="pre">Basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.basic_func.Basic" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="gsf.basic_func.Basic.Z2NZ">
<span class="sig-name descname"><span class="pre">Z2NZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.basic_func.Basic.Z2NZ" title="Permalink to this definition"></a></dt>
<dd><p>Critical function to infer NZ from Z.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gsf.basic_func.Basic_tau">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gsf.basic_func.</span></span><span class="sig-name descname"><span class="pre">Basic_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.basic_func.Basic_tau" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="gsf.basic_func.Basic_tau.Z2NZ">
<span class="sig-name descname"><span class="pre">Z2NZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.basic_func.Basic_tau.Z2NZ" title="Permalink to this definition"></a></dt>
<dd><p>Critical function to infer NZ from Z.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-gsf.fitting">
<span id="gsf-fitting-module"></span><h2>gsf.fitting module<a class="headerlink" href="#module-gsf.fitting" title="Permalink to this headline"></a></h2>
<p>This includes the main part of gsf.</p>
<dl class="simple">
<dt>Original copyright:</dt><dd><p>Copyright (c) 2021 Takahiro Morishita, STScI</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="gsf.fitting.Mainbody">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gsf.fitting.</span></span><span class="sig-name descname"><span class="pre">Mainbody</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3e+18</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mpc_cm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.08568025e+24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0set</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelscale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lsun</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.839e+33</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NRbb_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The list of (possible) <cite>Mainbody</cite> attributes is given below:</p>
<dl class="simple">
<dt>nimf<span class="classifier">int </span></dt><dd><p>0:Salpeter, 1:Chabrier, 2:Kroupa, 3:vanDokkum08.</p>
</dd>
<dt>Z<span class="classifier">float array</span></dt><dd><p>Stellar phase metallicity in logZsun.</p>
</dd>
<dt>age<span class="classifier">float array</span></dt><dd><p>Age, in Gyr.</p>
</dd>
<dt>fneb<span class="classifier">int</span></dt><dd><p>flag for adding nebular emission. 0: No, 1: Yes.</p>
</dd>
<dt>tau0<span class="classifier">float array</span></dt><dd><p>Width of age bin. If you want to fix it to a specific value, set it to &gt;0.01, in Gyr.
Otherwise, it would be either minimum value (=0.01; if one age bin), 
or the width to the next age bin.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gsf.fitting.Mainbody.add_param">
<span class="sig-name descname"><span class="pre">add_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.add_param" title="Permalink to this definition"></a></dt>
<dd><p>Add new parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.fitting.Mainbody.fit_redshift">
<span class="sig-name descname"><span class="pre">fit_redshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delzz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ezmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zliml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlimu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_bb_zfit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_line_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_lambda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_bb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_exclude_negative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.fit_redshift" title="Permalink to this definition"></a></dt>
<dd><p>Find the best-fit redshift, before going into a big fit, through an interactive inspection.
This module is effective only when spec data is provided.
When spectrun is provided, this does redshift fit, but <strong>by using the SED model guessed from the BB photometry</strong>.
Thus, providing good BB photometry is critical in this step.</p>
<dl class="simple">
<dt>xm_tmp, fm_tmp<span class="classifier">float array</span></dt><dd><p>SED model.</p>
</dd>
<dt>delzz<span class="classifier">float</span></dt><dd><p>Delta z in redshift search space</p>
</dd>
<dt>zliml<span class="classifier">float</span></dt><dd><p>Lower limit range for redshift</p>
</dd>
<dt>zlimu<span class="classifier">float</span></dt><dd><p>Upper limit range for redshift</p>
</dd>
<dt>ezmin<span class="classifier">float</span></dt><dd><p>Minimum redshift uncertainty.</p>
</dd>
<dt>snlim<span class="classifier">float</span></dt><dd><p>SN limit for data points. Those below the number will be cut from the fit.</p>
</dd>
<dt>include_bb<span class="classifier">bool</span></dt><dd><p>Turn this True if Redshift fitting is requred for only BB data.</p>
</dd>
<dt>f_line_check<span class="classifier">bool</span></dt><dd><p>If True, line masking.</p>
</dd>
<dt>priors<span class="classifier">dict, optional</span></dt><dd><p>Dictionary that contains z (redshift grid) and chi2 (chi-square).</p>
</dd>
<dt>f_exclude_negative<span class="classifier">bool</span></dt><dd><p>Exclude negative fluxes in spectrum.</p>
</dd>
</dl>
<p>Spectral data must be provided to make this work.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.fitting.Mainbody.get_lines">
<span class="sig-name descname"><span class="pre">get_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">LW0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.get_lines" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.fitting.Mainbody.get_shuffle">
<span class="sig-name descname"><span class="pre">get_shuffle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nshuf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.get_shuffle" title="Permalink to this definition"></a></dt>
<dd><p>Shuffles initial parameters of each walker, to give it extra randomeness.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.fitting.Mainbody.get_zdist">
<span class="sig-name descname"><span class="pre">get_zdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_interact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.get_zdist" title="Permalink to this definition"></a></dt>
<dd><p>Saves a plot of z-distribution.</p>
<dl class="simple">
<dt>f_interact<span class="classifier">bool</span></dt><dd><p>If true, this module returns figure ax.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.fitting.Mainbody.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cornerplot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ezmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ferr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_fitz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_plot_accept</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_shuffle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_converge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zini</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_plot_chain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_chind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_prior_sfh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norder_sfh_prior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_bb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.main" title="Permalink to this definition"></a></dt>
<dd><p>Main module of this script.</p>
<dl class="simple">
<dt>ferr<span class="classifier">float</span></dt><dd><p>Used for error parameter.</p>
</dd>
<dt>skip_fitz<span class="classifier">bool </span></dt><dd><p>Skip redshift fit.</p>
</dd>
<dt>sigz<span class="classifier">float </span></dt><dd><p>Confidence interval for redshift fit (i.e. n-sigma).</p>
</dd>
<dt>ezmin<span class="classifier">float </span></dt><dd><p>minimum error in redshift</p>
</dd>
<dt>f_plot_accept<span class="classifier">bool</span></dt><dd><p>Output acceptance plot of mcmc chains.</p>
</dd>
<dt>f_shuffle<span class="classifier">bool</span></dt><dd><p>Randomly shuffle some of initial parameters in walkers.</p>
</dd>
<dt>check_converge<span class="classifier">bool</span></dt><dd><p>Check convergence at every certain number.</p>
</dd>
<dt>f_plot_chain<span class="classifier">book</span></dt><dd><p>Plot MC sample chain.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.fitting.Mainbody.prepare_class">
<span class="sig-name descname"><span class="pre">prepare_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_fir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.prepare_class" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.fitting.Mainbody.read_data">
<span class="sig-name descname"><span class="pre">read_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Cz0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cz1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cz2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_fir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.read_data" title="Permalink to this definition"></a></dt>
<dd><p>Read in observed data. Not model fluxes.</p>
<dl class="simple">
<dt>Cz0, Cz1<span class="classifier">float</span></dt><dd><p>Normalization coefficients for grism spectra. Cz0 for G102, Cz1 for G141.</p>
</dd>
<dt>zgal<span class="classifier">float</span></dt><dd><p>Current redshift estimate.</p>
</dd>
</dl>
<p>Dictionary.</p>
<p>This modeule can be used for any SFHs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.fitting.Mainbody.search_redshift">
<span class="sig-name descname"><span class="pre">search_redshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zliml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlimu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delzz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'powell'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.search_redshift" title="Permalink to this definition"></a></dt>
<dd><p>This module explores the redshift space to find the best redshift and probability distribution.</p>
<dl class="simple">
<dt>dict<span class="classifier">dictionary</span></dt><dd><p>Dictionary that includes input data.</p>
</dd>
<dt>xm_tmp<span class="classifier">numpy.array</span></dt><dd><p>Wavelength array, common for fm_tmp below, at z=0. Should be in [len(wavelength)].</p>
</dd>
<dt>fm_tmp<span class="classifier">numpy.array</span></dt><dd><p>Fluxes for various templates. Should be in a shape of [ n * len(wavelength)], 
where n is the number templates.</p>
</dd>
<dt>zliml<span class="classifier">float</span></dt><dd><p>Lowest redshift for fitting range.</p>
</dd>
<dt>zlimu<span class="classifier">float</span></dt><dd><p>Highest redshift for fitting range.</p>
</dd>
<dt>prior<span class="classifier">numpy.array</span></dt><dd><p>Prior used for the redshift determination. E.g., Eazy z-probability.</p>
</dd>
<dt>method<span class="classifier">str</span></dt><dd><p>Method for minimization. The option must be taken from lmfit. Powell is more accurate. Nelder is faster.</p>
</dd>
</dl>
<dl class="simple">
<dt>zspace<span class="classifier">numpy.array </span></dt><dd><p>Array for redshift grid.</p>
</dd>
<dt>chi2s<span class="classifier">numpy.array</span></dt><dd><p>Array of chi2 values corresponding to zspace.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.fitting.Mainbody.set_param">
<span class="sig-name descname"><span class="pre">set_param</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.set_param" title="Permalink to this definition"></a></dt>
<dd><p>Set parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.fitting.Mainbody.update_input">
<span class="sig-name descname"><span class="pre">update_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3e+18</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mpc_cm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.08568025e+24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0set</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelscale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lsun</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.839e+33</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.fitting.Mainbody.update_input" title="Permalink to this definition"></a></dt>
<dd><p>The purpose of this module is to register/update the parameter attributes in <cite>Mainbody</cite>
by visiting the configuration file.</p>
<dl class="simple">
<dt>inputs<span class="classifier">str</span></dt><dd><p>Configuration file that lists parameters.</p>
</dd>
<dt>Mpc_cm<span class="classifier">float, optional</span></dt><dd><p>Conversion factor from Mpc-to-cm</p>
</dd>
<dt>pixelscale<span class="classifier">float, optional</span></dt><dd><p>Conversion factor from pixel-to-arcsec</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-gsf.function">
<span id="gsf-function-module"></span><h2>gsf.function module<a class="headerlink" href="#module-gsf.function" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.SFH_cons">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">SFH_cons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsfr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.SFH_cons" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.SFH_dec">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">SFH_dec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsfr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.SFH_dec" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.SFH_del">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">SFH_del</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsfr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.SFH_del" title="Permalink to this definition"></a></dt>
<dd><p>SFH</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.apply_dust">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">apply_dust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.apply_dust" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>xx<span class="classifier">float array</span></dt><dd><p>RF Wavelength</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.calc_Dn4">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">calc_Dn4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.calc_Dn4" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.check_line">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">check_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.check_line" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.check_line_cz">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">check_line_cz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xcont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.check_line_cz" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.check_line_cz_man">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">check_line_cz_man</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xcont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2800,</span> <span class="pre">3347,</span> <span class="pre">3727,</span> <span class="pre">3799,</span> <span class="pre">3836,</span> <span class="pre">3869,</span> <span class="pre">4102,</span> <span class="pre">4341,</span> <span class="pre">4861,</span> <span class="pre">4960,</span> <span class="pre">5008,</span> <span class="pre">5175,</span> <span class="pre">6563,</span> <span class="pre">6717,</span> <span class="pre">6731]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.check_line_cz_man" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>LW<span class="classifier"></span></dt><dd><p>List for emission lines to be masked.</p>
</dd>
</dl>
<dl class="simple">
<dt>wht<span class="classifier"></span></dt><dd><p>Processed weight, where wavelength at line exists is masked.</p>
</dd>
<dt>ypoly<span class="classifier"></span></dt><dd><p>Fitted continuum flux.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.check_line_man">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">check_line_man</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xcont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2800,</span> <span class="pre">3347,</span> <span class="pre">3727,</span> <span class="pre">3799,</span> <span class="pre">3836,</span> <span class="pre">3869,</span> <span class="pre">4102,</span> <span class="pre">4341,</span> <span class="pre">4861,</span> <span class="pre">4960,</span> <span class="pre">5008,</span> <span class="pre">5175,</span> <span class="pre">6563,</span> <span class="pre">6717,</span> <span class="pre">6731]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.check_line_man" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>lsig<span class="classifier">float</span></dt><dd><p>which sigma to detect lines.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.check_rejuv">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">check_rejuv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SFMS_50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm_old</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delMS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.check_rejuv" title="Permalink to this definition"></a></dt>
<dd><p>A Function to check rejuvenation.</p>
<dl class="simple">
<dt>delMS<span class="classifier">float</span></dt><dd><p>Scatter around the Main Sequence. 0.2 dex, in default.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.data_int">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">data_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmtmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftmp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.data_int" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>lmobs<span class="classifier"></span></dt><dd><p>Observed wavelength.</p>
</dd>
<dt>lmtmp, ftmp: </dt><dd><p>Those to be interpolated.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.delta">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.delta" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.detect_line">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">detect_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xcont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.detect_line" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.detect_line_man">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">detect_line_man</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xcont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wycont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.detect_line_man" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.dust_calz">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">dust_calz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmlimu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.115</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.dust_calz" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>lm<span class="classifier">float array</span></dt><dd><p>wavelength, at RF.</p>
</dd>
<dt>fl<span class="classifier">float array</span></dt><dd><p>fnu</p>
</dd>
<dt>Av<span class="classifier">float</span></dt><dd><p>in mag</p>
</dd>
<dt>nr<span class="classifier">int array</span></dt><dd><p>index, to be used for sorting.</p>
</dd>
<dt>Rv<span class="classifier">float</span></dt><dd><p>from Calzetti+00</p>
</dd>
<dt>lmlimu<span class="classifier">float</span></dt><dd><p>Upper limit. 2.2 in Calz+00</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.dust_gen">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">dust_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmlimu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.115</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.dust_gen" title="Permalink to this definition"></a></dt>
<dd><p>For general purpose (Noll+09).
This function is much better than previous, but is hard to impliment for the current version.
A difference from dust_gen is Eb is defined as a function of gamma.</p>
<dl class="simple">
<dt>lm<span class="classifier">float array</span></dt><dd><p>wavelength, at RF.</p>
</dd>
<dt>fl<span class="classifier">float array</span></dt><dd><p>fnu</p>
</dd>
<dt>Av<span class="classifier">float</span></dt><dd><p>in mag</p>
</dd>
<dt>nr<span class="classifier">int array</span></dt><dd><p>index, to be used for sorting.</p>
</dd>
<dt>Rv<span class="classifier"></span></dt><dd><p>from Calzetti+00</p>
</dd>
<dt>gamma :</dt><dd><p>gamma.</p>
</dd>
<dt>Eb:</dt><dd><p>Eb</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.dust_kc">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">dust_kc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmlimu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.115</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.dust_kc" title="Permalink to this definition"></a></dt>
<dd><p>Dust model by Kriek&amp;Conroy13</p>
<dl class="simple">
<dt>lm<span class="classifier">float array</span></dt><dd><p>RF Wavelength.</p>
</dd>
<dt>fl<span class="classifier">float array</span></dt><dd><p>in fnu</p>
</dd>
<dt>Av<span class="classifier">float</span></dt><dd><p>in mag</p>
</dd>
<dt>nr<span class="classifier">int array</span></dt><dd><p>index, to be used for sorting.</p>
</dd>
<dt>Rv<span class="classifier">float</span></dt><dd><p>from Calzetti+00</p>
</dd>
<dt>gamma<span class="classifier">float</span></dt><dd><p>See Eq.1</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.dust_mw">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">dust_mw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.dust_mw" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>lm<span class="classifier">float array</span></dt><dd><p>wavelength, at RF, in AA.</p>
</dd>
<dt>fl<span class="classifier">float array</span></dt><dd><p>fnu</p>
</dd>
<dt>Av<span class="classifier">float</span></dt><dd><p>mag</p>
</dd>
<dt>nr<span class="classifier">int array</span></dt><dd><p>index, to be used for sorting.</p>
</dd>
<dt>Rv<span class="classifier">float</span></dt><dd><p>3.1 for MW.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.fil_fwhm">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">fil_fwhm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.fil_fwhm" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>f0 :</dt><dd><p>in fnu</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.filconv">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">filconv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_regist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MB</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.filconv" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>f0<span class="classifier">float array</span></dt><dd><p>Flux for spectrum, in fnu</p>
</dd>
<dt>l0<span class="classifier">float array</span></dt><dd><p>Wavelength for spectrum, in AA (that matches filter response curve’s.)</p>
</dd>
<dt>f_regist<span class="classifier">bool</span></dt><dd><p>If True, read filter response curves and register those to MB.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.filconv_cen">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">filconv_cen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'FILT/'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.filconv_cen" title="Permalink to this definition"></a></dt>
<dd><p>Convolution of templates with filter response curves.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.filconv_fast">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">filconv_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.filconv_fast" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>filts, band<span class="classifier"></span></dt><dd><p>From MB.filts and MB.band, respectively.</p>
</dd>
<dt>f0: </dt><dd><p>Flux for spectrum, in fnu</p>
</dd>
<dt>l0: </dt><dd><p>Wavelength for spectrum, in AA (that matches filter response curve’s.)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.fit_spec">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">fit_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftmp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.fit_spec" title="Permalink to this definition"></a></dt>
<dd><p>Fitting. (Not sure)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.fit_specphot">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">fit_specphot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fbb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltmp_bb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftmp_bb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.fit_specphot" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.flamtonu">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">flamtonu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.flamtonu" title="Permalink to this definition"></a></dt>
<dd><p>Converts from Flam to Fnu, with mag zeropoint of m0set.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.fnutolam">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">fnutolam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">48.6</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.fnutolam" title="Permalink to this definition"></a></dt>
<dd><p>Converts from Fnu to Flam, from mag zeropoint of m0set (to -48.6).</p>
<dl class="simple">
<dt>m0set<span class="classifier">float</span></dt><dd><p>current magzp.</p>
</dd>
<dt>m0<span class="classifier">float</span></dt><dd><p>target magzp. The default, -48.6, is for flam (erg/s/cm2/lambda).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.fnutonu">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">fnutonu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fnu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">48.6</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.fnutonu" title="Permalink to this definition"></a></dt>
<dd><p>Converts from Fnu (cgs) to Fnu (m0=m0set)</p>
<dl class="simple">
<dt>fnu<span class="classifier">float array</span></dt><dd><p>flux in cgs, with magnitude zero point of m0input.</p>
</dd>
<dt>m0set<span class="classifier">float</span></dt><dd><p>Target mag zero point.</p>
</dd>
<dt>m0input<span class="classifier">float</span></dt><dd><p>Original value for magzp. If erg/s/cm2/Hz, -48.6.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.func_tmp">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">func_tmp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.func_tmp" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.gaus">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">gaus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.gaus" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.gauss">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">gauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.gauss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.get_Fint">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">get_Fint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmtmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_Fint" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>lmtmp<span class="classifier"></span></dt><dd><p>Rest frame wave (AA)</p>
</dd>
<dt>ftmp :</dt><dd><p>Fnu ()</p>
</dd>
</dl>
<p>integrated flux.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.get_Fuv">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">get_Fuv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmtmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_Fuv" title="Permalink to this definition"></a></dt>
<dd><p>Get RF UV (or any wavelength) flux density.</p>
<dl class="simple">
<dt>lmtmp<span class="classifier"></span></dt><dd><p>Rest-frame wavelength, in AA.</p>
</dd>
<dt>ftmp<span class="classifier"></span></dt><dd><p>Fnu</p>
</dd>
</dl>
<p>Flux density estimated over lmin:lmax. Not integrated sum.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.get_SFMS">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">get_SFMS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">red</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IMF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_SFMS" title="Permalink to this definition"></a></dt>
<dd><p>Gets SFMS at age ago from z=red.</p>
<dl class="simple">
<dt>red<span class="classifier">float</span></dt><dd><p>Observed redshift</p>
</dd>
<dt>age<span class="classifier">array</span></dt><dd><p>lookback time, in Gyr.</p>
</dd>
<dt>mass<span class="classifier">array</span></dt><dd><p>stellar mass (array) at each age, in Msun (not logM).</p>
</dd>
</dl>
<p>SFR, in logMsun/yr.</p>
<p>From Speagle+14 Eq28.
Chabrier IMF, in default</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.get_chi2">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">get_chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ysump</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim_eff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_chind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xbb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_ex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_chi2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.get_fit">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">get_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsfh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Del.'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.get_ind">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">get_ind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_ind" title="Permalink to this definition"></a></dt>
<dd><p>Gets Lick index for input</p>
<p>equivalent width</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.get_input">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">get_input</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_input" title="Permalink to this definition"></a></dt>
<dd><p>Gets a default dictionary for input params.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.get_leastsq">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">get_leastsq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ZZtmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fneld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chidef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zbest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_only_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_leastsq" title="Permalink to this definition"></a></dt>
<dd><p>Get initial parameters at various Z</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.get_uvbeta">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">get_uvbeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zbes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam_blue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1650</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam_red</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2300</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.get_uvbeta" title="Permalink to this definition"></a></dt>
<dd><p>get UV beta_lambda slope.</p>
<dl class="simple">
<dt>lm<span class="classifier">float array</span></dt><dd><p>in lambda</p>
</dd>
<dt>flam<span class="classifier">float array</span></dt><dd><p>in flambda</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.loadcpkl">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">loadcpkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpklfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.loadcpkl" title="Permalink to this definition"></a></dt>
<dd><p>Load cpkl files.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.moffat">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">moffat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.moffat" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.printProgressBar">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">printProgressBar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'█'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">printEnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emojis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.printProgressBar" title="Permalink to this definition"></a></dt>
<dd><p>Call in a loop to create terminal progress bar.</p>
<dl class="simple">
<dt>iteration<span class="classifier">int </span></dt><dd><p>current iteration</p>
</dd>
<dt>total<span class="classifier">int </span></dt><dd><p>total iterations</p>
</dd>
<dt>prefix<span class="classifier">str</span></dt><dd><p>prefix string</p>
</dd>
<dt>suffix<span class="classifier">str</span></dt><dd><p>suffix string</p>
</dd>
<dt>decimals<span class="classifier">int</span></dt><dd><p>positive number of decimals in percent complete</p>
</dd>
<dt>length<span class="classifier">int</span></dt><dd><p>character length of bar</p>
</dd>
<dt>fill<span class="classifier">str</span></dt><dd><p>bar fill character</p>
</dd>
<dt>printEnd<span class="classifier">str </span></dt><dd><p>end character</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.read_input">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">read_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.read_input" title="Permalink to this definition"></a></dt>
<dd><p>Gets info from param file.</p>
<p>Input dictionary.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.savecpkl">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">savecpkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpklfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.savecpkl" title="Permalink to this definition"></a></dt>
<dd><p>Save data into cpklfile.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.str2bool">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">str2bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.str2bool" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function.write_input">
<span class="sig-prename descclassname"><span class="pre">gsf.function.</span></span><span class="sig-name descname"><span class="pre">write_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gsf.input'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function.write_input" title="Permalink to this definition"></a></dt>
<dd><p>Gets an ascii format param file.</p>
<p>file_out</p>
</dd></dl>

</section>
<section id="module-gsf.function_class">
<span id="gsf-function-class-module"></span><h2>gsf.function_class module<a class="headerlink" href="#module-gsf.function_class" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="gsf.function_class.Func">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gsf.function_class.</span></span><span class="sig-name descname"><span class="pre">Func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The list of (possible) <cite>Func</cite> attributes is given below:</p>
<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func.get_template">
<span class="sig-name descname"><span class="pre">get_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alog</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nprec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib_all</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_nrd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_apply_dust</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_IGM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaz_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_neb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EBVratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.27</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.get_template" title="Permalink to this definition"></a></dt>
<dd><p>Makes model template for a given parameter set, <code class="docutils literal notranslate"><span class="pre">par</span></code>.</p>
<dl class="simple">
<dt>nprec<span class="classifier">int</span></dt><dd><p>Precision when redshift is refined.</p>
</dd>
<dt>f_apply_dust<span class="classifier">bool</span></dt><dd><p>Apply dust attenuation to nebular emission.</p>
</dd>
<dt>EBVratio<span class="classifier">float</span></dt><dd><p>E(B-V)_neb / E(B-V)_st. 
Useful table in <a class="reference external" href="https://iopscience.iop.org/article/10.3847/1538-4357/aba35e/pdf">https://iopscience.iop.org/article/10.3847/1538-4357/aba35e/pdf</a></p>
</dd>
<dt>f_neb<span class="classifier">bool</span></dt><dd><p>Expect to explore nebular template or not.</p>
</dd>
</dl>
<p>This function is only used in plot_sed.py.
Common function for mebular and nonnebular temlates.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func.get_template_single">
<span class="sig-name descname"><span class="pre">get_template_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Av</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zgal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_apply_dust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EBVratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.27</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.get_template_single" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>EBVratio<span class="classifier">float</span></dt><dd><p>E(B-V)_neb / E(B-V)_st. 
Useful table in <a class="reference external" href="https://iopscience.iop.org/article/10.3847/1538-4357/aba35e/pdf">https://iopscience.iop.org/article/10.3847/1538-4357/aba35e/pdf</a></p>
</dd>
</dl>
<p>This function is only used in plot_sed.py.
Common function for mebular and nonnebular temlates.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func.get_total_flux">
<span class="sig-name descname"><span class="pre">get_total_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_get_Mtot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_check_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.get_total_flux" title="Permalink to this definition"></a></dt>
<dd><p>get total flux for a given set of parameter.</p>
<dl class="simple">
<dt>par<span class="classifier">library</span></dt><dd><p>contains parameters. Needs to include: [‘Z’,’A’]</p>
</dd>
</dl>
<dl class="simple">
<dt>nr, xx, yy<span class="classifier">float arrays</span></dt><dd><p>xx is OBSERVED wavelength at z=MB.zgal</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func.get_total_flux_neb">
<span class="sig-name descname"><span class="pre">get_total_flux_neb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.get_total_flux_neb" title="Permalink to this definition"></a></dt>
<dd><p>get total flux for a given set of parameter.</p>
<dl class="simple">
<dt>par<span class="classifier">library</span></dt><dd><p>contains parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func.open_spec_dust_fits">
<span class="sig-name descname"><span class="pre">open_spec_dust_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fall</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.open_spec_dust_fits" title="Permalink to this definition"></a></dt>
<dd><p>Loads dust template in obs range.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func.open_spec_fits">
<span class="sig-name descname"><span class="pre">open_spec_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fall</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_neb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.open_spec_fits" title="Permalink to this definition"></a></dt>
<dd><p>Load template in obs range.</p>
<dl>
<dt>fall<span class="classifier">int</span></dt><dd><p>If 1, returns full spectra.</p>
</dd>
<dt>orig<span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, returns the original spectra.</p>
</dd>
</dl>
<p>lib : float array</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func.tmp04_dust">
<span class="sig-name descname"><span class="pre">tmp04_dust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func.tmp04_dust" title="Permalink to this definition"></a></dt>
<dd><p>Makes model template with a given param setself.
Also dust attenuation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gsf.function_class.Func_tau">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gsf.function_class.</span></span><span class="sig-name descname"><span class="pre">Func_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func_tau.get_template">
<span class="sig-name descname"><span class="pre">get_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_nrd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_apply_dust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_neb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaz_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau.get_template" title="Permalink to this definition"></a></dt>
<dd><p>Makes model template with a given param set.
Also dust attenuation.</p>
<dl class="simple">
<dt>nprec<span class="classifier">int</span></dt><dd><p>Precision when redshift is refined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func_tau.get_total_flux">
<span class="sig-name descname"><span class="pre">get_total_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_get_Mtot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_check_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau.get_total_flux" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func_tau.get_total_flux_neb">
<span class="sig-name descname"><span class="pre">get_total_flux_neb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_get_Mtot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_check_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau.get_total_flux_neb" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func_tau.open_spec_dust_fits">
<span class="sig-name descname"><span class="pre">open_spec_dust_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fall</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau.open_spec_dust_fits" title="Permalink to this definition"></a></dt>
<dd><p>Load dust template in obs range.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func_tau.open_spec_fits">
<span class="sig-name descname"><span class="pre">open_spec_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_neb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau.open_spec_fits" title="Permalink to this definition"></a></dt>
<dd><p>Loads template in obs range.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.function_class.Func_tau.tmp04_dust">
<span class="sig-name descname"><span class="pre">tmp04_dust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_class.Func_tau.tmp04_dust" title="Permalink to this definition"></a></dt>
<dd><p>Makes model template with a given param setself.
Also dust attenuation.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-gsf.function_igm">
<span id="gsf-function-igm-module"></span><h2>gsf.function_igm module<a class="headerlink" href="#module-gsf.function_igm" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gsf.function_igm.dijkstra_igm_abs">
<span class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></span><span class="sig-name descname"><span class="pre">dijkstra_igm_abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xtmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xLL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1216.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ckms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_v_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.dijkstra_igm_abs" title="Permalink to this definition"></a></dt>
<dd><p>Apply IMG-attenuation of Dijikstra (2014).
<a class="reference external" href="https://www.cambridge.org/core/services/aop-cambridge-core/content/view/S1323358014000332">https://www.cambridge.org/core/services/aop-cambridge-core/content/view/S1323358014000332</a></p>
<dl class="simple">
<dt>xtmp<span class="classifier">float array</span></dt><dd><p>Rest-frame wavelength, in AA.</p>
</dd>
<dt>ytmp<span class="classifier">float array</span></dt><dd><p>flux, in f_lambda.</p>
</dd>
<dt>zin<span class="classifier"></span></dt><dd><p>target redshift of IGM application</p>
</dd>
<dt>R_b1<span class="classifier">float</span></dt><dd><p>Bubble size, in Mpc</p>
</dd>
</dl>
<p>IGM attenuated flux.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function_igm.get_H">
<span class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></span><span class="sig-name descname"><span class="pre">get_H</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.get_H" title="Permalink to this definition"></a></dt>
<dd><p>Voigt function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function_igm.get_XI">
<span class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></span><span class="sig-name descname"><span class="pre">get_XI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.get_XI" title="Permalink to this definition"></a></dt>
<dd><p>Very simplified model.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function_igm.get_column">
<span class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></span><span class="sig-name descname"><span class="pre">get_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mpc_cm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.08568025e+24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.get_column" title="Permalink to this definition"></a></dt>
<dd><p>HI column density of IGM at zin, in cm^-2.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function_igm.get_dtdz">
<span class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></span><span class="sig-name descname"><span class="pre">get_dtdz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtdzs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.get_dtdz" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function_igm.get_nH">
<span class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></span><span class="sig-name descname"><span class="pre">get_nH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.get_nH" title="Permalink to this definition"></a></dt>
<dd><p>Get HI density by using Cen &amp; Haiman 2000.</p>
<p>HI density in IGM, in cm^-3</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function_igm.get_sig_lya">
<span class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></span><span class="sig-name descname"><span class="pre">get_sig_lya</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lam_o</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e+18</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.get_sig_lya" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>lam_o<span class="classifier">float array</span></dt><dd><p>Observed wavelength, in AA.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function_igm.madau_igm_abs">
<span class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></span><span class="sig-name descname"><span class="pre">madau_igm_abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xtmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xLL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1216.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.madau_igm_abs" title="Permalink to this definition"></a></dt>
<dd><p>Apply IMG-attenuation of Madau (1995) of zin to the input flux.</p>
<dl class="simple">
<dt>xtmp<span class="classifier">float array</span></dt><dd><p>Rest-frame wavelength, in AA.</p>
</dd>
<dt>ytmp<span class="classifier">float array</span></dt><dd><p>flux, in f_lambda.</p>
</dd>
</dl>
<p>zin : target redshift of IGM application</p>
<p>IGM attenuated flux.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.function_igm.masongronke_igm_abs">
<span class="sig-prename descclassname"><span class="pre">gsf.function_igm.</span></span><span class="sig-name descname"><span class="pre">masongronke_igm_abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xtmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xLL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1216.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e+18</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ckms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xLLL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1400</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.function_igm.masongronke_igm_abs" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>xtmp<span class="classifier">float array</span></dt><dd><p>Rest-frame wavelength, in AA.</p>
</dd>
<dt>ytmp<span class="classifier">float array</span></dt><dd><p>flux, in f_lambda.</p>
</dd>
</dl>
<p>zin : target redshift of IGM application</p>
<p>IGM attenuated flux.</p>
</dd></dl>

</section>
<section id="module-gsf.gsf">
<span id="gsf-gsf-module"></span><h2>gsf.gsf module<a class="headerlink" href="#module-gsf.gsf" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gsf.gsf.run_gsf_all">
<span class="sig-prename descclassname"><span class="pre">gsf.gsf.</span></span><span class="sig-name descname"><span class="pre">run_gsf_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fplt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cornerplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_Alog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_SFMS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_sed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figpdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_sfh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fancyplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_zhist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tset_SFR_SED</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zini</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delwave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_plot_resid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-19</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_plot_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_prior_sfh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norder_sfh_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.gsf.run_gsf_all" title="Permalink to this definition"></a></dt>
<dd><p>gsf pipeline, which runs all steps.</p>
<dl class="simple">
<dt>delwave<span class="classifier">float</span></dt><dd><p>If &gt;0, the input templates get smoothing to delwave. 
For fsps, this seems to be critical, so it has the same delwave over the template wavelength range.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.gsf.run_gsf_template">
<span class="sig-prename descclassname"><span class="pre">gsf.gsf.</span></span><span class="sig-name descname"><span class="pre">run_gsf_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fplt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delwave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.gsf.run_gsf_template" title="Permalink to this definition"></a></dt>
<dd><p>This is only for 0 and 1, to get templates.
Not for fitting, nor plotting.</p>
</dd></dl>

</section>
<section id="module-gsf.maketmp_filt">
<span id="gsf-maketmp-filt-module"></span><h2>gsf.maketmp_filt module<a class="headerlink" href="#module-gsf.maketmp_filt" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gsf.maketmp_filt.check_library">
<span class="sig-prename descclassname"><span class="pre">gsf.maketmp_filt.</span></span><span class="sig-name descname"><span class="pre">check_library</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">af</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nround</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_filt.check_library" title="Permalink to this definition"></a></dt>
<dd><p>Check library if it has a consistency setup as input file.</p>
<p>flag : bool</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.maketmp_filt.get_LSF">
<span class="sig-prename descclassname"><span class="pre">gsf.maketmp_filt.</span></span><span class="sig-name descname"><span class="pre">get_LSF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_EXTR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e+18</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_filt.get_LSF" title="Permalink to this definition"></a></dt>
<dd><p>Gets Morphology params, and returns LSF</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.maketmp_filt.get_spectrum_draine">
<span class="sig-prename descclassname"><span class="pre">gsf.maketmp_filt.</span></span><span class="sig-name descname"><span class="pre">get_spectrum_draine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda_d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zbest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIR_DUST</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./DL07spec/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.055</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_filt.get_spectrum_draine" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>lambda_d<span class="classifier">array</span></dt><dd><p>Wavelength array, in AA.</p>
</dd>
<dt>phi<span class="classifier">float</span></dt><dd><p>Eq.34 of Draine &amp; Li 2007. (default: 0.055g/(ergs/s))</p>
</dd>
<dt>DL<span class="classifier">float</span></dt><dd><p>in cm.</p>
</dd>
</dl>
<p>Interpolated dust emission in Fnu of m0=25.0. In units of Fnu/Msun</p>
<p>umins = [‘0.10’, ‘0.15’, ‘0.20’, ‘0.30’, ‘0.40’, ‘0.50’, ‘0.70’, ‘0.80’, ‘1.00’, ‘1.20’,            ‘1.50’, ‘2.00’, ‘2.50’, ‘3.00’, ‘4.00’, ‘5.00’, ‘7.00’, ‘8.00’, ‘10.0’, ‘12.0’, ‘15.0’,            ‘20.0’, ‘25.0’]
umaxs = [‘1e3’, ‘1e4’, ‘1e5’, ‘1e6’, ‘1e7’]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.maketmp_filt.maketemp">
<span class="sig-prename descclassname"><span class="pre">gsf.maketmp_filt.</span></span><span class="sig-name descname"><span class="pre">maketemp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebblim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamliml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamlimu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolbb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delwave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_IGM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_filt.maketemp" title="Permalink to this definition"></a></dt>
<dd><p>Make SPECTRA at given z and filter set.
Also, after v1.8, through this function library and data are register to the main class object, MB.</p>
<dl class="simple">
<dt>inputs<span class="classifier">str</span></dt><dd><p>Configuration file.</p>
</dd>
<dt>zbest<span class="classifier">float</span></dt><dd><p>Best redshift at this iteration. Templates are generated based on this reshift.</p>
</dd>
<dt>Z<span class="classifier">array</span></dt><dd><p>Stellar phase metallicity in logZsun.</p>
</dd>
<dt>age<span class="classifier">array</span></dt><dd><p>Age, in Gyr.</p>
</dd>
<dt>fneb<span class="classifier">int</span></dt><dd><p>flag for adding nebular emissionself.</p>
</dd>
<dt>tmp_norm<span class="classifier">float</span></dt><dd><p>Normalization of the stored templated. i.e. each template is in units of tmp_norm [Lsun].</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.maketmp_filt.maketemp_tau">
<span class="sig-prename descclassname"><span class="pre">gsf.maketmp_filt.</span></span><span class="sig-name descname"><span class="pre">maketemp_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebblim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamliml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamlimu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolbb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_IGM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delwave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_filt.maketemp_tau" title="Permalink to this definition"></a></dt>
<dd><p>Make SPECTRA at given z and filter set.</p>
<dl class="simple">
<dt>inputs<span class="classifier">str</span></dt><dd><p>Configuration file.</p>
</dd>
<dt>zbest :float</dt><dd><p>Best redshift at this iteration. Templates are generated based on this reshift.</p>
</dd>
<dt>Z<span class="classifier">array</span></dt><dd><p>Stellar phase metallicity in logZsun.</p>
</dd>
<dt>age<span class="classifier">array</span></dt><dd><p>Age, in Gyr.</p>
</dd>
<dt>fneb<span class="classifier">int</span></dt><dd><p>flag for adding nebular emissionself.</p>
</dd>
<dt>f_IGM<span class="classifier">bool</span></dt><dd><p>IGM attenuation. Madau.</p>
</dd>
<dt>nthin<span class="classifier">int</span></dt><dd><p>Thinning templates.</p>
</dd>
<dt>lammax<span class="classifier">float</span></dt><dd><p>Maximum wavelength in RF.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.maketmp_filt.sim_spec">
<span class="sig-prename descclassname"><span class="pre">gsf.maketmp_filt.</span></span><span class="sig-name descname"><span class="pre">sim_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_filt.sim_spec" title="Permalink to this definition"></a></dt>
<dd><p>SIMULATION of SPECTRA.</p>
<p>sn : float array</p>
<p>frand : float array</p>
<p>erand :  float array</p>
<p><a class="reference internal" href="#gsf.maketmp_filt.get_spectrum_draine" title="gsf.maketmp_filt.get_spectrum_draine"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_spectrum_draine()</span></code></a></p>
</dd></dl>

</section>
<section id="module-gsf.maketmp_z0">
<span id="gsf-maketmp-z0-module"></span><h2>gsf.maketmp_z0 module<a class="headerlink" href="#module-gsf.maketmp_z0" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gsf.maketmp_z0.make_tmp_z0">
<span class="sig-prename descclassname"><span class="pre">gsf.maketmp_z0.</span></span><span class="sig-name descname"><span class="pre">make_tmp_z0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_no_neb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zforce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_mp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_z0.make_tmp_z0" title="Permalink to this definition"></a></dt>
<dd><p>This is for the preparation of default template, with FSPS, at z=0.
Should be run before SED fitting.</p>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.fitting.Mainbody" title="gsf.fitting.Mainbody"><code class="xref py py-class docutils literal notranslate"><span class="pre">gsf.fitting.Mainbody</span></code></a><span class="classifier">class</span></dt><dd><p>Mainbody class, that contains attributes.</p>
</dd>
<dt>lammin<span class="classifier">float, optional</span></dt><dd><p>Minimum value of the rest-frame wavelength of the template, in AA.</p>
</dd>
<dt>lammax<span class="classifier">float, optional</span></dt><dd><p>Maximum value of the rest-frame wavelength of the template, in AA.</p>
</dd>
<dt>tau_lim<span class="classifier">float, optional</span></dt><dd><p>Maximum value of tau of the template, in Gyr. Tau smaller than this 
value would be approximated by SSP.</p>
</dd>
<dt>force_no_neb<span class="classifier">bool</span></dt><dd><p>Turn this on that you are very much sure do not want to include emission line templates, 
maybe to save some time running z0 module.</p>
</dd>
<dt>f_mp<span class="classifier">bool</span></dt><dd><p>Multiprocessing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.maketmp_z0.make_tmp_z0_bpass">
<span class="sig-prename descclassname"><span class="pre">gsf.maketmp_z0.</span></span><span class="sig-name descname"><span class="pre">make_tmp_z0_bpass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zforce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zsun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_z0.make_tmp_z0_bpass" title="Permalink to this definition"></a></dt>
<dd><p>This is for the preparation of default template, with BPASS templates, at z=0.
Should be run before SED fitting.</p>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.fitting.Mainbody" title="gsf.fitting.Mainbody"><code class="xref py py-class docutils literal notranslate"><span class="pre">gsf.fitting.Mainbody</span></code></a><span class="classifier">class</span></dt><dd><p>Mainbody class, that contains attributes.</p>
</dd>
<dt>lammin<span class="classifier">float, optional</span></dt><dd><p>Minimum value of the rest-frame wavelength of the template, in AA.</p>
</dd>
<dt>lammax<span class="classifier">float, optional</span></dt><dd><p>Maximum value of the rest-frame wavelength of the template, in AA.</p>
</dd>
<dt>BPASS_DIR<span class="classifier">str, optional</span></dt><dd><p>Path to the ditectory where BPASS templates are storesd.</p>
</dd>
<dt>BPASS_ver<span class="classifier">str, optional</span></dt><dd><p>Version of BPASS. Used to identify template files.</p>
</dd>
<dt>Zsun<span class="classifier">float, optional</span></dt><dd><p>Metallicity of templates, in units of absolute value (e.g. Zsun=0.02 for BPASS).</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-gsf.maketmp_z0_tau">
<span id="gsf-maketmp-z0-tau-module"></span><h2>gsf.maketmp_z0_tau module<a class="headerlink" href="#module-gsf.maketmp_z0_tau" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gsf.maketmp_z0_tau.get_lognorm">
<span class="sig-prename descclassname"><span class="pre">gsf.maketmp_z0_tau.</span></span><span class="sig-name descname"><span class="pre">get_lognorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltau0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_z0_tau.get_lognorm" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.maketmp_z0_tau.make_tmp_z0">
<span class="sig-prename descclassname"><span class="pre">gsf.maketmp_z0_tau.</span></span><span class="sig-name descname"><span class="pre">make_tmp_z0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lammax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zforce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.maketmp_z0_tau.make_tmp_z0" title="Permalink to this definition"></a></dt>
<dd><p>This is for the preparation of default template, with FSPS, at z=0.
Should be run before SED fitting.</p>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.fitting.Mainbody" title="gsf.fitting.Mainbody"><code class="xref py py-class docutils literal notranslate"><span class="pre">gsf.fitting.Mainbody</span></code></a><span class="classifier">class</span></dt><dd><p>Mainbody class, that contains attributes.</p>
</dd>
<dt>lammin<span class="classifier">float, optional</span></dt><dd><p>Minimum value of the rest-frame wavelength of the template, in AA.</p>
</dd>
<dt>lammax<span class="classifier">float, optional</span></dt><dd><p>Maximum value of the rest-frame wavelength of the template, in AA.</p>
</dd>
<dt>tau_lim<span class="classifier">float, optional</span></dt><dd><p>Maximum value of tau of the template, in Gyr. Tau smaller than this 
value would be approximated by SSP.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-gsf.minimizer">
<span id="gsf-minimizer-module"></span><h2>gsf.minimizer module<a class="headerlink" href="#module-gsf.minimizer" title="Permalink to this headline"></a></h2>
<p>Simple minimizer is a wrapper around scipy.leastsq, allowing a user to build
a fitting model as a function of general purpose Fit Parameters that can be
fixed or varied, bounded, and written as a simple expression of other Fit
Parameters.</p>
<p>The user sets up a model in terms of instance of Parameters and writes a
function-to-be-minimized (residual function) in terms of these Parameters.</p>
<dl class="simple">
<dt>Original copyright:</dt><dd><p>Copyright (c) 2011 Matthew Newville, The University of Chicago</p>
</dd>
</dl>
<p>See LICENSE for more complete authorship information and license.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="gsf.minimizer.AbortFitException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></span><span class="sig-name descname"><span class="pre">AbortFitException</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.AbortFitException" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#gsf.minimizer.MinimizerException" title="gsf.minimizer.MinimizerException"><code class="xref py py-class docutils literal notranslate"><span class="pre">gsf.minimizer.MinimizerException</span></code></a></p>
<p>Raised when a fit is aborted by the user.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gsf.minimizer.Candidate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></span><span class="sig-name descname"><span class="pre">Candidate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Candidate" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="gsf.minimizer.Candidate.params">
<span class="sig-name descname"><span class="pre">params</span></span><a class="headerlink" href="#gsf.minimizer.Candidate.params" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gsf.minimizer.Candidate.score">
<span class="sig-name descname"><span class="pre">score</span></span><a class="headerlink" href="#gsf.minimizer.Candidate.score" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></span><span class="sig-name descname"><span class="pre">Minimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">userfcn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn_kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_cb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_fcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A general minimizer for curve fitting and optimization.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.ampgo">
<span class="sig-name descname"><span class="pre">ampgo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.ampgo" title="Permalink to this definition"></a></dt>
<dd><p>Find the global minimum of a multivariate function using AMPGO.</p>
<p>AMPGO stands for ‘Adaptive Memory Programming for Global Optimization’
and is an efficient algorithm to find the global minimum.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</p>
</dd>
<dt><a href="#id1"><span class="problematic" id="id2">**</span></a>kws<span class="classifier">dict, optional</span></dt><dd><p>Minimizer options to pass to the ampgo algorithm, the options are
listed below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>local: str (default is &#39;L-BFGS-B&#39;)
    Name of the local minimization method. Valid options are:
    - &#39;L-BFGS-B&#39;
    - &#39;Nelder-Mead&#39;
    - &#39;Powell&#39;
    - &#39;TNC&#39;
    - &#39;SLSQP&#39;
local_opts: dict (default is None)
    Options to pass to the local minimizer.
maxfunevals: int (default is None)
    Maximum number of function evaluations. If None, the optimization will stop
    after `totaliter` number of iterations.
totaliter: int (default is 20)
    Maximum number of global iterations.
maxiter: int (default is 5)
    Maximum number of `Tabu Tunneling` iterations during each global iteration.
glbtol: float (default is 1e-5)
    Tolerance whether or not to accept a solution after a tunneling phase.
eps1: float (default is 0.02)
    Constant used to define an aspiration value for the objective function during
    the Tunneling phase.
eps2: float (default is 0.1)
    Perturbation factor used to move away from the latest local minimum at the
    start of a Tunneling phase.
tabulistsize: int (default is 5)
    Size of the (circular) tabu search list.
tabustrategy: str (default is &#39;farthest&#39;)
    Strategy to use when the size of the tabu list exceeds `tabulistsize`. It
    can be &#39;oldest&#39; to drop the oldest point from the tabu list or &#39;farthest&#39;
    to drop the element farthest from the last local minimum found.
disp: bool (default is False)
    Set to True to print convergence messages.
</pre></div>
</div>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the parameters from the ampgo method, with fit
parameters, statistics and such. The return values (<cite>x0</cite>, <cite>fval</cite>,
<cite>eval</cite>, <cite>msg</cite>, <cite>tunnel</cite>) are stored as <cite>ampgo_&lt;parname&gt;</cite> attributes.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.10.</span></p>
</div>
<p>The Python implementation was written by Andrea Gavana in 2014
(<a class="reference external" href="http://infinity77.net/global_optimization/index.html">http://infinity77.net/global_optimization/index.html</a>).</p>
<p>The details of the AMPGO algorithm are described in the paper
“Adaptive Memory Programming for Constrained Global Optimization”
located here:</p>
<p><a class="reference external" href="http://leeds-faculty.colorado.edu/glover/fred%20pubs/416%20-%20AMP%20(TS)%20for%20Constrained%20Global%20Opt%20w%20Lasdon%20et%20al%20.pdf">http://leeds-faculty.colorado.edu/glover/fred%20pubs/416%20-%20AMP%20(TS)%20for%20Constrained%20Global%20Opt%20w%20Lasdon%20et%20al%20.pdf</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.basinhopping">
<span class="sig-name descname"><span class="pre">basinhopping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.basinhopping" title="Permalink to this definition"></a></dt>
<dd><p>Use the <cite>basinhopping</cite> algorithm to find the global minimum of a function.</p>
<p>This method calls <a href="#id3"><span class="problematic" id="id4">:scipydoc:`optimize.basinhopping`</span></a> using the default
arguments. The default minimizer is <cite>BFGS</cite>, but since lmfit supports
parameter bounds for all minimizers, the user can choose any of the
solvers present in <a href="#id5"><span class="problematic" id="id6">:scipydoc:`optimize.minimize`</span></a>.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code> object, optional</span></dt><dd><p>Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the optimization results from the basinhopping
algorithm.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.10.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.brute">
<span class="sig-name descname"><span class="pre">brute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.brute" title="Permalink to this definition"></a></dt>
<dd><p>Use the <cite>brute</cite> method to find the global minimum of a function.</p>
<p>The following parameters are passed to <a href="#id7"><span class="problematic" id="id8">:scipydoc:`optimize.brute`</span></a>
and cannot be changed:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 11%" />
<col style="width: 61%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><a class="reference internal" href="#gsf.minimizer.Minimizer.brute" title="gsf.minimizer.Minimizer.brute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">brute()</span></code></a> arg</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>full_output</p></td>
<td><p>1</p></td>
<td><p>Return the evaluation grid and
the objective function’s values on it.</p></td>
</tr>
<tr class="row-odd"><td><p>finish</p></td>
<td><p>None</p></td>
<td><p>No “polishing” function is to be used
after the grid search.</p></td>
</tr>
<tr class="row-even"><td><p>disp</p></td>
<td><p>False</p></td>
<td><p>Do not print convergence messages
(when finish is not None).</p></td>
</tr>
</tbody>
</table>
<p>It assumes that the input Parameters have been initialized, and a
function to minimize has been properly set up.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</p>
</dd>
<dt>Ns<span class="classifier">int, optional</span></dt><dd><p>Number of grid points along the axes, if not otherwise specified
(see Notes).</p>
</dd>
<dt>keep<span class="classifier">int, optional</span></dt><dd><p>Number of best candidates from the brute force method that are
stored in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">candidates</span></code> attribute. If ‘all’, then all grid
points from <a href="#id9"><span class="problematic" id="id10">:scipydoc:`optimize.brute`</span></a> are stored as candidates.</p>
</dd>
<dt>workers<span class="classifier">int or map-like callable, optional</span></dt><dd><p>For parallel evaluation of the grid, added in SciPy v1.3 (see
<a href="#id11"><span class="problematic" id="id12">:scipydoc:`optimize.brute`</span></a> for more details).</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the parameters from the brute force method.
The return values (<cite>x0</cite>, <cite>fval</cite>, <cite>grid</cite>, <cite>Jout</cite>) from
<a href="#id13"><span class="problematic" id="id14">:scipydoc:`optimize.brute`</span></a> are stored as <cite>brute_&lt;parname&gt;</cite> attributes.
The <cite>MinimizerResult</cite> also contains the <cite>candidates</cite> attribute and
<cite>show_candidates()</cite> method. The <cite>candidates</cite> attribute contains the
parameters and chisqr from the brute force method as a namedtuple,
(‘Candidate’, [‘params’, ‘score’]), sorted on the (lowest) chisqr
value. To access the values for a particular candidate one can use
<cite>result.candidate[#].params</cite> or <cite>result.candidate[#].score</cite>, where
a lower # represents a better candidate. The <cite>show_candidates(#)</cite>
uses the <code class="xref py py-meth docutils literal notranslate"><span class="pre">pretty_print()</span></code> method to show a specific candidate-#
or all candidates when no number is specified.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.6.</span></p>
</div>
<p>The <a class="reference internal" href="#gsf.minimizer.Minimizer.brute" title="gsf.minimizer.Minimizer.brute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">brute()</span></code></a> method evalutes the function at each point of a
multidimensional grid of points. The grid points are generated from the
parameter ranges using <cite>Ns</cite> and (optional) <cite>brute_step</cite>.
The implementation in <a href="#id15"><span class="problematic" id="id16">:scipydoc:`optimize.brute`</span></a> requires finite bounds
and the <cite>range</cite> is specified as a two-tuple <cite>(min, max)</cite> or slice-object
<cite>(min, max, brute_step)</cite>. A slice-object is used directly, whereas a
two-tuple is converted to a slice object that interpolates <cite>Ns</cite> points
from <cite>min</cite> to <cite>max</cite>, inclusive.</p>
<p>In addition, the <a class="reference internal" href="#gsf.minimizer.Minimizer.brute" title="gsf.minimizer.Minimizer.brute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">brute()</span></code></a> method in lmfit, handles three other
scenarios given below with their respective slice-object:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>lower bound (<code class="xref py py-attr docutils literal notranslate"><span class="pre">min</span></code>) and <code class="xref py py-attr docutils literal notranslate"><span class="pre">brute_step</span></code> are specified:</dt><dd><p>range = (<cite>min</cite>, <cite>min</cite> + <cite>Ns</cite> * <cite>brute_step</cite>, <cite>brute_step</cite>).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>upper bound (<code class="xref py py-attr docutils literal notranslate"><span class="pre">max</span></code>) and <code class="xref py py-attr docutils literal notranslate"><span class="pre">brute_step</span></code> are specified:</dt><dd><p>range = (<cite>max</cite> - <cite>Ns</cite> * <cite>brute_step</cite>, <cite>max</cite>, <cite>brute_step</cite>).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>numerical value (<code class="xref py py-attr docutils literal notranslate"><span class="pre">value</span></code>) and <code class="xref py py-attr docutils literal notranslate"><span class="pre">brute_step</span></code> are specified:</dt><dd><p>range = (<cite>value</cite> - (<cite>Ns</cite>//2) * <cite>brute_step</cite>, <cite>value</cite> +
(<cite>Ns</cite>//2) * <cite>brute_step</cite>, <cite>brute_step</cite>).</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.dual_annealing">
<span class="sig-name descname"><span class="pre">dual_annealing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.dual_annealing" title="Permalink to this definition"></a></dt>
<dd><p>Use the <cite>dual_annealing</cite> algorithm to find the global minimum.</p>
<p>This method calls <a href="#id17"><span class="problematic" id="id18">:scipydoc:`optimize.dual_annealing`</span></a> using its
default arguments.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</p>
</dd>
<dt><a href="#id19"><span class="problematic" id="id20">**</span></a>kws<span class="classifier">dict, optional</span></dt><dd><p>Minimizer options to pass to the dual_annealing algorithm.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the parameters from the dual_annealing method.
The return values specific to <a href="#id21"><span class="problematic" id="id22">:scipydoc:`optimize.dual_annealing`</span></a>
(<cite>x</cite>, <cite>fun</cite>, <cite>nfev</cite>, <cite>nhev</cite>, <cite>njev</cite>, and <cite>nit</cite>) are stored as
<cite>da_&lt;parname&gt;</cite> attributes.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.14.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.emcee">
<span class="sig-name descname"><span class="pre">emcee</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntemps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_sampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float_behavior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'posterior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_converge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nevery</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.emcee" title="Permalink to this definition"></a></dt>
<dd><p>Bayesian sampling of the posterior distribution using the <cite>emcee</cite>
Markov Chain Monte Carlo package.</p>
<p>The method assumes that the prior is Uniform. You need to have <cite>emcee</cite>
version 3 installed to use this method.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Parameters to use as starting point. If this is not specified then
the Parameters used to initialize the Minimizer object are used.</p>
</dd>
<dt>steps<span class="classifier">int, optional</span></dt><dd><p>How many samples you would like to draw from the posterior
distribution for each of the walkers?</p>
</dd>
<dt>nwalkers<span class="classifier">int, optional</span></dt><dd><p>Should be set so <span class="math notranslate nohighlight">\(nwalkers &gt;&gt; nvarys\)</span>, where <cite>nvarys</cite> are
the number of parameters being varied during the fit.
‘Walkers are the members of the ensemble. They are almost like
separate Metropolis-Hastings chains but, of course, the proposal
distribution for a given walker depends on the positions of all
the other walkers in the ensemble.’ - from the <cite>emcee</cite> webpage.</p>
</dd>
<dt>burn<span class="classifier">int, optional</span></dt><dd><p>Discard this many samples from the start of the sampling regime.</p>
</dd>
<dt>thin<span class="classifier">int, optional</span></dt><dd><p>Only accept 1 in every <cite>thin</cite> samples.</p>
</dd>
<dt>ntemps<span class="classifier">int, deprecated</span></dt><dd><p>ntemps has no effect.</p>
</dd>
<dt>pos<span class="classifier">numpy.ndarray, optional</span></dt><dd><p>Specify the initial positions for the sampler, an ndarray of shape
<cite>(nwalkers, nvarys)</cite>.  You can also initialise using a previous
chain of the same <cite>nwalkers</cite> and <cite>nvarys</cite>. Note that <cite>nvarys</cite> may
be one larger than you expect it to be if your <cite>userfcn</cite> returns
an array and <cite>is_weighted</cite> is <cite>False</cite>.</p>
</dd>
<dt>reuse_sampler<span class="classifier">bool, optional</span></dt><dd><p>Set to <cite>True</cite> if you have already run <cite>emcee</cite> with the <cite>Minimizer</cite>
instance and want to continue to draw from its <code class="docutils literal notranslate"><span class="pre">sampler</span></code> (and so
retain the chain history). If <cite>False</cite>,  a new sampler is created.
The keywords <cite>nwalkers</cite>, <cite>pos</cite>, and <cite>params</cite> will be ignored when
this is set, as they will be set by the existing sampler.
<strong>Important</strong>: the Parameters used to create the sampler must not
change in-between calls to <cite>emcee</cite>. Alteration of Parameters
would include changed <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">vary</span></code> and <code class="docutils literal notranslate"><span class="pre">expr</span></code>
attributes. This may happen, for example, if you use an altered
Parameters object and call the <cite>minimize</cite> method in-between calls
to <cite>emcee</cite>.</p>
</dd>
<dt>workers<span class="classifier">Pool-like or int, optional</span></dt><dd><p>For parallelization of sampling.  It can be any Pool-like object
with a map method that follows the same calling sequence as the
built-in <cite>map</cite> function. If int is given as the argument, then a
multiprocessing-based pool is spawned internally with the
corresponding number of parallel processes. ‘mpi4py’-based
parallelization and ‘joblib’-based parallelization pools can also
be used here. <strong>Note</strong>: because of multiprocessing overhead it may
only be worth parallelising if the objective function is expensive
to calculate, or if there are a large number of objective
evaluations per step (<cite>nwalkers * nvarys</cite>).</p>
</dd>
<dt>float_behavior<span class="classifier">str, optional</span></dt><dd><p>Meaning of float (scalar) output of objective function. Use
‘posterior’ if it returns a log-posterior probability or ‘chi2’
if it returns <span class="math notranslate nohighlight">\(\chi^2\)</span>. See Notes for further details.</p>
</dd>
<dt>is_weighted<span class="classifier">bool, optional</span></dt><dd><p>Has your objective function been weighted by measurement
uncertainties? If <cite>is_weighted is True</cite> then your objective
function is assumed to return residuals that have been divided by
the true measurement uncertainty <cite>(data - model) / sigma</cite>. If
<cite>is_weighted is False</cite> then the objective function is assumed to
return unweighted residuals, <cite>data - model</cite>. In this case <cite>emcee</cite>
will employ a positive measurement uncertainty during the sampling.
This measurement uncertainty will be present in the output params
and output chain with the name <cite>__lnsigma</cite>. A side effect of this
is that you cannot use this parameter name yourself.
<strong>Important</strong> this parameter only has any effect if your objective
function returns an array. If your objective function returns a
float, then this parameter is ignored. See Notes for more details.</p>
</dd>
<dt>seed<span class="classifier">int or <cite>numpy.random.RandomState</cite>, optional</span></dt><dd><p>If <cite>seed</cite> is an int, a new <cite>numpy.random.RandomState</cite> instance is
used, seeded with <cite>seed</cite>.
If <cite>seed</cite> is already a <cite>numpy.random.RandomState</cite> instance, then
that <cite>numpy.random.RandomState</cite> instance is used.
Specify <cite>seed</cite> for repeatable minimizations.</p>
</dd>
<dt>progress<span class="classifier">bool, optional</span></dt><dd><p>Print a progress bar to the console while running.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>MinimizerResult object containing updated params, statistics,
etc. The updated params represent the median of the samples,
while the uncertainties are half the difference of the 15.87
and 84.13 percentiles.  The <cite>MinimizerResult</cite> contains a few
additional attributes: <code class="docutils literal notranslate"><span class="pre">chain</span></code> contain the samples and has
shape <cite>((steps - burn) // thin, nwalkers, nvarys)</cite>.
<code class="docutils literal notranslate"><span class="pre">flatchain</span></code> is a <cite>pandas.DataFrame</cite> of the flattened chain,
that can be accessed with <cite>result.flatchain[parname]</cite>.
<code class="docutils literal notranslate"><span class="pre">lnprob</span></code> contains the log probability for each sample in
<code class="docutils literal notranslate"><span class="pre">chain</span></code>.  The sample with the highest probability corresponds
to the maximum likelihood estimate.  <code class="docutils literal notranslate"><span class="pre">acor</span></code> is an array
containing the autocorrelation time for each parameter if the
autocorrelation time can be computed from the chain. Finally,
<code class="docutils literal notranslate"><span class="pre">acceptance_fraction</span></code> (an array of the fraction of steps
accepted for each walker).</p>
</dd>
</dl>
<p>This method samples the posterior distribution of the parameters
using Markov Chain Monte Carlo.  It calculates the log-posterior
probability of the model parameters, <cite>F</cite>, given the data, <cite>D</cite>,
<span class="math notranslate nohighlight">\(\ln p(F_{true} | D)\)</span>. This ‘posterior probability’ is given by:</p>
<div class="math notranslate nohighlight">
\[\ln p(F_{true} | D) \propto \ln p(D | F_{true}) + \ln p(F_{true})\]</div>
<p>where <span class="math notranslate nohighlight">\(\ln p(D | F_{true})\)</span> is the ‘log-likelihood’ and
<span class="math notranslate nohighlight">\(\ln p(F_{true})\)</span> is the ‘log-prior’. The default log-prior
encodes prior information known about the model that the log-prior
probability is <cite>-numpy.inf</cite> (impossible) if any of the parameters
is outside its limits, and is zero if all the parameters are inside
their bounds (uniform prior). The log-likelihood function is <a class="footnote-reference brackets" href="#id24" id="id23">1</a>:</p>
<div class="math notranslate nohighlight">
\[\ln p(D|F_{true}) = -\frac{1}{2}\sum_n \left[\frac{(g_n(F_{true}) - D_n)^2}{s_n^2}+\ln (2\pi s_n^2)\right]\]</div>
<p>The first term represents the residual (<span class="math notranslate nohighlight">\(g\)</span> being the generative
model, <span class="math notranslate nohighlight">\(D_n\)</span> the data and <span class="math notranslate nohighlight">\(s_n\)</span> the measurement
uncertainty). This gives <span class="math notranslate nohighlight">\(\chi^2\)</span> when summed over all data
points.  The objective function may also return the log-posterior
probability, <span class="math notranslate nohighlight">\(\ln p(F_{true} | D)\)</span>.  Since the default
log-prior term is zero, the objective function can also just return
the log-likelihood, unless you wish to create a non-uniform prior.</p>
<p>If the objective function returns a float value, this is assumed by
default to be the log-posterior probability, (<cite>float_behavior</cite> default
is ‘posterior’. If your objective function returns <span class="math notranslate nohighlight">\(\chi^2\)</span>,
then you should use a value of <cite>float_behavior=’chi2’</cite>.</p>
<p>By default objective functions may return an ndarray of (possibly
weighted) residuals. In this case, use <cite>is_weighted</cite> to select whether
these are correctly weighted by measurement uncertainty.  Note that
this ignores the second term above, so that to calculate a correct
log-posterior probability value your objective function should return
a float value.  With <cite>is_weighted=False</cite> the data uncertainty, <cite>s_n</cite>,
will be treated as a nuisance parameter to be marginalized out. This
uses strictly positive uncertainty (homoscedasticity) for each data
point, <span class="math notranslate nohighlight">\(s_n = \exp(\rm{\_\_lnsigma})\)</span>.  <cite>__lnsigma</cite> will be
present in <cite>MinimizerResult.params</cite>, as well as <cite>Minimizer.chain</cite> and
<cite>nvarys</cite> will be increased by one.</p>
<dl class="footnote brackets">
<dt class="label" id="id24"><span class="brackets"><a class="fn-backref" href="#id23">1</a></span></dt>
<dd><p><a class="reference external" href="https://emcee.readthedocs.io">https://emcee.readthedocs.io</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.least_squares">
<span class="sig-name descname"><span class="pre">least_squares</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.least_squares" title="Permalink to this definition"></a></dt>
<dd><p>Least-squares minimization using <a href="#id25"><span class="problematic" id="id26">:scipydoc:`optimize.least_squares`</span></a>.</p>
<p>This method wraps <a href="#id27"><span class="problematic" id="id28">:scipydoc:`optimize.least_squares`</span></a>, which has inbuilt
support for bounds and robust loss functions. By default it uses the
Trust Region Reflective algorithm with a linear loss function (i.e.,
the standard least-squares problem).</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Parameters to use as starting point.</p>
</dd>
<dt><a href="#id29"><span class="problematic" id="id30">**</span></a>kws<span class="classifier">dict, optional</span></dt><dd><p>Minimizer options to pass to <a href="#id31"><span class="problematic" id="id32">:scipydoc:`optimize.least_squares`</span></a>.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the optimized parameter and several
goodness-of-fit statistics.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.leastsq">
<span class="sig-name descname"><span class="pre">leastsq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.leastsq" title="Permalink to this definition"></a></dt>
<dd><p>Use Levenberg-Marquardt minimization to perform a fit.</p>
<p>It assumes that the input Parameters have been initialized, and
a function to minimize has been properly set up.
When possible, this calculates the estimated uncertainties and
variable correlations from the covariance matrix.</p>
<p>This method calls <a href="#id33"><span class="problematic" id="id34">:scipydoc:`optimize.leastsq`</span></a>.
By default, numerical derivatives are used, and the following
arguments are set:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 17%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><a class="reference internal" href="#gsf.minimizer.Minimizer.leastsq" title="gsf.minimizer.Minimizer.leastsq"><code class="xref py py-meth docutils literal notranslate"><span class="pre">leastsq()</span></code></a>
arg</p></th>
<th class="head"><p>Default Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>xtol</p></td>
<td><p>1.e-7</p></td>
<td><p>Relative error in the approximate solution</p></td>
</tr>
<tr class="row-odd"><td><p>ftol</p></td>
<td><p>1.e-7</p></td>
<td><p>Relative error in the desired sum of squares</p></td>
</tr>
<tr class="row-even"><td><p>maxfev</p></td>
<td><p>2000*(nvar+1)</p></td>
<td><p>Maximum number of function calls (nvar= # of variables)</p></td>
</tr>
<tr class="row-odd"><td><p>Dfun</p></td>
<td><p>None</p></td>
<td><p>Function to call for Jacobian calculation</p></td>
</tr>
</tbody>
</table>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Parameters to use as starting point.</p>
</dd>
<dt><a href="#id35"><span class="problematic" id="id36">**</span></a>kws<span class="classifier">dict, optional</span></dt><dd><p>Minimizer options to pass to <a href="#id37"><span class="problematic" id="id38">:scipydoc:`optimize.leastsq`</span></a>.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the optimized parameter
and several goodness-of-fit statistics.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.minimize">
<span class="sig-name descname"><span class="pre">minimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'leastsq'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.minimize" title="Permalink to this definition"></a></dt>
<dd><p>Perform the minimization.</p>
<dl>
<dt>method<span class="classifier">str, optional</span></dt><dd><p>Name of the fitting method to use. Valid values are:</p>
<ul class="simple">
<li><p><cite>‘leastsq’</cite>: Levenberg-Marquardt (default)</p></li>
<li><p><cite>‘least_squares’</cite>: Least-Squares minimization, using Trust Region Reflective method</p></li>
<li><p><cite>‘differential_evolution’</cite>: differential evolution</p></li>
<li><p><cite>‘brute’</cite>: brute force method</p></li>
<li><p><cite>‘basinhopping’</cite>: basinhopping</p></li>
<li><p><cite>‘ampgo’</cite>: Adaptive Memory Programming for Global Optimization</p></li>
<li><p>‘<cite>nelder</cite>’: Nelder-Mead</p></li>
<li><p><cite>‘lbfgsb’</cite>: L-BFGS-B</p></li>
<li><p><cite>‘powell’</cite>: Powell</p></li>
<li><p><cite>‘cg’</cite>: Conjugate-Gradient</p></li>
<li><p><cite>‘newton’</cite>: Newton-CG</p></li>
<li><p><cite>‘cobyla’</cite>: Cobyla</p></li>
<li><p><cite>‘bfgs’</cite>: BFGS</p></li>
<li><p><cite>‘tnc’</cite>: Truncated Newton</p></li>
<li><p><cite>‘trust-ncg’</cite>: Newton-CG trust-region</p></li>
<li><p><cite>‘trust-exact’</cite>: nearly exact trust-region</p></li>
<li><p><cite>‘trust-krylov’</cite>: Newton GLTR trust-region</p></li>
<li><p><cite>‘trust-constr’</cite>: trust-region for constrained optimization</p></li>
<li><p><cite>‘dogleg’</cite>: Dog-leg trust-region</p></li>
<li><p><cite>‘slsqp’</cite>: Sequential Linear Squares Programming</p></li>
<li><p><cite>‘emcee’</cite>: Maximum likelihood via Monte-Carlo Markov Chain</p></li>
<li><p><cite>‘shgo’</cite>: Simplicial Homology Global Optimization</p></li>
<li><p><cite>‘dual_annealing’</cite>: Dual Annealing optimization</p></li>
</ul>
<p>In most cases, these methods wrap and use the method with the
same name from <cite>scipy.optimize</cite>, or use
<cite>scipy.optimize.minimize</cite> with the same <cite>method</cite> argument.
Thus ‘<cite>leastsq</cite>’ will use <cite>scipy.optimize.leastsq</cite>, while
‘<cite>powell</cite>’ will use <cite>scipy.optimize.minimizer(…,
method=’powell’)</cite></p>
<p>For more details on the fitting methods please refer to the
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html">SciPy docs</a>.</p>
</dd>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Parameters of the model to use as starting values.</p>
</dd>
<dt><a href="#id39"><span class="problematic" id="id40">**</span></a>kws<span class="classifier">optional</span></dt><dd><p>Additional arguments are passed to the underlying minimization
method.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the optimized parameter and several
goodness-of-fit statistics.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.penalty">
<span class="sig-name descname"><span class="pre">penalty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fvars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.penalty" title="Permalink to this definition"></a></dt>
<dd><p>Penalty function for scalar minimizers.</p>
<dl class="simple">
<dt>fvars<span class="classifier">numpy.ndarray</span></dt><dd><p>Array of values for the variable parameters.</p>
</dd>
</dl>
<dl>
<dt>r<span class="classifier">float</span></dt><dd><p>The evaluated user-supplied objective function.</p>
<p>If the objective function is an array of size greater than 1,
use the scalar returned by <cite>self.reduce_fcn</cite>.  This defaults
to sum-of-squares, but can be replaced by other options.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.prepare_fit">
<span class="sig-name descname"><span class="pre">prepare_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.prepare_fit" title="Permalink to this definition"></a></dt>
<dd><p>Prepare parameters for fitting.</p>
<p>Prepares and initializes model and Parameters for subsequent
fitting. This routine prepares the conversion of <code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>
into fit variables, organizes parameter bounds, and parses, “compiles”
and checks constrain expressions.   The method also creates and returns
a new instance of a <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a> object that contains the
copy of the Parameters that will actually be varied in the fit.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Contains the Parameters for the model; if None, then the
Parameters used to initialize the Minimizer object are used.</p>
</dd>
</dl>
<p><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></p>
<p>This method is called directly by the fitting methods, and it is
generally not necessary to call this function explicitly.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.scalar_minimize">
<span class="sig-name descname"><span class="pre">scalar_minimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Nelder-Mead'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.scalar_minimize" title="Permalink to this definition"></a></dt>
<dd><p>Scalar minimization using <a href="#id41"><span class="problematic" id="id42">:scipydoc:`optimize.minimize`</span></a>.</p>
<p>Perform fit with any of the scalar minimization algorithms supported by
<a href="#id43"><span class="problematic" id="id44">:scipydoc:`optimize.minimize`</span></a>. Default argument values are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 18%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><a class="reference internal" href="#gsf.minimizer.Minimizer.scalar_minimize" title="gsf.minimizer.Minimizer.scalar_minimize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">scalar_minimize()</span></code></a>
arg</p></th>
<th class="head"><p>Default Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>method</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Nelder-Mead</span></code></p></td>
<td><p>fitting method</p></td>
</tr>
<tr class="row-odd"><td><p>tol</p></td>
<td><p>1.e-7</p></td>
<td><p>fitting and parameter tolerance</p></td>
</tr>
<tr class="row-even"><td><p>hess</p></td>
<td><p>None</p></td>
<td><p>Hessian of objective function</p></td>
</tr>
</tbody>
</table>
<dl>
<dt>method<span class="classifier">str, optional</span></dt><dd><p>Name of the fitting method to use. One of:</p>
<ul class="simple">
<li><p>‘Nelder-Mead’ (default)</p></li>
<li><p>‘L-BFGS-B’</p></li>
<li><p>‘Powell’</p></li>
<li><p>‘CG’</p></li>
<li><p>‘Newton-CG’</p></li>
<li><p>‘COBYLA’</p></li>
<li><p>‘BFGS’</p></li>
<li><p>‘TNC’</p></li>
<li><p>‘trust-ncg’</p></li>
<li><p>‘trust-exact’</p></li>
<li><p>‘trust-krylov’</p></li>
<li><p>‘trust-constr’</p></li>
<li><p>‘dogleg’</p></li>
<li><p>‘SLSQP’</p></li>
<li><p>‘differential_evolution’</p></li>
</ul>
</dd>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Parameters to use as starting point.</p>
</dd>
<dt><a href="#id45"><span class="problematic" id="id46">**</span></a>kws<span class="classifier">dict, optional</span></dt><dd><p>Minimizer options pass to <a href="#id47"><span class="problematic" id="id48">:scipydoc:`optimize.minimize`</span></a>.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the optimized parameter and several
goodness-of-fit statistics.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
<p>If the objective function returns a NumPy array instead
of the expected scalar, the sum of squares of the array
will be used.</p>
<p>Note that bounds and constraints can be set on Parameters
for any of these methods, so are not supported separately
for those designed to use bounds. However, if you use the
differential_evolution method you must specify finite
(min, max) for each varying Parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.shgo">
<span class="sig-name descname"><span class="pre">shgo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.shgo" title="Permalink to this definition"></a></dt>
<dd><p>Use the <cite>SHGO</cite> algorithm to find the global minimum.</p>
<p>SHGO stands for “simplicial homology global optimization” and calls
<a href="#id49"><span class="problematic" id="id50">:scipydoc:`optimize.shgo`</span></a> using its default arguments.</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>, optional</span></dt><dd><p>Contains the Parameters for the model. If None, then the
Parameters used to initialize the Minimizer object are used.</p>
</dd>
<dt><a href="#id51"><span class="problematic" id="id52">**</span></a>kws<span class="classifier">dict, optional</span></dt><dd><p>Minimizer options to pass to the SHGO algorithm.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the parameters from the SHGO method.
The return values specific to <a href="#id53"><span class="problematic" id="id54">:scipydoc:`optimize.shgo`</span></a> (<cite>x</cite>,
<cite>xl</cite>, <cite>fun</cite>, <cite>funl</cite>, <cite>nfev</cite>, <cite>nit</cite>, <cite>nlfev</cite>, <cite>nlhev</cite>, and
<cite>nljev</cite>) are stored as <cite>shgo_&lt;parname&gt;</cite> attributes.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.14.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.unprepare_fit">
<span class="sig-name descname"><span class="pre">unprepare_fit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.Minimizer.unprepare_fit" title="Permalink to this definition"></a></dt>
<dd><p>Clean fit state, so that subsequent fits need to call prepare_fit().</p>
<p>removes AST compilations of constraint expressions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gsf.minimizer.Minimizer.values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">values</span></span><a class="headerlink" href="#gsf.minimizer.Minimizer.values" title="Permalink to this definition"></a></dt>
<dd><p>Return Parameter values in a simple dictionary.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="gsf.minimizer.MinimizerException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></span><span class="sig-name descname"><span class="pre">MinimizerException</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.MinimizerException" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>General Purpose Exception.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gsf.minimizer.MinimizerResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></span><span class="sig-name descname"><span class="pre">MinimizerResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.MinimizerResult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The results of a minimization.</p>
<p>Minimization results include data such as status and error messages,
fit statistics, and the updated (i.e., best-fit) parameters themselves
in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">params</span></code> attribute.</p>
<p>The list of (possible) <cite>MinimizerResult</cite> attributes is given below:</p>
<dl>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></span></dt><dd><p>The best-fit parameters resulting from the fit.</p>
</dd>
<dt>status<span class="classifier">int</span></dt><dd><p>Termination status of the optimizer. Its value depends on the
underlying solver. Refer to <cite>message</cite> for details.</p>
</dd>
<dt>var_names<span class="classifier">list</span></dt><dd><p>Ordered list of variable parameter names used in optimization, and
useful for understanding the values in <code class="xref py py-attr docutils literal notranslate"><span class="pre">init_vals</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">covar</span></code>.</p>
</dd>
<dt>covar<span class="classifier">numpy.ndarray</span></dt><dd><p>Covariance matrix from minimization, with rows and columns
corresponding to <code class="xref py py-attr docutils literal notranslate"><span class="pre">var_names</span></code>.</p>
</dd>
<dt>init_vals<span class="classifier">list</span></dt><dd><p>List of initial values for variable parameters using <code class="xref py py-attr docutils literal notranslate"><span class="pre">var_names</span></code>.</p>
</dd>
<dt>init_values<span class="classifier">dict</span></dt><dd><p>Dictionary of initial values for variable parameters.</p>
</dd>
<dt>nfev<span class="classifier">int</span></dt><dd><p>Number of function evaluations.</p>
</dd>
<dt>success<span class="classifier">bool</span></dt><dd><p>True if the fit succeeded, otherwise False.</p>
</dd>
<dt>errorbars<span class="classifier">bool</span></dt><dd><p>True if uncertainties were estimated, otherwise False.</p>
</dd>
<dt>message<span class="classifier">str</span></dt><dd><p>Message about fit success.</p>
</dd>
<dt>ier<span class="classifier">int</span></dt><dd><p>Integer error value from <a href="#id55"><span class="problematic" id="id56">:scipydoc:`optimize.leastsq`</span></a> (<cite>leastsq</cite> only).</p>
</dd>
<dt>lmdif_message<span class="classifier">str</span></dt><dd><p>Message from <a href="#id57"><span class="problematic" id="id58">:scipydoc:`optimize.leastsq`</span></a> (<cite>leastsq</cite> only).</p>
</dd>
<dt>nvarys<span class="classifier">int</span></dt><dd><p>Number of variables in fit: <span class="math notranslate nohighlight">\(N_{\rm varys}\)</span>.</p>
</dd>
<dt>ndata<span class="classifier">int</span></dt><dd><p>Number of data points: <span class="math notranslate nohighlight">\(N\)</span>.</p>
</dd>
<dt>nfree<span class="classifier">int</span></dt><dd><p>Degrees of freedom in fit: <span class="math notranslate nohighlight">\(N - N_{\rm varys}\)</span>.</p>
</dd>
<dt>residual<span class="classifier">numpy.ndarray</span></dt><dd><p>Residual array <span class="math notranslate nohighlight">\({\rm Resid_i}\)</span>. Return value of the objective
function when using the best-fit values of the parameters.</p>
</dd>
<dt>chisqr<span class="classifier">float</span></dt><dd><p>Chi-square: <span class="math notranslate nohighlight">\(\chi^2 = \sum_i^N [{\rm Resid}_i]^2\)</span>.</p>
</dd>
<dt>redchi<span class="classifier">float</span></dt><dd><p>Reduced chi-square:
<span class="math notranslate nohighlight">\(\chi^2_{\nu}= {\chi^2} / {(N - N_{\rm varys})}\)</span>.</p>
</dd>
<dt>aic<span class="classifier">float</span></dt><dd><p>Akaike Information Criterion statistic:
<span class="math notranslate nohighlight">\(N \ln(\chi^2/N) + 2 N_{\rm varys}\)</span>.</p>
</dd>
<dt>bic<span class="classifier">float</span></dt><dd><p>Bayesian Information Criterion statistic:
<span class="math notranslate nohighlight">\(N \ln(\chi^2/N) + \ln(N) N_{\rm varys}\)</span>.</p>
</dd>
<dt>flatchain<span class="classifier">pandas.DataFrame</span></dt><dd><p>A flatchain view of the sampling chain from the <cite>emcee</cite> method.</p>
</dd>
</dl>
<dl class="simple">
<dt>show_candidates</dt><dd><p>Pretty_print() representation of candidates from the <cite>brute</cite> method.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="gsf.minimizer.MinimizerResult.flatchain">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flatchain</span></span><a class="headerlink" href="#gsf.minimizer.MinimizerResult.flatchain" title="Permalink to this definition"></a></dt>
<dd><p>Show flatchain view of the sampling chain from <cite>emcee</cite> method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.minimizer.MinimizerResult.show_candidates">
<span class="sig-name descname"><span class="pre">show_candidates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidate_nmb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.MinimizerResult.show_candidates" title="Permalink to this definition"></a></dt>
<dd><p>Show pretty_print() representation of candidates from <cite>brute</cite> method.</p>
<p>Showing all stored candidates (default) or the specified candidate-#
from the <cite>brute</cite> method.</p>
<dl class="simple">
<dt>candidate_nmb<span class="classifier">int or ‘all’</span></dt><dd><p>The candidate-number to show using the <code class="xref py py-meth docutils literal notranslate"><span class="pre">pretty_print()</span></code> method.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.minimizer.asteval_with_uncertainties">
<span class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></span><span class="sig-name descname"><span class="pre">asteval_with_uncertainties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.asteval_with_uncertainties" title="Permalink to this definition"></a></dt>
<dd><p>Calculate object value, given values for variables.</p>
<p>This is used by the uncertainties package to calculate the
uncertainty in an object even with a complicated expression.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.minimizer.eval_stderr">
<span class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></span><span class="sig-name descname"><span class="pre">eval_stderr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uvars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.eval_stderr" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate uncertainty and set .stderr for a parameter <cite>obj</cite>.</p>
<p>Given the uncertain values <cite>uvars</cite> (a list of uncertainties.ufloats), a
list of parameter names that matches uvars, and a dict of param objects,
keyed by name.</p>
<p>This uses the uncertainties package wrapped function to evaluate the
uncertainty for an arbitrary expression (in obj._expr_ast) of parameters.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.minimizer.minimize">
<span class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></span><span class="sig-name descname"><span class="pre">minimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'leastsq'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_cb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_fcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_covar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">fit_kws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.minimize" title="Permalink to this definition"></a></dt>
<dd><p>Perform a fit of a set of parameters by minimizing an objective (or
cost) function using one of the several available methods.</p>
<p>The minimize function takes an objective function to be minimized,
a dictionary (<code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code>) containing the model
parameters, and several optional arguments.</p>
<dl>
<dt>fcn<span class="classifier">callable</span></dt><dd><p>Objective function to be minimized. When method is <cite>leastsq</cite> or
<cite>least_squares</cite>, the objective function should return an array
of residuals (difference between model and data) to be minimized
in a least-squares sense. With the scalar methods the objective
function can either return the residuals array or a single scalar
value. The function must have the signature:
<cite>fcn(params, *args, **kws)</cite></p>
</dd>
<dt>params<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></span></dt><dd><p>Contains the Parameters for the model.</p>
</dd>
<dt>method<span class="classifier">str, optional</span></dt><dd><p>Name of the fitting method to use. Valid values are:</p>
<ul class="simple">
<li><p><cite>‘leastsq’</cite>: Levenberg-Marquardt (default)</p></li>
<li><p><cite>‘least_squares’</cite>: Least-Squares minimization, using Trust Region Reflective method</p></li>
<li><p><cite>‘differential_evolution’</cite>: differential evolution</p></li>
<li><p><cite>‘brute’</cite>: brute force method</p></li>
<li><p><cite>‘basinhopping’</cite>: basinhopping</p></li>
<li><p><cite>‘ampgo’</cite>: Adaptive Memory Programming for Global Optimization</p></li>
<li><p>‘<cite>nelder</cite>’: Nelder-Mead</p></li>
<li><p><cite>‘lbfgsb’</cite>: L-BFGS-B</p></li>
<li><p><cite>‘powell’</cite>: Powell</p></li>
<li><p><cite>‘cg’</cite>: Conjugate-Gradient</p></li>
<li><p><cite>‘newton’</cite>: Newton-CG</p></li>
<li><p><cite>‘cobyla’</cite>: Cobyla</p></li>
<li><p><cite>‘bfgs’</cite>: BFGS</p></li>
<li><p><cite>‘tnc’</cite>: Truncated Newton</p></li>
<li><p><cite>‘trust-ncg’</cite>: Newton-CG trust-region</p></li>
<li><p><cite>‘trust-exact’</cite>: nearly exact trust-region</p></li>
<li><p><cite>‘trust-krylov’</cite>: Newton GLTR trust-region</p></li>
<li><p><cite>‘trust-constr’</cite>: trust-region for constrained optimization</p></li>
<li><p><cite>‘dogleg’</cite>: Dog-leg trust-region</p></li>
<li><p><cite>‘slsqp’</cite>: Sequential Linear Squares Programming</p></li>
<li><p><cite>‘emcee’</cite>: Maximum likelihood via Monte-Carlo Markov Chain</p></li>
<li><p><cite>‘shgo’</cite>: Simplicial Homology Global Optimization</p></li>
<li><p><cite>‘dual_annealing’</cite>: Dual Annealing optimization</p></li>
</ul>
<p>In most cases, these methods wrap and use the method of the same
name from <cite>scipy.optimize</cite>, or use <cite>scipy.optimize.minimize</cite> with
the same <cite>method</cite> argument.  Thus ‘<cite>leastsq</cite>’ will use
<cite>scipy.optimize.leastsq</cite>, while ‘<cite>powell</cite>’ will use
<cite>scipy.optimize.minimizer(…, method=’powell’)</cite></p>
<p>For more details on the fitting methods please refer to the
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html">SciPy docs</a>.</p>
</dd>
<dt>args<span class="classifier">tuple, optional</span></dt><dd><p>Positional arguments to pass to <cite>fcn</cite>.</p>
</dd>
<dt>kws<span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments to pass to <cite>fcn</cite>.</p>
</dd>
<dt>iter_cb<span class="classifier">callable, optional</span></dt><dd><p>Function to be called at each fit iteration. This function should
have the signature <cite>iter_cb(params, iter, resid, *args, **kws)</cite>,
where <cite>params</cite> will have the current parameter values, <cite>iter</cite>
the iteration number, <cite>resid</cite> the current residual array, and <cite>*args</cite>
and <cite>**kws</cite> as passed to the objective function.</p>
</dd>
<dt>scale_covar<span class="classifier">bool, optional</span></dt><dd><p>Whether to automatically scale the covariance matrix (default is True).</p>
</dd>
<dt>nan_policy<span class="classifier">str, optional</span></dt><dd><p>Specifies action if <cite>userfcn</cite> (or a Jacobian) returns NaN
values. One of:</p>
<ul class="simple">
<li><p>‘raise’ : a <cite>ValueError</cite> is raised</p></li>
<li><p>‘propagate’ : the values returned from <cite>userfcn</cite> are un-altered</p></li>
<li><p>‘omit’ : non-finite values are filtered</p></li>
</ul>
</dd>
<dt>reduce_fcn<span class="classifier">str or callable, optional</span></dt><dd><p>Function to convert a residual array to a scalar value for the scalar
minimizers. See notes in <cite>Minimizer</cite>.</p>
</dd>
<dt>calc_covar<span class="classifier">bool, optional</span></dt><dd><p>Whether to calculate the covariance matrix (default is True) for
solvers other than <cite>leastsq</cite> and <cite>least_squares</cite>. Requires the
<cite>numdifftools</cite> package to be installed.</p>
</dd>
<dt><a href="#id59"><span class="problematic" id="id60">**</span></a>fit_kws<span class="classifier">dict, optional</span></dt><dd><p>Options to pass to the minimizer being used.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a></dt><dd><p>Object containing the optimized parameter and several
goodness-of-fit statistics.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Return value changed to <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.</p>
</div>
<p>The objective function should return the value to be minimized. For the
Levenberg-Marquardt algorithm from leastsq(), this returned value must
be an array, with a length greater than or equal to the number of
fitting variables in the model. For the other methods, the return value
can either be a scalar or an array. If an array is returned, the sum of
squares of the array will be sent to the underlying fitting method,
effectively doing a least-squares optimization of the return values.</p>
<p>A common use for <cite>args</cite> and <cite>kws</cite> would be to pass in other
data needed to calculate the residual, including such things as the
data array, dependent variable, uncertainties in the data, and other
data structures for the model calculation.</p>
<p>On output, <cite>params</cite> will be unchanged.  The best-fit values and, where
appropriate, estimated uncertainties and correlations, will all be
contained in the returned <a class="reference internal" href="#gsf.minimizer.MinimizerResult" title="gsf.minimizer.MinimizerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a>.  See
<span class="xref std std-ref">fit-results-label</span> for further details.</p>
<p>This function is simply a wrapper around <a class="reference internal" href="#gsf.minimizer.Minimizer" title="gsf.minimizer.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a>
and is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fitter</span> <span class="o">=</span> <span class="n">Minimizer</span><span class="p">(</span><span class="n">fcn</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">fcn_args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">fcn_kws</span><span class="o">=</span><span class="n">kws</span><span class="p">,</span>
                   <span class="n">iter_cb</span><span class="o">=</span><span class="n">iter_cb</span><span class="p">,</span> <span class="n">scale_covar</span><span class="o">=</span><span class="n">scale_covar</span><span class="p">,</span>
                   <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span> <span class="n">reduce_fcn</span><span class="o">=</span><span class="n">reduce_fcn</span><span class="p">,</span>
                   <span class="n">calc_covar</span><span class="o">=</span><span class="n">calc_covar</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_kws</span><span class="p">)</span>
<span class="n">fitter</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.minimizer.reduce_cauchylogpdf">
<span class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></span><span class="sig-name descname"><span class="pre">reduce_cauchylogpdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.reduce_cauchylogpdf" title="Permalink to this definition"></a></dt>
<dd><p>Reduce residual array to scalar (cauchylogpdf).</p>
<p>Reduce residual array <cite>r</cite> to scalar using negative log-likelihood and a
Cauchy (Lorentzian) distribution of <cite>r</cite>:</p>
<blockquote>
<div><p>-scipy.stats.cauchy.logpdf(r)</p>
</div></blockquote>
<p>(where the Cauchy pdf = 1/(pi*(1+r*r))). This gives greater
suppression of outliers compared to normal sum-of-squares.</p>
<dl class="simple">
<dt>r<span class="classifier">numpy.ndarray</span></dt><dd><p>Residual array.</p>
</dd>
</dl>
<dl class="simple">
<dt>float</dt><dd><p>Negative entropy value calculated from the residual array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.minimizer.reduce_chisquare">
<span class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></span><span class="sig-name descname"><span class="pre">reduce_chisquare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.reduce_chisquare" title="Permalink to this definition"></a></dt>
<dd><p>Reduce residual array to scalar (chi-square).</p>
<p>Calculate the chi-square value from the residual array <cite>r</cite>: (r*r).sum()</p>
<dl class="simple">
<dt>r<span class="classifier">numpy.ndarray</span></dt><dd><p>Residual array.</p>
</dd>
</dl>
<dl class="simple">
<dt>float</dt><dd><p>Chi-square calculated from the residual array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.minimizer.reduce_negentropy">
<span class="sig-prename descclassname"><span class="pre">gsf.minimizer.</span></span><span class="sig-name descname"><span class="pre">reduce_negentropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.minimizer.reduce_negentropy" title="Permalink to this definition"></a></dt>
<dd><p>Reduce residual array to scalar (negentropy).</p>
<p>Reduce residual array <cite>r</cite> to scalar using negative entropy and the normal
(Gaussian) probability distribution of <cite>r</cite> as pdf:</p>
<blockquote>
<div><p>(norm.pdf(r)*norm.logpdf(r)).sum()</p>
</div></blockquote>
<dl class="simple">
<dt>since pdf(r) = exp(-r*r/2)/sqrt(2*pi), this is</dt><dd><p>((r*r/2 - log(sqrt(2*pi))) * exp(-r*r/2)).sum()</p>
</dd>
</dl>
<dl class="simple">
<dt>r<span class="classifier">numpy.ndarray</span></dt><dd><p>Residual array.</p>
</dd>
</dl>
<dl class="simple">
<dt>float</dt><dd><p>Negative entropy value calculated from the residual array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="gsf-plot-mz-module">
<h2>gsf.plot_MZ module<a class="headerlink" href="#gsf-plot-mz-module" title="Permalink to this headline"></a></h2>
</section>
<section id="gsf-plot-sed-loga-module">
<h2>gsf.plot_sed_logA module<a class="headerlink" href="#gsf-plot-sed-loga-module" title="Permalink to this headline"></a></h2>
</section>
<section id="gsf-plot-sfh-loga-module">
<h2>gsf.plot_sfh_logA module<a class="headerlink" href="#gsf-plot-sfh-loga-module" title="Permalink to this headline"></a></h2>
</section>
<section id="module-gsf.posterior_flexible">
<span id="gsf-posterior-flexible-module"></span><h2>gsf.posterior_flexible module<a class="headerlink" href="#module-gsf.posterior_flexible" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="gsf.posterior_flexible.Post">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gsf.posterior_flexible.</span></span><span class="sig-name descname"><span class="pre">Post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mainbody</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class function for MCMC</p>
<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_flexible.Post.func_tmp">
<span class="sig-name descname"><span class="pre">func_tmp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.func_tmp" title="Permalink to this definition"></a></dt>
<dd><p>A function used for chi2 calculation for non-detection in lnprob.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_flexible.Post.get_sfh_prior">
<span class="sig-name descname"><span class="pre">get_sfh_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.get_sfh_prior" title="Permalink to this definition"></a></dt>
<dd><p>Fit SFH with an n-order polynomial and reflect the residual to the prior.
Fit should be done in log-log space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_flexible.Post.lnprob_emcee">
<span class="sig-name descname"><span class="pre">lnprob_emcee</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_chind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNlim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lnpreject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_like</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_prior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gauss_prior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_prior_sfh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_sfh_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norder_sfh_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.lnprob_emcee" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>f_chind<span class="classifier">bool</span></dt><dd><p>If true, includes non-detection in likelihood calculation.</p>
</dd>
<dt>lnpreject<span class="classifier"></span></dt><dd><p>A replaced value when lnprob gets -inf value.</p>
</dd>
<dt>flat_prior<span class="classifier"></span></dt><dd><p>Assumes flat prior for Mdyn. Used only when MB.f_Mdyn==True.</p>
</dd>
<dt>gauss_prior<span class="classifier"></span></dt><dd><p>Assumes gaussian prior for Mdyn. Used only when MB.f_Mdyn==True.</p>
</dd>
<dt>pos<span class="classifier"></span></dt><dd><p>This is a critical parameter, to make use of EMCEE, while keeping pars a dictionary obtained by lmfit.
This is pos of sampler.run_mcmc(pos, self.nmc, progress=True).</p>
</dd>
<dt>out<span class="classifier"></span></dt><dd><p>Just for keywords.</p>
</dd>
</dl>
<p>If f_like, log Likelihood. Else, log Posterior prob.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_flexible.Post.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_penlize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_only_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.residual" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>out<span class="classifier"></span></dt><dd><p>model as second output. For lnprob func.</p>
</dd>
<dt>f_fir<span class="classifier">bool</span></dt><dd><p>If dust component is on or off.</p>
</dd>
</dl>
<p>residual of model and data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_flexible.Post.swap_pars">
<span class="sig-name descname"><span class="pre">swap_pars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.swap_pars" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_flexible.Post.swap_pars_inv">
<span class="sig-name descname"><span class="pre">swap_pars_inv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_flexible.Post.swap_pars_inv" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-gsf.posterior_nested">
<span id="gsf-posterior-nested-module"></span><h2>gsf.posterior_nested module<a class="headerlink" href="#module-gsf.posterior_nested" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="gsf.posterior_nested.Post_nested">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gsf.posterior_nested.</span></span><span class="sig-name descname"><span class="pre">Post_nested</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mainbody</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_nested.Post_nested.func_tmp">
<span class="sig-name descname"><span class="pre">func_tmp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.func_tmp" title="Permalink to this definition"></a></dt>
<dd><p>A function used for chi2 calculation for non-detection in lnprob.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_nested.Post_nested.get_dict">
<span class="sig-name descname"><span class="pre">get_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.get_dict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_nested.Post_nested.lnlike">
<span class="sig-name descname"><span class="pre">lnlike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_chind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lnpreject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.lnlike" title="Permalink to this definition"></a></dt>
<dd><p>log likelihood</p>
<p>This is a copy from lnprob, with respr=0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_nested.Post_nested.lnprob">
<span class="sig-name descname"><span class="pre">lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_chind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lnpreject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.lnprob" title="Permalink to this definition"></a></dt>
<dd><p>log posterior</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_nested.Post_nested.prior_transform">
<span class="sig-name descname"><span class="pre">prior_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.prior_transform" title="Permalink to this definition"></a></dt>
<dd><p>A function defining the tranform between the parameterisation in the unit hypercube
to the true parameters.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>theta (tuple): a tuple containing the parameters.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: a new tuple or array with the transformed parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_nested.Post_nested.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.residual" title="Permalink to this definition"></a></dt>
<dd><p>out   : model as second output. For lnprob func.
f_fir : Bool. If dust component is on or off.</p>
<p>residual of model and data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gsf.posterior_nested.Post_nested.residual_nest">
<span class="sig-name descname"><span class="pre">residual_nest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wht</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_fir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.posterior_nested.Post_nested.residual_nest" title="Permalink to this definition"></a></dt>
<dd><p>out   : model as second output. For lnprob func.
f_fir : Bool. If dust component is on or off.</p>
<p>residual of model and data.</p>
</dd></dl>

</dd></dl>

</section>
<section id="gsf-version-module">
<h2>gsf.version module<a class="headerlink" href="#gsf-version-module" title="Permalink to this headline"></a></h2>
</section>
<section id="module-gsf.writing">
<span id="gsf-writing-module"></span><h2>gsf.writing module<a class="headerlink" href="#module-gsf.writing" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gsf.writing.get_index">
<span class="sig-prename descclassname"><span class="pre">gsf.writing.</span></span><span class="sig-name descname"><span class="pre">get_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.writing.get_index" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve spectral indices from each realization.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.writing.get_param">
<span class="sig-prename descclassname"><span class="pre">gsf.writing.</span></span><span class="sig-name descname"><span class="pre">get_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tcalc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.writing.get_param" title="Permalink to this definition"></a></dt>
<dd><p>Write a parameter file.</p>
</dd></dl>

</section>
<section id="module-gsf.zfit">
<span id="gsf-zfit-module"></span><h2>gsf.zfit module<a class="headerlink" href="#module-gsf.zfit" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gsf.zfit.check_redshift">
<span class="sig-prename descclassname"><span class="pre">gsf.zfit.</span></span><span class="sig-name descname"><span class="pre">check_redshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zbest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zprior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zliml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlimu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmc_cz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalk_cz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_line_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_vary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NRbb_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_photometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.zfit.check_redshift" title="Permalink to this definition"></a></dt>
<dd><p>Fit observed flux with a template to get redshift probability.</p>
<dl class="simple">
<dt>zbest<span class="classifier"></span></dt><dd><p>Initial value for redshift.</p>
</dd>
<dt>zprior<span class="classifier"></span></dt><dd><p>Redshift grid for prior.</p>
</dd>
<dt>prior<span class="classifier"></span></dt><dd><p>Prior for redshift determination. E.g., Eazy z-probability.</p>
</dd>
<dt>zliml<span class="classifier"></span></dt><dd><p>Lowest redshift for fitting range.</p>
</dd>
<dt>zlimu<span class="classifier"></span></dt><dd><p>Highest redshift for fitting range.</p>
</dd>
<dt>f_vary<span class="classifier">bool</span></dt><dd><p>If want to fix redshift.</p>
</dd>
<dt>fm_tmp :</dt><dd><p>Template spectrum at RF.</p>
</dd>
<dt>xm_tmp :</dt><dd><p>Template spectrum at RF.</p>
</dd>
<dt>fobs<span class="classifier"></span></dt><dd><p>Observed spectrum. (Already scaled with Cz0prev.)</p>
</dd>
<dt>eobs<span class="classifier"></span></dt><dd><p>Observed spectrum. (Already scaled with Cz0prev.)</p>
</dd>
<dt>xobs<span class="classifier"></span></dt><dd><p>Observed spectrum. (Already scaled with Cz0prev.)</p>
</dd>
</dl>
<p>res_cz :</p>
<p>fitc_cz :</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.zfit.get_chi2">
<span class="sig-prename descclassname"><span class="pre">gsf.zfit.</span></span><span class="sig-name descname"><span class="pre">get_chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zz_prob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy_cz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ey_cz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_cz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_zprob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rms_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.zfit.get_chi2" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>zz_prob<span class="classifier">float array</span></dt><dd><p>redshift array for fit.</p>
</dd>
<dt>fy_cz, ey_cz, x_cz<span class="classifier"></span></dt><dd><p>observed values.</p>
</dd>
<dt>fm_tmp, xm_tmp :</dt><dd><p>template.</p>
</dd>
<dt>file_zprob<span class="classifier">str</span></dt><dd><p>output file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.zfit.lnprob_cz">
<span class="sig-prename descclassname"><span class="pre">gsf.zfit.</span></span><span class="sig-name descname"><span class="pre">lnprob_cz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zprior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zliml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlimu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.zfit.lnprob_cz" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gsf.zfit.residual_z">
<span class="sig-prename descclassname"><span class="pre">gsf.zfit.</span></span><span class="sig-name descname"><span class="pre">residual_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NRbb_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_photometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_line_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gsf.zfit.residual_z" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-gsf">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-gsf" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="gsf" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Takahiro Morishita.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>